# uncompyle6 version 3.7.4
# Python bytecode 2.7 (62211)
# Decompiled from: Python 3.6.9 (default, Apr 18 2020, 01:56:04) 
# [GCC 8.4.0]
# Embedded file name: build/bdist.linux-x86_64/egg/insights/parsers/tests/test_cobbler_settings.py
# Compiled at: 2019-05-16 13:41:33
from insights.tests import context_wrap
from insights.parsers.cobbler_settings import CobblerSettings
setting_content = ('\n---\n# cobbler settings file\n# restart cobblerd and run "cobbler sync" after making changes\n# This config file is in YAML 1.0 format\n# see http://yaml.org\n# ==========================================================\n# if 1, cobbler will allow insertions of system records that duplicate\n# the --dns-name information of other system records.  In general,\n# this is undesirable and should be left 0.\nallow_duplicate_hostnames: 0\n\n# if 1, cobbler will allow insertions of system records that duplicate\n# the ip address information of other system records.  In general,\n# this is undesirable and should be left 0.\nallow_duplicate_ips: 0\n\n# if 1, cobbler will allow insertions of system records that duplicate\n# the mac address information of other system records.  In general,\n# this is undesirable.\nallow_duplicate_macs: 0\n\n# by default, installs are *not* set to send installation logs to the cobbler\n# # # server.  With \'anamon_enabled\', kickstart templates may use the pre_anamon\n# # # snippet to allow remote live monitoring of their installations from the\n# # # cobbler server.  Installation logs will be stored under\n# # # /var/log/cobbler/anamon/.  NOTE: This does allow an xmlrpc call to send logs\n# # # to this directory, without authentication, so enable only if you are\n# # # ok with this limitation.\nanamon_enabled: 0\n\n# Email out a report when cobbler finishes installing a system.\n# enabled: set to 1 to turn this feature on\n# sender: optional\n# email: which addresses to email\n# smtp_server: used to specify another server for an MTA\n# subject: use the default subject unless overridden\nbuild_reporting_enabled: 1\nbuild_reporting_sender: "cobbler"\nbuild_reporting_email: [ \'test@foo.example.com\' ]\nbuild_reporting_smtp_server: "192.0.2.1"\nbuild_reporting_subject: ""\n\n# Cheetah-language kickstart templates can import Python modules.\n# while this is a useful feature, it is not safe to allow them to\n# import anything they want. This whitelists which modules can be\n# imported through Cheetah.  Users can expand this as needed but\n# should never allow modules such as subprocess or those that\n# allow access to the filesystem as Cheetah templates are evaluated\n# by cobblerd as code.\ncheetah_import_whitelist:\n   - "random"\n   - "re"\n   - "time"\n\n# Default createrepo_flags to use for new repositories. If you have\n# createrepo >= 0.4.10, consider "-c cache --update -C", which can\n# dramatically improve your "cobbler reposync" time.  "-s sha"\n# enables working with Fedora repos from F11/F12 from EL-4 or\n# EL-5 without python-hashlib installed (which is not available\n# on EL-4)\ncreaterepo_flags: "-c cache -s sha"\n\n# if no kickstart is specified to profile add, use this template\ndefault_kickstart: /var/lib/cobbler/kickstarts/default.ks\n\n# configure all installed systems to use these nameservers by default\n# unless defined differently in the profile.  For DHCP configurations\n# you probably do /not/ want to supply this.\ndefault_name_servers: []\n\n# if using the authz_ownership module (see the Wiki), objects\n# created without specifying an owner are assigned to this\n# owner and/or group.  Can be a comma seperated list.\ndefault_ownership:\n    - "admin"\n\n# cobbler has various sample kickstart templates stored\n# in /var/lib/cobbler/kickstarts/.  This controls\n# what install (root) password is set up for those\n# systems that reference this variable.  The factory\n# default is "cobbler" and cobbler check will warn if\n# this is not changed.\ndefault_password_crypted: "password123"\n\n# for libvirt based installs in koan, if no virt bridge\n# is specified, which bridge do we try?  For EL 4/5 hosts\n# this should be xenbr0, for all versions of Fedora, try\n# "virbr0".  This can be overriden on a per-profile\n# basis or at the koan command line though this saves\n# typing to just set it here to the most common option.\ndefault_virt_bridge: xenbr0\n\n# use this as the default disk size for virt guests (GB)\ndefault_virt_file_size: 5\n\n# use this as the default memory size for virt guests (MB)\ndefault_virt_ram: 512\n\n# if koan is invoked without --virt-type and no virt-type\n# is set on the profile/system, what virtualization type\n# should be assumed?  Values: xenpv, xenfv, qemu, vmware\n# (NOTE: this does not change what virt_type is chosen by import)\ndefault_virt_type: xenpv\n\n# controls whether cobbler will add each new profile entry to the default\n# PXE boot menu.  This can be over-ridden on a per-profile\n# basis when adding/editing profiles with --enable-menu=0/1.  Users\n# should ordinarily leave this setting enabled unless they are concerned\n# with accidental reinstalls from users who select an entry at the PXE\n# boot menu.  Adding a password to the boot menus templates\n# may also be a good solution to prevent unwanted reinstallations\nenable_menu: 1\n\n# enable Func-integration?  This makes sure each installed machine is set up\n# to use func out of the box, which is a powerful way to script and control\n# remote machines.\n# Func lives at http://fedorahosted.org/func\n# read more at https://fedorahosted.org/cobbler/wiki/FuncIntegration\n# you will need to mirror Fedora/EPEL packages for this feature, so see\n# https://fedorahosted.org/cobbler/wiki/ManageYumRepos if you want cobbler\n# to help you with this\nfunc_auto_setup: 0\nfunc_master: overlord.example.org\n\n# change this port if Apache is not running plaintext on port\n# 80.  Most people can leave this alone.\nhttp_port: 80\n\n# kernel options that should be present in every cobbler installation.\n# kernel options can also be applied at the distro/profile/system\n# level.\nkernel_options:\n    ksdevice: bootif\n    lang: \' \'\n    text: ~\n\n# s390 systems require additional kernel options in addition to the\n# above defaults\nkernel_options_s390x:\n    RUNKS: 1\n    ramdisk_size: 40000\n    root: /dev/ram0\n    ro: ~\n    ip: off\n    vnc: ~\n\n# configuration options if using the authn_ldap module. See the\n# the Wiki for details.  This can be ignored if you are not using\n# LDAP for WebUI/XMLRPC authentication.\nldap_server: "ldap.example.com"\nldap_base_dn: "DC=example,DC=com"\nldap_port: 389\nldap_tls: 1\nldap_anonymous_bind: 1\nldap_search_bind_dn: \'\'\nldap_search_passwd: \'\'\nldap_search_prefix: \'uid=\'\n\n# cobbler has a feature that allows for integration with config management\n# systems such as Puppet.  The following parameters work in conjunction with\n# --mgmt-classes  and are described in furhter detail at:\n# https://fedorahosted.org/cobbler/wiki/UsingCobblerWithConfigManagementSystem\nmgmt_classes: []\nmgmt_parameters:\n   from_cobbler: 1\n\n# set to 1 to enable Cobbler\'s DHCP management features.\n# the choice of DHCP management engine is in /etc/cobbler/modules.conf\nmanage_dhcp: 0\n\n# set to 1 to enable Cobbler\'s DNS management features.\n# the choice of DNS mangement engine is in /etc/cobbler/modules.conf\nmanage_dns: 0\n\n# if using BIND (named) for DNS management in /etc/cobbler/modules.conf\n# and manage_dns is enabled (above), this lists which zones are managed\n# See the Wiki (https://fedorahosted.org/cobbler/wiki/ManageDns) for more info\nmanage_forward_zones: []\nmanage_reverse_zones: []\n\n# if using cobbler with manage_dhcp, put the IP address\n# of the cobbler server here so that PXE booting guests can find it\n# if you do not set this correctly, this will be manifested in TFTP open timeouts.\nnext_server: "NotReallyThere"\n\n\n\n# settings for power management features.  optional.\n# see https://fedorahosted.org/cobbler/wiki/PowerManagement to learn more\n# choices:\n#    bullpap wti apc apc_snmp ether-wake ipmilan\n#    drac ipmitool ilo rsa lpar bladecenter virsh\npower_management_default_type: \'ipmitool\'\n\n# the commands used by the power management module are sourced\n# from what directory?\npower_template_dir: "/etc/cobbler/power"\n\n# if this setting is set to 1, cobbler systems that pxe boot\n# will request at the end of their installation to toggle the\n# --netboot-enabled record in the cobbler system record.  This eliminates\n# the potential for a PXE boot loop if the system is set to PXE\n# first in it\'s BIOS order.  Enable this if PXE is first in your BIOS\n# boot order, otherwise leave this disabled.   See the manpage\n# for --netboot-enabled.\npxe_just_once: 1\n\n# the templates used for PXE config generation are sourced\n# from what directory?\npxe_template_dir: "/etc/cobbler/pxe"\n\n# Are you using a Red Hat management platform in addition to Cobbler?\n# Cobbler can help you register to it.  Choose one of the following:\n#   "off"    : I\'m not using Red Hat Network, Satellite, or Spacewalk\n#   "hosted" : I\'m using Red Hat Network\n#   "site"   : I\'m using Red Hat Satellite Server or Spacewalk\n# You will also want to read: https://fedorahosted.org/cobbler/wiki/TipsForRhn\nredhat_management_type: "site"\n\n# if redhat_management_type is enabled, choose your server\n#   "management.example.org" : For Satellite or Spacewalk\n#   "xmlrpc.rhn.redhat.com"  : For Red Hat Network\n# This setting is also used by the code that supports using Spacewalk/Satellite users/passwords\n# within Cobbler Web and Cobbler XMLRPC.  Using RHN Hosted for this is not supported.\n# This feature can be used even if redhat_management_type is off, you just have\n# to have authn_spacewalk selected in modules.conf\nredhat_management_server: "NotReallyThere"\n\n# specify the default Red Hat authorization key to use to register\n# system.  If left blank, no registration will be attempted.  Similarly\n# you can set the --redhat-management-key to blank on any system to\n# keep it from trying to register.\nredhat_management_key: ""\n\n# if using authn_spacewalk in modules.conf to let cobbler authenticate\n# against Satellite/Spacewalk\'s auth system, by default it will not allow per user\n# access into Cobbler Web and Cobbler XMLRPC.\n# in order to permit this, the following setting must be enabled HOWEVER\n# doing so will permit all Spacewalk/Satellite users of certain types to edit all\n# of cobbler\'s configuration.\n# these roles are:  config_admin and org_admin\n# users should turn this on only if they want this behavior and\n# do not have a cross-multi-org seperation concern.  If you have\n# a single org in your satellite, it\'s probably safe to turn this\n# on and then you can use CobblerWeb alongside a Satellite install.\nredhat_management_permissive: 0\n\n# if set to 1, allows /usr/bin/cobbler-register (part of the koan package)\n# to be used to remotely add new cobbler system records to cobbler.\n# this effectively allows for registration of new hardware from system\n# records.\nregister_new_installs: 0\n\n# Flags to use for yum\'s reposync.  If your version of yum reposync\n# does not support -l, you may need to remove that option.\nreposync_flags: "-l -m -d"\n\n# when DHCP and DNS management are enabled, cobbler sync can automatically\n# restart those services to apply changes.  The exception for this is\n# if using ISC for DHCP, then omapi eliminates the need for a restart.\n# omapi, however, is experimental and not recommended for most configurations.\n# If DHCP and DNS are going to be managed, but hosted on a box that\n# is not on this server, disable restarts here and write some other\n# script to ensure that the config files get copied/rsynced to the destination\n# box.  This can be done by modifying the restart services trigger.\n# Note that if manage_dhcp and manage_dns are disabled, the respective\n# parameter will have no effect.  Most users should not need to change\n# this.\nrestart_dns: 1\nrestart_dhcp: 1\n\n# install triggers are scripts in /var/lib/cobbler/triggers/install\n# that are triggered in kickstart pre and post sections.  Any\n# executable script in those directories is run.  They can be used\n# to send email or perform other actions.  They are currently\n# run as root so if you do not need this functionality you can\n# disable it, though this will also disable "cobbler status" which\n# uses a logging trigger to audit install progress.\nrun_install_triggers: 1\n\n# enables a trigger which version controls all changes to /var/lib/cobbler\n# when add, edit, or sync events are performed.  This can be used\n# to revert to previous database versions, generate RSS feeds, or for\n# other auditing or backup purposes.  git is the recommend SCM\n# for use with this feature.\nscm_track_enabled: 0\nscm_track_mode: "git"\n\n# this is the address of the cobbler server -- as it is used\n# by systems during the install process, it must be the address\n# or hostname of the system as those systems can see the server.\n# if you have a server that appears differently to different subnets\n# (dual homed, etc), you need to read the --server-override section\n# of the manpage for how that works.\nserver: NotReallyThere\n\n\n# this is a directory of files that cobbler uses to make\n# templating easier.  See the Wiki for more information.  Changing\n# this directory should not be required.\nsnippetsdir: /var/lib/cobbler/snippets\n\n# Normally if a kickstart is specified at a remote location, this\n# URL will be passed directly to the kickstarting system, thus bypassing\n# the usual snippet templating Cobbler does for local kickstart files. If\n# this option is enabled, Cobbler will fetch the file contents internally\n# and serve a templated version of the file to the client.\ntemplate_remote_kickstarts: 0\n\n# should new profiles for virtual machines default to auto booting with the physical host when the physical host reboots?\n# this can be overridden on each profile or system object.\nvirt_auto_boot: 1\n\n# cobbler\'s web directory.  Don\'t change this setting -- see the\n# Wiki on "relocating your cobbler install" if your /var partition\n# is not large enough.\nwebdir: /var/www/cobbler\n\n# cobbler\'s public XMLRPC listens on this port.  Change this only\n# if absolutely needed, as you\'ll have to start supplying a new\n# port option to koan if it is not the default.\nxmlrpc_port: 25151\n\n# "cobbler repo add" commands set cobbler up with repository\n# information that can be used during kickstart and is automatically\n# set up in the cobbler kickstart templates.  By default, these\n# are only available at install time.  To make these repositories\n# usable on installed systems (since cobbler makes a very convient)\n# mirror, set this to 1.  Most users can safely set this to 1.  Users\n# who have a dual homed cobbler server, or are installing laptops that\n# will not always have access to the cobbler server may wish to leave\n# this as 0.  In that case, the cobbler mirrored yum repos are still\n# accessable at http://cobbler.example.org/cblr/repo_mirror and yum\n# configuration can still be done manually.  This is just a shortcut.\nyum_post_install_mirror: 1\n\n# the default yum priority for all the distros.  This is only used\n# if yum-priorities plugin is used.  1=maximum.  Tweak with caution.\nyum_distro_priority: 1\n\n# Flags to use for yumdownloader.  Not all versions may support\n# --resolve.\nyumdownloader_flags: "--resolve"\n\n# Safe Tempating disables several features of cheetah that may prove\n# to be undesirable in situations where cobbler_web is used.  We\n#  recommend that you enable safe templating any time you have\n# individuals writting templates that do not have root access to the\n# cobbler system.\nsafe_templating: true\n').strip()

def test_cobbler_setting():
    result = CobblerSettings(context_wrap(setting_content))
    assert result.get('safe_templating') is True
    assert result.get('mgmt_parameters') == {'from_cobbler': 1}