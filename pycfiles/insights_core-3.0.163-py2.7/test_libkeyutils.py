# uncompyle6 version 3.7.4
# Python bytecode 2.7 (62211)
# Decompiled from: Python 3.6.9 (default, Apr 18 2020, 01:56:04) 
# [GCC 8.4.0]
# Embedded file name: build/bdist.linux-x86_64/egg/insights/parsers/tests/test_libkeyutils.py
# Compiled at: 2019-05-16 13:41:33
from insights.parsers.libkeyutils import Libkeyutils, LibkeyutilsObjdumps
from insights.tests import context_wrap
SEARCH_NOT_FOUND = '\n/lib/libkeyutils.so.1\n/lib/libkeyutils.so.1.6\n/lib/debug/usr/lib64/libkeyutils.so.1.5.debug\n/lib/debug/usr/lib64/libkeyutils.so.1.debug\n/lib/debug/usr/lib64/libkeyutils.so.debug\n/lib64/libkeyutils.so.1\n/lib64/libkeyutils.so.1.6\n/lib64/libkeyutils.so\n'
SEARCH_FOUND_1 = '\n/lib/libkeyutils.so.1\n/lib/tls/libkeyutils.so.1.6\n/lib/debug/usr/lib64/libkeyutils.so.1.5.debug\n/lib/debug/usr/lib64/libkeyutils.so.1.debug\n/lib/debug/usr/lib64/libkeyutils.so.debug\n/lib64/libkeyutils.so.1\n/lib64/libkeyutils.so.1.6\n/lib64/libkeyutils.so\n'
SEARCH_FOUND_2 = '\n/lib/libkeyutils.so.1\n/lib/tls/libkeyutils.so.1.6\n/lib/debug/usr/lib64/libkeyutils.so.1.5.debug\n/lib/debug/usr/lib64/libkeyutils.so.1.debug\n/lib/debug/usr/lib64/libkeyutils.so.debug\n/lib64/tls/libkeyutils.so.1\n/lib64/libkeyutils.so.1.6\n/lib64/libkeyutils.so\n'
DUMP_NOT_FOUND = '\n\n/lib/libkeyutils.so.1:     file format elf32-i386\n/lib/libkeyutils.so.1\narchitecture: i386, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000f80\n\nProgram Header:\n    LOAD off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**12\n         filesz 0x000028b4 memsz 0x000028b4 flags r-x\n    LOAD off    0x00002e6c vaddr 0x00003e6c paddr 0x00003e6c align 2**12\n         filesz 0x00000194 memsz 0x00000198 flags rw-\n DYNAMIC off    0x00002e78 vaddr 0x00003e78 paddr 0x00003e78 align 2**2\n         filesz 0x000000f8 memsz 0x000000f8 flags rw-\n    NOTE off    0x00000114 vaddr 0x00000114 paddr 0x00000114 align 2**2\n         filesz 0x00000024 memsz 0x00000024 flags r--\nEH_FRAME off    0x000021d8 vaddr 0x000021d8 paddr 0x000021d8 align 2**2\n         filesz 0x00000134 memsz 0x00000134 flags r--\n   STACK off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**4\n         filesz 0x00000000 memsz 0x00000000 flags rw-\n   RELRO off    0x00002e6c vaddr 0x00003e6c paddr 0x00003e6c align 2**0\n         filesz 0x00000194 memsz 0x00000194 flags r--\n\nDynamic Section:\n  NEEDED               libdl.so.2\n  NEEDED               libc.so.6\n  SONAME               libkeyutils.so.1\n  INIT                 0x00000e54\n  FINI                 0x00002134\n  INIT_ARRAY           0x00003e6c\n  INIT_ARRAYSZ         0x00000004\n  FINI_ARRAY           0x00003e70\n  FINI_ARRAYSZ         0x00000004\n  GNU_HASH             0x00000138\n  STRTAB               0x000006f8\n  SYMTAB               0x000002b8\n  STRSZ                0x00000457\n  SYMENT               0x00000010\n  PLTGOT               0x00003f70\n  REL                  0x00000d34\n  RELSZ                0x00000120\n  RELENT               0x00000008\n  VERDEF               0x00000bd8\n  VERDEFNUM            0x00000007\n  BIND_NOW             0x00000000\n  FLAGS_1              0x00000001\n  VERNEED              0x00000cc4\n  VERNEEDNUM           0x00000001\n  VERSYM               0x00000b50\n  RELCOUNT             0x00000003\n\nVersion definitions:\n1 0x01 0x02928561 libkeyutils.so.1\n2 0x00 0x0ae3c993 KEYUTILS_0.3\n3 0x00 0x0ae3ca90 KEYUTILS_1.0\n\tKEYUTILS_0.3\n4 0x00 0x0ae3ca93 KEYUTILS_1.3\n\tKEYUTILS_1.0\n5 0x00 0x0ae3ca94 KEYUTILS_1.4\n\tKEYUTILS_1.3\n6 0x00 0x0ae3ca95 KEYUTILS_1.5\n\tKEYUTILS_1.4\n7 0x00 0x0ae3ca96 KEYUTILS_1.6\n\tKEYUTILS_1.5\n\nVersion References:\n  required from libc.so.6:\n    0x09691974 0x00 13 GLIBC_2.3.4\n    0x0d696917 0x00 12 GLIBC_2.7\n    0x09691f73 0x00 11 GLIBC_2.1.3\n    0x0d696914 0x00 10 GLIBC_2.4\n    0x0d696911 0x00 09 GLIBC_2.1\n    0x0d696910 0x00 08 GLIBC_2.0\n\nSections:\nIdx Name          Size      VMA       LMA       File off  Algn\n  0 .note.gnu.build-id 00000024  00000114  00000114  00000114  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  1 .gnu.hash     00000180  00000138  00000138  00000138  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  2 .dynsym       00000440  000002b8  000002b8  000002b8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .dynstr       00000457  000006f8  000006f8  000006f8  2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .gnu.version  00000088  00000b50  00000b50  00000b50  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  5 .gnu.version_d 000000ec  00000bd8  00000bd8  00000bd8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  6 .gnu.version_r 00000070  00000cc4  00000cc4  00000cc4  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  7 .rel.dyn      00000120  00000d34  00000d34  00000d34  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  8 .init         00000023  00000e54  00000e54  00000e54  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  9 .plt          00000010  00000e80  00000e80  00000e80  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 10 .plt.got      000000f0  00000e90  00000e90  00000e90  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 11 .text         000011b4  00000f80  00000f80  00000f80  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 12 .fini         00000014  00002134  00002134  00002134  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 13 .rodata       00000090  00002148  00002148  00002148  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 14 .eh_frame_hdr 00000134  000021d8  000021d8  000021d8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 15 .eh_frame     000005a8  0000230c  0000230c  0000230c  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 16 .init_array   00000004  00003e6c  00003e6c  00002e6c  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 17 .fini_array   00000004  00003e70  00003e70  00002e70  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 18 .data.rel.ro  00000004  00003e74  00003e74  00002e74  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 19 .dynamic      000000f8  00003e78  00003e78  00002e78  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 20 .got          00000090  00003f70  00003f70  00002f70  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 21 .bss          00000004  00004000  00004000  00003000  2**0\n                  ALLOC\n 22 .gnu_debuglink 00000020  00000000  00000000  00003000  2**2\n                  CONTENTS, READONLY\n 23 .gnu_debugdata 00000424  00000000  00000000  00003020  2**0\n                  CONTENTS, READONLY\nSYMBOL TABLE:\nno symbols\n\n\n\n/lib64/libkeyutils.so.1:     file format elf64-x86-64\n/lib64/libkeyutils.so.1\narchitecture: i386:x86-64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000000000014b0\n\nProgram Header:\n    LOAD off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**21\n         filesz 0x000000000000290c memsz 0x000000000000290c flags r-x\n    LOAD off    0x0000000000002cd0 vaddr 0x0000000000202cd0 paddr 0x0000000000202cd0 align 2**21\n         filesz 0x0000000000000330 memsz 0x0000000000000338 flags rw-\n DYNAMIC off    0x0000000000002ce8 vaddr 0x0000000000202ce8 paddr 0x0000000000202ce8 align 2**3\n         filesz 0x00000000000001f0 memsz 0x00000000000001f0 flags rw-\n    NOTE off    0x00000000000001c8 vaddr 0x00000000000001c8 paddr 0x00000000000001c8 align 2**2\n         filesz 0x0000000000000024 memsz 0x0000000000000024 flags r--\nEH_FRAME off    0x0000000000002250 vaddr 0x0000000000002250 paddr 0x0000000000002250 align 2**2\n         filesz 0x000000000000012c memsz 0x000000000000012c flags r--\n   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**4\n         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rw-\n   RELRO off    0x0000000000002cd0 vaddr 0x0000000000202cd0 paddr 0x0000000000202cd0 align 2**0\n         filesz 0x0000000000000330 memsz 0x0000000000000330 flags r--\n\nDynamic Section:\n  NEEDED               libdl.so.2\n  NEEDED               libc.so.6\n  SONAME               libkeyutils.so.1\n  INIT                 0x0000000000001390\n  FINI                 0x000000000000219c\n  INIT_ARRAY           0x0000000000202cd0\n  INIT_ARRAYSZ         0x0000000000000008\n  FINI_ARRAY           0x0000000000202cd8\n  FINI_ARRAYSZ         0x0000000000000008\n  GNU_HASH             0x00000000000001f0\n  STRTAB               0x00000000000009e8\n  SYMTAB               0x0000000000000370\n  STRSZ                0x0000000000000455\n  SYMENT               0x0000000000000018\n  PLTGOT               0x0000000000202ed8\n  RELA                 0x0000000000001018\n  RELASZ               0x0000000000000378\n  RELAENT              0x0000000000000018\n  VERDEF               0x0000000000000ec8\n  VERDEFNUM            0x0000000000000007\n  BIND_NOW             0x0000000000000000\n  FLAGS_1              0x0000000000000001\n  VERNEED              0x0000000000000fb8\n  VERNEEDNUM           0x0000000000000001\n  VERSYM               0x0000000000000e3e\n  RELACOUNT            0x0000000000000003\n\nVersion definitions:\n1 0x01 0x02928561 libkeyutils.so.1\n2 0x00 0x0ae3c993 KEYUTILS_0.3\n3 0x00 0x0ae3ca90 KEYUTILS_1.0\n\tKEYUTILS_0.3\n4 0x00 0x0ae3ca93 KEYUTILS_1.3\n\tKEYUTILS_1.0\n5 0x00 0x0ae3ca94 KEYUTILS_1.4\n\tKEYUTILS_1.3\n6 0x00 0x0ae3ca95 KEYUTILS_1.5\n\tKEYUTILS_1.4\n7 0x00 0x0ae3ca96 KEYUTILS_1.6\n\tKEYUTILS_1.5\n\nVersion References:\n  required from libc.so.6:\n    0x09691974 0x00 12 GLIBC_2.3.4\n    0x0d696917 0x00 11 GLIBC_2.7\n    0x06969194 0x00 10 GLIBC_2.14\n    0x0d696914 0x00 09 GLIBC_2.4\n    0x09691a75 0x00 08 GLIBC_2.2.5\n\nSections:\nIdx Name          Size      VMA               LMA               File off  Algn\n  0 .note.gnu.build-id 00000024  00000000000001c8  00000000000001c8  000001c8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  1 .gnu.hash     00000180  00000000000001f0  00000000000001f0  000001f0  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  2 .dynsym       00000678  0000000000000370  0000000000000370  00000370  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .dynstr       00000455  00000000000009e8  00000000000009e8  000009e8  2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .gnu.version  0000008a  0000000000000e3e  0000000000000e3e  00000e3e  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  5 .gnu.version_d 000000ec  0000000000000ec8  0000000000000ec8  00000ec8  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  6 .gnu.version_r 00000060  0000000000000fb8  0000000000000fb8  00000fb8  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  7 .rela.dyn     00000378  0000000000001018  0000000000001018  00001018  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  8 .init         00000017  0000000000001390  0000000000001390  00001390  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  9 .plt          00000010  00000000000013b0  00000000000013b0  000013b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 10 .plt.got      000000f0  00000000000013c0  00000000000013c0  000013c0  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 11 .text         00000cec  00000000000014b0  00000000000014b0  000014b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 12 .fini         00000009  000000000000219c  000000000000219c  0000219c  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 13 .rodata       000000a0  00000000000021b0  00000000000021b0  000021b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 14 .eh_frame_hdr 0000012c  0000000000002250  0000000000002250  00002250  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 15 .eh_frame     0000058c  0000000000002380  0000000000002380  00002380  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 16 .init_array   00000008  0000000000202cd0  0000000000202cd0  00002cd0  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 17 .fini_array   00000008  0000000000202cd8  0000000000202cd8  00002cd8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 18 .data.rel.ro  00000008  0000000000202ce0  0000000000202ce0  00002ce0  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 19 .dynamic      000001f0  0000000000202ce8  0000000000202ce8  00002ce8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 20 .got          00000128  0000000000202ed8  0000000000202ed8  00002ed8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 21 .bss          00000008  0000000000203000  0000000000203000  00003000  2**0\n                  ALLOC\n 22 .gnu_debuglink 00000020  0000000000000000  0000000000000000  00003000  2**2\n                  CONTENTS, READONLY\n 23 .gnu_debugdata 00000414  0000000000000000  0000000000000000  00003020  2**0\n                  CONTENTS, READONLY\nSYMBOL TABLE:\nno symbols\n'
DUMP_FOUND_1 = '\n\n/lib/libkeyutils.so.1:     file format elf32-i386\n/lib/libkeyutils.so.1\narchitecture: i386, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000f80\n\nProgram Header:\n    LOAD off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**12\n         filesz 0x000028b4 memsz 0x000028b4 flags r-x\n    LOAD off    0x00002e6c vaddr 0x00003e6c paddr 0x00003e6c align 2**12\n         filesz 0x00000194 memsz 0x00000198 flags rw-\n DYNAMIC off    0x00002e78 vaddr 0x00003e78 paddr 0x00003e78 align 2**2\n         filesz 0x000000f8 memsz 0x000000f8 flags rw-\n    NOTE off    0x00000114 vaddr 0x00000114 paddr 0x00000114 align 2**2\n         filesz 0x00000024 memsz 0x00000024 flags r--\nEH_FRAME off    0x000021d8 vaddr 0x000021d8 paddr 0x000021d8 align 2**2\n         filesz 0x00000134 memsz 0x00000134 flags r--\n   STACK off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**4\n         filesz 0x00000000 memsz 0x00000000 flags rw-\n   RELRO off    0x00002e6c vaddr 0x00003e6c paddr 0x00003e6c align 2**0\n         filesz 0x00000194 memsz 0x00000194 flags r--\n\nDynamic Section:\n  NEEDED               libdl.so.2\n  NEEDED               libc.so.6\n  NEEDED               libsbr.so\n  SONAME               libkeyutils.so.1\n  INIT                 0x00000e54\n  FINI                 0x00002134\n  INIT_ARRAY           0x00003e6c\n  INIT_ARRAYSZ         0x00000004\n  FINI_ARRAY           0x00003e70\n  FINI_ARRAYSZ         0x00000004\n  GNU_HASH             0x00000138\n  STRTAB               0x000006f8\n  SYMTAB               0x000002b8\n  STRSZ                0x00000457\n  SYMENT               0x00000010\n  PLTGOT               0x00003f70\n  REL                  0x00000d34\n  RELSZ                0x00000120\n  RELENT               0x00000008\n  VERDEF               0x00000bd8\n  VERDEFNUM            0x00000007\n  BIND_NOW             0x00000000\n  FLAGS_1              0x00000001\n  VERNEED              0x00000cc4\n  VERNEEDNUM           0x00000001\n  VERSYM               0x00000b50\n  RELCOUNT             0x00000003\n\nVersion definitions:\n1 0x01 0x02928561 libkeyutils.so.1\n2 0x00 0x0ae3c993 KEYUTILS_0.3\n3 0x00 0x0ae3ca90 KEYUTILS_1.0\n\tKEYUTILS_0.3\n4 0x00 0x0ae3ca93 KEYUTILS_1.3\n\tKEYUTILS_1.0\n5 0x00 0x0ae3ca94 KEYUTILS_1.4\n\tKEYUTILS_1.3\n6 0x00 0x0ae3ca95 KEYUTILS_1.5\n\tKEYUTILS_1.4\n7 0x00 0x0ae3ca96 KEYUTILS_1.6\n\tKEYUTILS_1.5\n\nVersion References:\n  required from libc.so.6:\n    0x09691974 0x00 13 GLIBC_2.3.4\n    0x0d696917 0x00 12 GLIBC_2.7\n    0x09691f73 0x00 11 GLIBC_2.1.3\n    0x0d696914 0x00 10 GLIBC_2.4\n    0x0d696911 0x00 09 GLIBC_2.1\n    0x0d696910 0x00 08 GLIBC_2.0\n\nSections:\nIdx Name          Size      VMA       LMA       File off  Algn\n  0 .note.gnu.build-id 00000024  00000114  00000114  00000114  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  1 .gnu.hash     00000180  00000138  00000138  00000138  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  2 .dynsym       00000440  000002b8  000002b8  000002b8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .dynstr       00000457  000006f8  000006f8  000006f8  2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .gnu.version  00000088  00000b50  00000b50  00000b50  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  5 .gnu.version_d 000000ec  00000bd8  00000bd8  00000bd8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  6 .gnu.version_r 00000070  00000cc4  00000cc4  00000cc4  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  7 .rel.dyn      00000120  00000d34  00000d34  00000d34  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  8 .init         00000023  00000e54  00000e54  00000e54  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  9 .plt          00000010  00000e80  00000e80  00000e80  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 10 .plt.got      000000f0  00000e90  00000e90  00000e90  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 11 .text         000011b4  00000f80  00000f80  00000f80  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 12 .fini         00000014  00002134  00002134  00002134  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 13 .rodata       00000090  00002148  00002148  00002148  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 14 .eh_frame_hdr 00000134  000021d8  000021d8  000021d8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 15 .eh_frame     000005a8  0000230c  0000230c  0000230c  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 16 .init_array   00000004  00003e6c  00003e6c  00002e6c  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 17 .fini_array   00000004  00003e70  00003e70  00002e70  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 18 .data.rel.ro  00000004  00003e74  00003e74  00002e74  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 19 .dynamic      000000f8  00003e78  00003e78  00002e78  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 20 .got          00000090  00003f70  00003f70  00002f70  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 21 .bss          00000004  00004000  00004000  00003000  2**0\n                  ALLOC\n 22 .gnu_debuglink 00000020  00000000  00000000  00003000  2**2\n                  CONTENTS, READONLY\n 23 .gnu_debugdata 00000424  00000000  00000000  00003020  2**0\n                  CONTENTS, READONLY\nSYMBOL TABLE:\nno symbols\n\n\n\n/lib64/libkeyutils.so.1:     file format elf64-x86-64\n/lib64/libkeyutils.so.1\narchitecture: i386:x86-64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000000000014b0\n\nProgram Header:\n    LOAD off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**21\n         filesz 0x000000000000290c memsz 0x000000000000290c flags r-x\n    LOAD off    0x0000000000002cd0 vaddr 0x0000000000202cd0 paddr 0x0000000000202cd0 align 2**21\n         filesz 0x0000000000000330 memsz 0x0000000000000338 flags rw-\n DYNAMIC off    0x0000000000002ce8 vaddr 0x0000000000202ce8 paddr 0x0000000000202ce8 align 2**3\n         filesz 0x00000000000001f0 memsz 0x00000000000001f0 flags rw-\n    NOTE off    0x00000000000001c8 vaddr 0x00000000000001c8 paddr 0x00000000000001c8 align 2**2\n         filesz 0x0000000000000024 memsz 0x0000000000000024 flags r--\nEH_FRAME off    0x0000000000002250 vaddr 0x0000000000002250 paddr 0x0000000000002250 align 2**2\n         filesz 0x000000000000012c memsz 0x000000000000012c flags r--\n   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**4\n         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rw-\n   RELRO off    0x0000000000002cd0 vaddr 0x0000000000202cd0 paddr 0x0000000000202cd0 align 2**0\n         filesz 0x0000000000000330 memsz 0x0000000000000330 flags r--\n\nDynamic Section:\n  NEEDED               libdl.so.2\n  NEEDED               libc.so.6\n  SONAME               libkeyutils.so.1\n  INIT                 0x0000000000001390\n  FINI                 0x000000000000219c\n  INIT_ARRAY           0x0000000000202cd0\n  INIT_ARRAYSZ         0x0000000000000008\n  FINI_ARRAY           0x0000000000202cd8\n  FINI_ARRAYSZ         0x0000000000000008\n  GNU_HASH             0x00000000000001f0\n  STRTAB               0x00000000000009e8\n  SYMTAB               0x0000000000000370\n  STRSZ                0x0000000000000455\n  SYMENT               0x0000000000000018\n  PLTGOT               0x0000000000202ed8\n  RELA                 0x0000000000001018\n  RELASZ               0x0000000000000378\n  RELAENT              0x0000000000000018\n  VERDEF               0x0000000000000ec8\n  VERDEFNUM            0x0000000000000007\n  BIND_NOW             0x0000000000000000\n  FLAGS_1              0x0000000000000001\n  VERNEED              0x0000000000000fb8\n  VERNEEDNUM           0x0000000000000001\n  VERSYM               0x0000000000000e3e\n  RELACOUNT            0x0000000000000003\n\nVersion definitions:\n1 0x01 0x02928561 libkeyutils.so.1\n2 0x00 0x0ae3c993 KEYUTILS_0.3\n3 0x00 0x0ae3ca90 KEYUTILS_1.0\n\tKEYUTILS_0.3\n4 0x00 0x0ae3ca93 KEYUTILS_1.3\n\tKEYUTILS_1.0\n5 0x00 0x0ae3ca94 KEYUTILS_1.4\n\tKEYUTILS_1.3\n6 0x00 0x0ae3ca95 KEYUTILS_1.5\n\tKEYUTILS_1.4\n7 0x00 0x0ae3ca96 KEYUTILS_1.6\n\tKEYUTILS_1.5\n\nVersion References:\n  required from libc.so.6:\n    0x09691974 0x00 12 GLIBC_2.3.4\n    0x0d696917 0x00 11 GLIBC_2.7\n    0x06969194 0x00 10 GLIBC_2.14\n    0x0d696914 0x00 09 GLIBC_2.4\n    0x09691a75 0x00 08 GLIBC_2.2.5\n\nSections:\nIdx Name          Size      VMA               LMA               File off  Algn\n  0 .note.gnu.build-id 00000024  00000000000001c8  00000000000001c8  000001c8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  1 .gnu.hash     00000180  00000000000001f0  00000000000001f0  000001f0  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  2 .dynsym       00000678  0000000000000370  0000000000000370  00000370  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .dynstr       00000455  00000000000009e8  00000000000009e8  000009e8  2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .gnu.version  0000008a  0000000000000e3e  0000000000000e3e  00000e3e  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  5 .gnu.version_d 000000ec  0000000000000ec8  0000000000000ec8  00000ec8  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  6 .gnu.version_r 00000060  0000000000000fb8  0000000000000fb8  00000fb8  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  7 .rela.dyn     00000378  0000000000001018  0000000000001018  00001018  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  8 .init         00000017  0000000000001390  0000000000001390  00001390  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  9 .plt          00000010  00000000000013b0  00000000000013b0  000013b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 10 .plt.got      000000f0  00000000000013c0  00000000000013c0  000013c0  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 11 .text         00000cec  00000000000014b0  00000000000014b0  000014b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 12 .fini         00000009  000000000000219c  000000000000219c  0000219c  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 13 .rodata       000000a0  00000000000021b0  00000000000021b0  000021b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 14 .eh_frame_hdr 0000012c  0000000000002250  0000000000002250  00002250  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 15 .eh_frame     0000058c  0000000000002380  0000000000002380  00002380  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 16 .init_array   00000008  0000000000202cd0  0000000000202cd0  00002cd0  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 17 .fini_array   00000008  0000000000202cd8  0000000000202cd8  00002cd8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 18 .data.rel.ro  00000008  0000000000202ce0  0000000000202ce0  00002ce0  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 19 .dynamic      000001f0  0000000000202ce8  0000000000202ce8  00002ce8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 20 .got          00000128  0000000000202ed8  0000000000202ed8  00002ed8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 21 .bss          00000008  0000000000203000  0000000000203000  00003000  2**0\n                  ALLOC\n 22 .gnu_debuglink 00000020  0000000000000000  0000000000000000  00003000  2**2\n                  CONTENTS, READONLY\n 23 .gnu_debugdata 00000414  0000000000000000  0000000000000000  00003020  2**0\n                  CONTENTS, READONLY\nSYMBOL TABLE:\nno symbols\n'
DUMP_FOUND_2 = '\n\n/lib/libkeyutils.so.1:     file format elf32-i386\n/lib/libkeyutils.so.1\narchitecture: i386, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000f80\n\nProgram Header:\n    LOAD off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**12\n         filesz 0x000028b4 memsz 0x000028b4 flags r-x\n    LOAD off    0x00002e6c vaddr 0x00003e6c paddr 0x00003e6c align 2**12\n         filesz 0x00000194 memsz 0x00000198 flags rw-\n DYNAMIC off    0x00002e78 vaddr 0x00003e78 paddr 0x00003e78 align 2**2\n         filesz 0x000000f8 memsz 0x000000f8 flags rw-\n    NOTE off    0x00000114 vaddr 0x00000114 paddr 0x00000114 align 2**2\n         filesz 0x00000024 memsz 0x00000024 flags r--\nEH_FRAME off    0x000021d8 vaddr 0x000021d8 paddr 0x000021d8 align 2**2\n         filesz 0x00000134 memsz 0x00000134 flags r--\n   STACK off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**4\n         filesz 0x00000000 memsz 0x00000000 flags rw-\n   RELRO off    0x00002e6c vaddr 0x00003e6c paddr 0x00003e6c align 2**0\n         filesz 0x00000194 memsz 0x00000194 flags r--\n\nDynamic Section:\n  NEEDED               libdl.so.2\n  NEEDED               libc.so.6\n  NEEDED               libsbr.so\n  SONAME               libkeyutils.so.1\n  INIT                 0x00000e54\n  FINI                 0x00002134\n  INIT_ARRAY           0x00003e6c\n  INIT_ARRAYSZ         0x00000004\n  FINI_ARRAY           0x00003e70\n  FINI_ARRAYSZ         0x00000004\n  GNU_HASH             0x00000138\n  STRTAB               0x000006f8\n  SYMTAB               0x000002b8\n  STRSZ                0x00000457\n  SYMENT               0x00000010\n  PLTGOT               0x00003f70\n  REL                  0x00000d34\n  RELSZ                0x00000120\n  RELENT               0x00000008\n  VERDEF               0x00000bd8\n  VERDEFNUM            0x00000007\n  BIND_NOW             0x00000000\n  FLAGS_1              0x00000001\n  VERNEED              0x00000cc4\n  VERNEEDNUM           0x00000001\n  VERSYM               0x00000b50\n  RELCOUNT             0x00000003\n\nVersion definitions:\n1 0x01 0x02928561 libkeyutils.so.1\n2 0x00 0x0ae3c993 KEYUTILS_0.3\n3 0x00 0x0ae3ca90 KEYUTILS_1.0\n\tKEYUTILS_0.3\n4 0x00 0x0ae3ca93 KEYUTILS_1.3\n\tKEYUTILS_1.0\n5 0x00 0x0ae3ca94 KEYUTILS_1.4\n\tKEYUTILS_1.3\n6 0x00 0x0ae3ca95 KEYUTILS_1.5\n\tKEYUTILS_1.4\n7 0x00 0x0ae3ca96 KEYUTILS_1.6\n\tKEYUTILS_1.5\n\nVersion References:\n  required from libc.so.6:\n    0x09691974 0x00 13 GLIBC_2.3.4\n    0x0d696917 0x00 12 GLIBC_2.7\n    0x09691f73 0x00 11 GLIBC_2.1.3\n    0x0d696914 0x00 10 GLIBC_2.4\n    0x0d696911 0x00 09 GLIBC_2.1\n    0x0d696910 0x00 08 GLIBC_2.0\n\nSections:\nIdx Name          Size      VMA       LMA       File off  Algn\n  0 .note.gnu.build-id 00000024  00000114  00000114  00000114  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  1 .gnu.hash     00000180  00000138  00000138  00000138  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  2 .dynsym       00000440  000002b8  000002b8  000002b8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .dynstr       00000457  000006f8  000006f8  000006f8  2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .gnu.version  00000088  00000b50  00000b50  00000b50  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  5 .gnu.version_d 000000ec  00000bd8  00000bd8  00000bd8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  6 .gnu.version_r 00000070  00000cc4  00000cc4  00000cc4  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  7 .rel.dyn      00000120  00000d34  00000d34  00000d34  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  8 .init         00000023  00000e54  00000e54  00000e54  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  9 .plt          00000010  00000e80  00000e80  00000e80  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 10 .plt.got      000000f0  00000e90  00000e90  00000e90  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 11 .text         000011b4  00000f80  00000f80  00000f80  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 12 .fini         00000014  00002134  00002134  00002134  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 13 .rodata       00000090  00002148  00002148  00002148  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 14 .eh_frame_hdr 00000134  000021d8  000021d8  000021d8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 15 .eh_frame     000005a8  0000230c  0000230c  0000230c  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 16 .init_array   00000004  00003e6c  00003e6c  00002e6c  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 17 .fini_array   00000004  00003e70  00003e70  00002e70  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 18 .data.rel.ro  00000004  00003e74  00003e74  00002e74  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 19 .dynamic      000000f8  00003e78  00003e78  00002e78  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 20 .got          00000090  00003f70  00003f70  00002f70  2**2\n                  CONTENTS, ALLOC, LOAD, DATA\n 21 .bss          00000004  00004000  00004000  00003000  2**0\n                  ALLOC\n 22 .gnu_debuglink 00000020  00000000  00000000  00003000  2**2\n                  CONTENTS, READONLY\n 23 .gnu_debugdata 00000424  00000000  00000000  00003020  2**0\n                  CONTENTS, READONLY\nSYMBOL TABLE:\nno symbols\n\n\n\n/lib64/libkeyutils.so.1:     file format elf64-x86-64\n/lib64/libkeyutils.so.1\narchitecture: i386:x86-64, flags 0x00000150:\nHAS_SYMS, DYNAMIC, D_PAGED\nstart address 0x00000000000014b0\n\nProgram Header:\n    LOAD off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**21\n         filesz 0x000000000000290c memsz 0x000000000000290c flags r-x\n    LOAD off    0x0000000000002cd0 vaddr 0x0000000000202cd0 paddr 0x0000000000202cd0 align 2**21\n         filesz 0x0000000000000330 memsz 0x0000000000000338 flags rw-\n DYNAMIC off    0x0000000000002ce8 vaddr 0x0000000000202ce8 paddr 0x0000000000202ce8 align 2**3\n         filesz 0x00000000000001f0 memsz 0x00000000000001f0 flags rw-\n    NOTE off    0x00000000000001c8 vaddr 0x00000000000001c8 paddr 0x00000000000001c8 align 2**2\n         filesz 0x0000000000000024 memsz 0x0000000000000024 flags r--\nEH_FRAME off    0x0000000000002250 vaddr 0x0000000000002250 paddr 0x0000000000002250 align 2**2\n         filesz 0x000000000000012c memsz 0x000000000000012c flags r--\n   STACK off    0x0000000000000000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**4\n         filesz 0x0000000000000000 memsz 0x0000000000000000 flags rw-\n   RELRO off    0x0000000000002cd0 vaddr 0x0000000000202cd0 paddr 0x0000000000202cd0 align 2**0\n         filesz 0x0000000000000330 memsz 0x0000000000000330 flags r--\n\nDynamic Section:\n  NEEDED               libdl.so.2\n  NEEDED               libsbr.so.6\n  NEEDED               libfake.so\n  SONAME               libkeyutils.so.1\n  INIT                 0x0000000000001390\n  FINI                 0x000000000000219c\n  INIT_ARRAY           0x0000000000202cd0\n  INIT_ARRAYSZ         0x0000000000000008\n  FINI_ARRAY           0x0000000000202cd8\n  FINI_ARRAYSZ         0x0000000000000008\n  GNU_HASH             0x00000000000001f0\n  STRTAB               0x00000000000009e8\n  SYMTAB               0x0000000000000370\n  STRSZ                0x0000000000000455\n  SYMENT               0x0000000000000018\n  PLTGOT               0x0000000000202ed8\n  RELA                 0x0000000000001018\n  RELASZ               0x0000000000000378\n  RELAENT              0x0000000000000018\n  VERDEF               0x0000000000000ec8\n  VERDEFNUM            0x0000000000000007\n  BIND_NOW             0x0000000000000000\n  FLAGS_1              0x0000000000000001\n  VERNEED              0x0000000000000fb8\n  VERNEEDNUM           0x0000000000000001\n  VERSYM               0x0000000000000e3e\n  RELACOUNT            0x0000000000000003\n\nVersion definitions:\n1 0x01 0x02928561 libkeyutils.so.1\n2 0x00 0x0ae3c993 KEYUTILS_0.3\n3 0x00 0x0ae3ca90 KEYUTILS_1.0\n\tKEYUTILS_0.3\n4 0x00 0x0ae3ca93 KEYUTILS_1.3\n\tKEYUTILS_1.0\n5 0x00 0x0ae3ca94 KEYUTILS_1.4\n\tKEYUTILS_1.3\n6 0x00 0x0ae3ca95 KEYUTILS_1.5\n\tKEYUTILS_1.4\n7 0x00 0x0ae3ca96 KEYUTILS_1.6\n\tKEYUTILS_1.5\n\nVersion References:\n  required from libc.so.6:\n    0x09691974 0x00 12 GLIBC_2.3.4\n    0x0d696917 0x00 11 GLIBC_2.7\n    0x06969194 0x00 10 GLIBC_2.14\n    0x0d696914 0x00 09 GLIBC_2.4\n    0x09691a75 0x00 08 GLIBC_2.2.5\n\nSections:\nIdx Name          Size      VMA               LMA               File off  Algn\n  0 .note.gnu.build-id 00000024  00000000000001c8  00000000000001c8  000001c8  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  1 .gnu.hash     00000180  00000000000001f0  00000000000001f0  000001f0  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  2 .dynsym       00000678  0000000000000370  0000000000000370  00000370  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  3 .dynstr       00000455  00000000000009e8  00000000000009e8  000009e8  2**0\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  4 .gnu.version  0000008a  0000000000000e3e  0000000000000e3e  00000e3e  2**1\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  5 .gnu.version_d 000000ec  0000000000000ec8  0000000000000ec8  00000ec8  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  6 .gnu.version_r 00000060  0000000000000fb8  0000000000000fb8  00000fb8  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  7 .rela.dyn     00000378  0000000000001018  0000000000001018  00001018  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n  8 .init         00000017  0000000000001390  0000000000001390  00001390  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n  9 .plt          00000010  00000000000013b0  00000000000013b0  000013b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 10 .plt.got      000000f0  00000000000013c0  00000000000013c0  000013c0  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 11 .text         00000cec  00000000000014b0  00000000000014b0  000014b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 12 .fini         00000009  000000000000219c  000000000000219c  0000219c  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, CODE\n 13 .rodata       000000a0  00000000000021b0  00000000000021b0  000021b0  2**4\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 14 .eh_frame_hdr 0000012c  0000000000002250  0000000000002250  00002250  2**2\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 15 .eh_frame     0000058c  0000000000002380  0000000000002380  00002380  2**3\n                  CONTENTS, ALLOC, LOAD, READONLY, DATA\n 16 .init_array   00000008  0000000000202cd0  0000000000202cd0  00002cd0  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 17 .fini_array   00000008  0000000000202cd8  0000000000202cd8  00002cd8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 18 .data.rel.ro  00000008  0000000000202ce0  0000000000202ce0  00002ce0  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 19 .dynamic      000001f0  0000000000202ce8  0000000000202ce8  00002ce8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 20 .got          00000128  0000000000202ed8  0000000000202ed8  00002ed8  2**3\n                  CONTENTS, ALLOC, LOAD, DATA\n 21 .bss          00000008  0000000000203000  0000000000203000  00003000  2**0\n                  ALLOC\n 22 .gnu_debuglink 00000020  0000000000000000  0000000000000000  00003000  2**2\n                  CONTENTS, READONLY\n 23 .gnu_debugdata 00000414  0000000000000000  0000000000000000  00003020  2**0\n                  CONTENTS, READONLY\nSYMBOL TABLE:\nno symbols\n'

def test_libkeyutils():
    libkeyutils_search = Libkeyutils(context_wrap(SEARCH_NOT_FOUND))
    assert libkeyutils_search.libraries == SEARCH_NOT_FOUND.strip().split('\n')
    libkeyutils_search = Libkeyutils(context_wrap(SEARCH_FOUND_1))
    assert libkeyutils_search.libraries == SEARCH_FOUND_1.strip().split('\n')
    libkeyutils_search = Libkeyutils(context_wrap(SEARCH_FOUND_2))
    assert libkeyutils_search.libraries == SEARCH_FOUND_2.strip().split('\n')


def test_libkeyutilsobjdumps():
    libkeyutils_dumps = LibkeyutilsObjdumps(context_wrap(DUMP_NOT_FOUND))
    assert len(libkeyutils_dumps.linked_libraries) == 2
    assert libkeyutils_dumps.linked_libraries == {'/lib/libkeyutils.so.1': [
                               'libdl.so.2', 'libc.so.6'], 
       '/lib64/libkeyutils.so.1': [
                                 'libdl.so.2', 'libc.so.6']}
    libkeyutils_dumps = LibkeyutilsObjdumps(context_wrap(DUMP_FOUND_1))
    assert len(libkeyutils_dumps.linked_libraries) == 2
    assert libkeyutils_dumps.linked_libraries == {'/lib/libkeyutils.so.1': [
                               'libdl.so.2', 'libc.so.6', 'libsbr.so'], 
       '/lib64/libkeyutils.so.1': [
                                 'libdl.so.2', 'libc.so.6']}
    libkeyutils_dumps = LibkeyutilsObjdumps(context_wrap(DUMP_FOUND_2))
    assert len(libkeyutils_dumps.linked_libraries) == 2
    assert libkeyutils_dumps.linked_libraries == {'/lib/libkeyutils.so.1': [
                               'libdl.so.2', 'libc.so.6', 'libsbr.so'], 
       '/lib64/libkeyutils.so.1': [
                                 'libdl.so.2', 'libsbr.so.6', 'libfake.so']}