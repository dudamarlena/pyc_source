# uncompyle6 version 3.7.4
# Python bytecode 2.7 (62211)
# Decompiled from: Python 3.6.9 (default, Apr 18 2020, 01:56:04) 
# [GCC 8.4.0]
# Embedded file name: build/bdist.linux-x86_64/egg/insights/parsers/tests/test_tomcat_xml.py
# Compiled at: 2019-05-16 13:41:33
from insights.tests import context_wrap
from insights.parsers import tomcat_xml
from insights.parsers.tomcat_xml import TomcatWebXml
from insights.parsers.tomcat_xml import TomcatServerXml
import doctest
web_xml_content = ('\n<?xml version="1.0" encoding="ISO-8859-1"?>\n<!--\n  Licensed to the Apache Software Foundation (ASF) under one or more\n  contributor license agreements.  See the NOTICE file distributed with\n  this work for additional information regarding copyright ownership.\n  The ASF licenses this file to You under the Apache License, Version 2.0\n  (the "License"); you may not use this file except in compliance with\n  the License.  You may obtain a copy of the License at\n\n      http://www.apache.org/licenses/LICENSE-2.0\n\n  Unless required by applicable law or agreed to in writing, software\n  distributed under the License is distributed on an "AS IS" BASIS,\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n  See the License for the specific language governing permissions and\n  limitations under the License.\n-->\n<web-app xmlns="http://java.sun.com/xml/ns/javaee"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"\n    version="2.5">\n\n  <!-- ======================== Introduction ============================== -->\n  <!-- This document defines default values for *all* web applications      -->\n  <!-- loaded into this instance of Tomcat.  As each application is         -->\n  <!-- deployed, this file is processed, followed by the                    -->\n  <!-- "/WEB-INF/web.xml" deployment descriptor from your own               -->\n  <!-- applications.                                                        -->\n  <!--                                                                      -->\n  <!-- WARNING:  Do not configure application-specific resources here!      -->\n  <!-- They should go in the "/WEB-INF/web.xml" file in your application.   -->\n\n\n  <!-- ================== Built In Servlet Definitions ==================== -->\n\n\n  <!-- The default servlet for all web applications, that serves static     -->\n  <!-- resources.  It processes all requests that are not mapped to other   -->\n  <!-- servlets with servlet mappings (defined either here or in your own   -->\n  <!-- web.xml file.  This servlet supports the following initialization    -->\n  <!-- parameters (default values are in square brackets):                  -->\n  <!--                                                                      -->\n  <!--   debug               Debugging detail level for messages logged     -->\n  <!--                       by this servlet.  [0]                          -->\n  <!--                                                                      -->\n  <!--   fileEncoding        Encoding to be used to read static resources   -->\n  <!--                       [platform default]                             -->\n  <!--                                                                      -->\n  <!--   input               Input buffer size (in bytes) when reading      -->\n  <!--                       resources to be served.  [2048]                -->\n  <!--                                                                      -->\n  <!--   listings            Should directory listings be produced if there -->\n  <!--                       is no welcome file in this directory?  [false] -->\n  <!--                       WARNING: Listings for directories with many    -->\n  <!--                       entries can be slow and may consume            -->\n  <!--                       significant proportions of server resources.   -->\n  <!--                                                                      -->\n  <!--   output              Output buffer size (in bytes) when writing     -->\n  <!--                       resources to be served.  [2048]                -->\n  <!--                                                                      -->\n  <!--   readonly            Is this context "read only", so HTTP           -->\n  <!--                       commands like PUT and DELETE are               -->\n  <!--                       rejected?  [true]                              -->\n  <!--                                                                      -->\n  <!--   readmeFile          File name to display with the directory        -->\n  <!--                       contents. [null]                               -->\n  <!--                                                                      -->\n  <!--   sendfileSize        If the connector used supports sendfile, this  -->\n  <!--                       represents the minimal file size in KB for     -->\n  <!--                       which sendfile will be used. Use a negative    -->\n  <!--                       value to always disable sendfile.  [48]        -->\n  <!--                                                                      -->\n  <!--   useAcceptRanges     Should the Accept-Ranges header be included    -->\n  <!--                       in responses where appropriate? [true]         -->\n  <!--                                                                      -->\n  <!--  For directory listing customization. Checks localXsltFile, then     -->\n  <!--  globalXsltFile, then defaults to original behavior.                 -->\n  <!--                                                                      -->\n  <!--   localXsltFile       Make directory listings an XML doc and         -->\n  <!--                       pass the result to this style sheet residing   -->\n  <!--                       in that directory. This overrides              -->\n  <!--                        globalXsltFile[null]                          -->\n  <!--                                                                      -->\n  <!--   globalXsltFile      Site wide configuration version of             -->\n  <!--                       localXsltFile. This argument must either       -->\n  <!--                        an aboslute or relative ( to either           -->\n  <!--                        CATALINA_BASE/conf or CATALINA_HOME/conf     -->\n  <!--                        path that points to the location below       -->\n  <!--                        CATALINA_BASE/conf (checked first) or        -->\n  <!--                        $CATLINA_HOME/conf (checked second).         -->\n  <!--                                                                      -->\n  <!--                                                                      -->\n\n    <servlet>\n        <servlet-name>default</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n        <init-param>\n            <param-name>debug</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <init-param>\n            <param-name>listings</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n\n\n  <!-- This servlet has been deprecated due to security concerns. Servlets  -->\n  <!-- should be explicitly mapped in web.xml                               -->\n  <!--                                                                      -->\n  <!-- The "invoker" servlet, which executes anonymous servlet classes      -->\n  <!-- that have not been defined in a web.xml file.  Traditionally, this   -->\n  <!-- servlet is mapped to the URL pattern "/servlet/*", but you can map   -->\n  <!-- it to other patterns as well.  The extra path info portion of such a -->\n  <!-- request must be the fully qualified class name of a Java class that  -->\n  <!-- implements Servlet (or extends HttpServlet), or the servlet name     -->\n  <!-- of an existing servlet definition.     This servlet supports the     -->\n  <!-- following initialization parameters (default values are in square    -->\n  <!-- brackets):                                                           -->\n  <!--                                                                      -->\n  <!--   debug               Debugging detail level for messages logged     -->\n  <!--                       by this servlet.  [0]                          -->\n\n<!--\n    <servlet>\n        <servlet-name>invoker</servlet-name>\n        <servlet-class>\n          org.apache.catalina.servlets.InvokerServlet\n        </servlet-class>\n        <init-param>\n            <param-name>debug</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <load-on-startup>2</load-on-startup>\n    </servlet>\n-->\n\n\n  <!-- The JSP page compiler and execution servlet, which is the mechanism  -->\n  <!-- used by Tomcat to support JSP pages.  Traditionally, this servlet    -->\n  <!-- is mapped to the URL pattern "*.jsp".  This servlet supports the     -->\n  <!-- following initialization parameters (default values are in square    -->\n  <!-- brackets):                                                           -->\n  <!--                                                                      -->\n  <!--   checkInterval       If development is false and checkInterval is   -->\n  <!--                       greater than zero, background compilations are -->\n  <!--                       enabled. checkInterval is the time in seconds  -->\n  <!--                       between checks to see if a JSP page (and its   -->\n  <!--                       dependent files) needs to  be recompiled. [0]  -->\n  <!--                                                                      -->\n  <!--   classdebuginfo      Should the class file be compiled with         -->\n  <!--                       debugging information?  [true]                 -->\n  <!--                                                                      -->\n  <!--   classpath           What class path should I use while compiling   -->\n  <!--                       generated servlets?  [Created dynamically      -->\n  <!--                       based on the current web application]          -->\n  <!--                                                                      -->\n  <!--   compiler            Which compiler Ant should use to compile JSP   -->\n  <!--                       pages.  See the jasper documentation for more  -->\n  <!--                       information.                                   -->\n  <!--                                                                      -->\n  <!--   compilerSourceVM    Compiler source VM. [1.5]                      -->\n  <!--                                                                      -->\n  <!--   compilerTargetVM    Compiler target VM. [1.5]                      -->\n  <!--                                                                      -->\n  <!--   development         Is Jasper used in development mode? If true,   -->\n  <!--                       the frequency at which JSPs are checked for    -->\n  <!--                       modification may be specified via the          -->\n  <!--                       modificationTestInterval parameter. [true]     -->\n  <!--                                                                      -->\n  <!--   displaySourceFragment                                              -->\n  <!--                       Should a source fragment be included in        -->\n  <!--                       exception messages? [true]                     -->\n  <!--                                                                      -->\n  <!--   dumpSmap            Should the SMAP info for JSR45 debugging be    -->\n  <!--                       dumped to a file? [false]                      -->\n  <!--                       False if suppressSmap is true                  -->\n  <!--                                                                      -->\n  <!--   enablePooling       Determines whether tag handler pooling is      -->\n  <!--                       enabled. This is a compilation option. It will -->\n  <!--                       not alter the behaviour of JSPs that have      -->\n  <!--                       already been compiled. [true]                  -->\n  <!--                                                                      -->\n  <!--   engineOptionsClass  Allows specifying the Options class used to    -->\n  <!--                       configure Jasper. If not present, the default  -->\n  <!--                       EmbeddedServletOptions will be used.           -->\n  <!--                                                                      -->\n  <!--   errorOnUseBeanInvalidClassAttribute                                -->\n  <!--                       Should Jasper issue an error when the value of -->\n  <!--                       the class attribute in an useBean action is    -->\n  <!--                       not a valid bean class?  [true]                -->\n  <!--                                                                      -->\n  <!--   fork                Tell Ant to fork compiles of JSP pages so that -->\n  <!--                       a separate JVM is used for JSP page compiles   -->\n  <!--                       from the one Tomcat is running in. [true]      -->\n  <!--                                                                      -->\n  <!--   genStrAsCharArray   Should text strings be generated as char       -->\n  <!--                       arrays, to improve performance in some cases?  -->\n  <!--                       [false]                                        -->\n  <!--                                                                      -->\n  <!--   ieClassId           The class-id value to be sent to Internet      -->\n  <!--                       Explorer when using <jsp:plugin> tags.         -->\n  <!--                       [clsid:8AD9C840-044E-11D1-B3E9-00805F499D93]   -->\n  <!--                                                                      -->\n  <!--   javaEncoding        Java file encoding to use for generating java  -->\n  <!--                       source files. [UTF8]                           -->\n  <!--                                                                      -->\n  <!--   keepgenerated       Should we keep the generated Java source code  -->\n  <!--                       for each page instead of deleting it? [true]   -->\n  <!--                                                                      -->\n  <!--   mappedfile          Should we generate static content with one     -->\n  <!--                       print statement per input line, to ease        -->\n  <!--                       debugging?  [true]                             -->\n  <!--                                                                      -->\n  <!--   modificationTestInterval                                           -->\n  <!--                       Causes a JSP (and its dependent files) to not  -->\n  <!--                       be checked for modification during the         -->\n  <!--                       specified time interval (in seconds) from the  -->\n  <!--                       last time the JSP was checked for              -->\n  <!--                       modification. A value of 0 will cause the JSP  -->\n  <!--                       to be checked on every access.                 -->\n  <!--                       Used in development mode only. [4]             -->\n  <!--                                                                      -->\n  <!--   scratchdir          What scratch directory should we use when      -->\n  <!--                       compiling JSP pages?  [default work directory  -->\n  <!--                       for the current web application]               -->\n  <!--                                                                      -->\n  <!--   suppressSmap        Should the generation of SMAP info for JSR45   -->\n  <!--                       debugging be suppressed?  [false]              -->\n  <!--                                                                      -->\n  <!--   trimSpaces          Should white spaces in template text between   -->\n  <!--                       actions or directives be trimmed?  [false]     -->\n  <!--                                                                      -->\n  <!--   xpoweredBy          Determines whether X-Powered-By response       -->\n  <!--                       header is added by generated servlet  [false]  -->\n  <!--                                                                      -->\n  <!-- If you wish to use Jikes to compile JSP pages:                       -->\n  <!--   Please see the "Using Jikes" section of the Jasper-HowTo           -->\n  <!--   page in the Tomcat documentation.                                  -->\n\n    <servlet>\n        <servlet-name>jsp</servlet-name>\n        <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>\n        <init-param>\n            <param-name>fork</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <init-param>\n            <param-name>xpoweredBy</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <init-param>\n            <param-name>development</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <load-on-startup>3</load-on-startup>\n    </servlet>\n\n\n  <!-- NOTE: An SSI Filter is also available as an alternative SSI          -->\n  <!-- implementation. Use either the Servlet or the Filter but NOT both.   -->\n  <!--                                                                      -->\n  <!-- Server Side Includes processing servlet, which processes SSI         -->\n  <!-- directives in HTML pages consistent with similar support in web      -->\n  <!-- servers like Apache.  Traditionally, this servlet is mapped to the   -->\n  <!-- URL pattern "*.shtml".  This servlet supports the following          -->\n  <!-- initialization parameters (default values are in square brackets):   -->\n  <!--                                                                      -->\n  <!--   buffered            Should output from this servlet be buffered?   -->\n  <!--                       (0=false, 1=true)  [0]                         -->\n  <!--                                                                      -->\n  <!--   debug               Debugging detail level for messages logged     -->\n  <!--                       by this servlet.  [0]                          -->\n  <!--                                                                      -->\n  <!--   expires             The number of seconds before a page with SSI   -->\n  <!--                       directives will expire.  [No default]          -->\n  <!--                                                                      -->\n  <!--   isVirtualWebappRelative                                            -->\n  <!--                       Should "virtual" paths be interpreted as       -->\n  <!--                       relative to the context root, instead of       -->\n  <!--                       the server root?  (0=false, 1=true) [0]        -->\n  <!--                                                                      -->\n  <!--   inputEncoding       The encoding to assume for SSI resources if    -->\n  <!--                       one is not available from the resource.        -->\n  <!--                       [Platform default]                             -->\n  <!--                                                                      -->\n  <!--   outputEncoding      The encoding to use for the page that results  -->\n  <!--                       from the SSI processing. [UTF-8]               -->\n\n<!--\n    <servlet>\n        <servlet-name>ssi</servlet-name>\n        <servlet-class>\n          org.apache.catalina.ssi.SSIServlet\n        </servlet-class>\n        <init-param>\n          <param-name>buffered</param-name>\n          <param-value>1</param-value>\n        </init-param>\n        <init-param>\n          <param-name>debug</param-name>\n          <param-value>0</param-value>\n        </init-param>\n        <init-param>\n          <param-name>expires</param-name>\n          <param-value>666</param-value>\n        </init-param>\n        <init-param>\n          <param-name>isVirtualWebappRelative</param-name>\n          <param-value>0</param-value>\n        </init-param>\n        <load-on-startup>4</load-on-startup>\n    </servlet>\n-->\n\n\n  <!-- Common Gateway Includes (CGI) processing servlet, which supports     -->\n  <!-- execution of external applications that conform to the CGI spec      -->\n  <!-- requirements.  Typically, this servlet is mapped to the URL pattern  -->\n  <!-- "/cgi-bin/*", which means that any CGI applications that are         -->\n  <!-- executed must be present within the web application.  This servlet   -->\n  <!-- supports the following initialization parameters (default values     -->\n  <!-- are in square brackets):                                             -->\n  <!--                                                                      -->\n  <!--   cgiPathPrefix        The CGI search path will start at             -->\n  <!--                        webAppRootDir + File.separator + this prefix. -->\n  <!--                        [WEB-INF/cgi]                                 -->\n  <!--                                                                      -->\n  <!--   debug                Debugging detail level for messages logged    -->\n  <!--                        by this servlet.  [0]                         -->\n  <!--                                                                      -->\n  <!--   executable           Name of the executable used to run the        -->\n  <!--                        script. [perl]                                -->\n  <!--                                                                      -->\n  <!--   parameterEncoding    Name of parameter encoding to be used with    -->\n  <!--                        CGI servlet.                                  -->\n  <!--                        [System.getProperty("file.encoding","UTF-8")] -->\n  <!--                                                                      -->\n  <!--   passShellEnvironment Should the shell environment variables (if    -->\n  <!--                        any) be passed to the CGI script? [false]     -->\n  <!--                                                                      -->\n  <!--   stderrTimeout        The time (in milliseconds) to wait for the    -->\n  <!--                        reading of stderr to complete before          -->\n  <!--                        terminating the CGI process. [2000]           -->\n\n<!--\n    <servlet>\n        <servlet-name>cgi</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.CGIServlet</servlet-class>\n        <init-param>\n          <param-name>debug</param-name>\n          <param-value>0</param-value>\n        </init-param>\n        <init-param>\n          <param-name>cgiPathPrefix</param-name>\n          <param-value>WEB-INF/cgi</param-value>\n        </init-param>\n         <load-on-startup>5</load-on-startup>\n    </servlet>\n-->\n\n\n  <!-- ================ Built In Servlet Mappings ========================= -->\n\n\n  <!-- The servlet mappings for the built in servlets defined above.  Note  -->\n  <!-- that, by default, the CGI and SSI servlets are *not* mapped.  You    -->\n  <!-- must uncomment these mappings (or add them to your application\'s own -->\n  <!-- web.xml deployment descriptor) to enable these services              -->\n\n    <!-- The mapping for the default servlet -->\n    <servlet-mapping>\n        <servlet-name>default</servlet-name>\n        <url-pattern>/</url-pattern>\n    </servlet-mapping>\n\n    <!-- The mapping for the deprecated invoker servlet -->\n<!--\n    <servlet-mapping>\n        <servlet-name>invoker</servlet-name>\n        <url-pattern>/servlet/*</url-pattern>\n    </servlet-mapping>\n-->\n\n    <!-- The mapping for the JSP servlet -->\n    <servlet-mapping>\n        <servlet-name>jsp</servlet-name>\n        <url-pattern>*.jsp</url-pattern>\n    </servlet-mapping>\n\n    <servlet-mapping>\n        <servlet-name>jsp</servlet-name>\n        <url-pattern>*.jspx</url-pattern>\n    </servlet-mapping>\n\n    <!-- The mapping for the SSI servlet -->\n<!--\n    <servlet-mapping>\n        <servlet-name>ssi</servlet-name>\n        <url-pattern>*.shtml</url-pattern>\n    </servlet-mapping>\n-->\n\n    <!-- The mapping for the CGI Gateway servlet -->\n\n<!--\n    <servlet-mapping>\n        <servlet-name>cgi</servlet-name>\n        <url-pattern>/cgi-bin/*</url-pattern>\n    </servlet-mapping>\n-->\n\n\n  <!-- ================== Built In Filter Definitions ===================== -->\n\n  <!-- NOTE: An SSI Servlet is also available as an alternative SSI         -->\n  <!-- implementation. Use either the Servlet or the Filter but NOT both.   -->\n  <!--                                                                      -->\n  <!-- Server Side Includes processing filter, which processes SSI          -->\n  <!-- directives in HTML pages consistent with similar support in web      -->\n  <!-- servers like Apache.  Traditionally, this filter is mapped to the    -->\n  <!-- URL pattern "*.shtml", though it can be mapped to "*" as it will     -->\n  <!-- selectively enable/disable SSI processing based on mime types. For   -->\n  <!-- this to work you will need to uncomment the .shtml mime type         -->\n  <!-- definition towards the bottom of this file.                          -->\n  <!-- The contentType init param allows you to apply SSI processing to JSP -->\n  <!-- pages, javascript, or any other content you wish.  This filter       -->\n  <!-- supports the following initialization parameters (default values are -->\n  <!-- in square brackets):                                                 -->\n  <!--                                                                      -->\n  <!--   contentType         A regex pattern that must be matched before    -->\n  <!--                       SSI processing is applied.                     -->\n  <!--                       [text/x-server-parsed-html(;.*)?]              -->\n  <!--                                                                      -->\n  <!--   debug               Debugging detail level for messages logged     -->\n  <!--                       by this servlet.  [0]                          -->\n  <!--                                                                      -->\n  <!--   expires             The number of seconds before a page with SSI   -->\n  <!--                       directives will expire.  [No default]          -->\n  <!--                                                                      -->\n  <!--   isVirtualWebappRelative                                            -->\n  <!--                       Should "virtual" paths be interpreted as       -->\n  <!--                       relative to the context root, instead of       -->\n  <!--                       the server root?  (0=false, 1=true) [0]        -->\n\n<!--\n    <filter>\n        <filter-name>ssi</filter-name>\n        <filter-class>\n          org.apache.catalina.ssi.SSIFilter\n        </filter-class>\n        <init-param>\n          <param-name>contentType</param-name>\n          <param-value>text/x-server-parsed-html(;.*)?</param-value>\n        </init-param>\n        <init-param>\n          <param-name>debug</param-name>\n          <param-value>0</param-value>\n        </init-param>\n        <init-param>\n          <param-name>expires</param-name>\n          <param-value>666</param-value>\n        </init-param>\n        <init-param>\n          <param-name>isVirtualWebappRelative</param-name>\n          <param-value>0</param-value>\n        </init-param>\n    </filter>\n-->\n\n\n  <!-- ==================== Built In Filter Mappings ====================== -->\n\n  <!-- The mapping for the SSI Filter -->\n<!--\n    <filter-mapping>\n        <filter-name>ssi</filter-name>\n        <url-pattern>*.shtml</url-pattern>\n    </filter-mapping>\n-->\n\n\n  <!-- ==================== Default Session Configuration ================= -->\n  <!-- You can set the default session timeout (in minutes) for all newly   -->\n  <!-- created sessions by modifying the value below.                       -->\n\n    <session-config>\n        <session-timeout>30</session-timeout>\n    </session-config>\n\n\n  <!-- ===================== Default MIME Type Mappings =================== -->\n  <!-- When serving static resources, Tomcat will automatically generate    -->\n  <!-- a "Content-Type" header based on the resource\'s filename extension,  -->\n  <!-- based on these mappings.  Additional mappings can be added here (to  -->\n  <!-- apply to all web applications), or in your own application\'s web.xml -->\n  <!-- deployment descriptor.                                               -->\n\n    <mime-mapping>\n        <extension>abs</extension>\n        <mime-type>audio/x-mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ai</extension>\n        <mime-type>application/postscript</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>aif</extension>\n        <mime-type>audio/x-aiff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>aifc</extension>\n        <mime-type>audio/x-aiff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>aiff</extension>\n        <mime-type>audio/x-aiff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>aim</extension>\n        <mime-type>application/x-aim</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>art</extension>\n        <mime-type>image/x-jg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>asf</extension>\n        <mime-type>video/x-ms-asf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>asx</extension>\n        <mime-type>video/x-ms-asf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>au</extension>\n        <mime-type>audio/basic</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>avi</extension>\n        <mime-type>video/x-msvideo</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>avx</extension>\n        <mime-type>video/x-rad-screenplay</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>bcpio</extension>\n        <mime-type>application/x-bcpio</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>bin</extension>\n        <mime-type>application/octet-stream</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>bmp</extension>\n        <mime-type>image/bmp</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>body</extension>\n        <mime-type>text/html</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>cdf</extension>\n        <mime-type>application/x-cdf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>cer</extension>\n        <mime-type>application/x-x509-ca-cert</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>class</extension>\n        <mime-type>application/java</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>cpio</extension>\n        <mime-type>application/x-cpio</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>csh</extension>\n        <mime-type>application/x-csh</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>css</extension>\n        <mime-type>text/css</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>dib</extension>\n        <mime-type>image/bmp</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>doc</extension>\n        <mime-type>application/msword</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>dtd</extension>\n        <mime-type>application/xml-dtd</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>dv</extension>\n        <mime-type>video/x-dv</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>dvi</extension>\n        <mime-type>application/x-dvi</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>eps</extension>\n        <mime-type>application/postscript</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>etx</extension>\n        <mime-type>text/x-setext</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>exe</extension>\n        <mime-type>application/octet-stream</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>gif</extension>\n        <mime-type>image/gif</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>gtar</extension>\n        <mime-type>application/x-gtar</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>gz</extension>\n        <mime-type>application/x-gzip</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>hdf</extension>\n        <mime-type>application/x-hdf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>hqx</extension>\n        <mime-type>application/mac-binhex40</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>htc</extension>\n        <mime-type>text/x-component</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>htm</extension>\n        <mime-type>text/html</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>html</extension>\n        <mime-type>text/html</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>hqx</extension>\n        <mime-type>application/mac-binhex40</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ief</extension>\n        <mime-type>image/ief</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jad</extension>\n        <mime-type>text/vnd.sun.j2me.app-descriptor</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jar</extension>\n        <mime-type>application/java-archive</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>java</extension>\n        <mime-type>text/plain</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jnlp</extension>\n        <mime-type>application/x-java-jnlp-file</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jpe</extension>\n        <mime-type>image/jpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jpeg</extension>\n        <mime-type>image/jpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jpg</extension>\n        <mime-type>image/jpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>js</extension>\n        <mime-type>text/javascript</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jsf</extension>\n        <mime-type>text/plain</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>jspf</extension>\n        <mime-type>text/plain</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>kar</extension>\n        <mime-type>audio/x-midi</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>latex</extension>\n        <mime-type>application/x-latex</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>m3u</extension>\n        <mime-type>audio/x-mpegurl</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mac</extension>\n        <mime-type>image/x-macpaint</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>man</extension>\n        <mime-type>application/x-troff-man</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mathml</extension>\n        <mime-type>application/mathml+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>me</extension>\n        <mime-type>application/x-troff-me</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mid</extension>\n        <mime-type>audio/x-midi</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>midi</extension>\n        <mime-type>audio/x-midi</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mif</extension>\n        <mime-type>application/x-mif</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mov</extension>\n        <mime-type>video/quicktime</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>movie</extension>\n        <mime-type>video/x-sgi-movie</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mp1</extension>\n        <mime-type>audio/x-mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mp2</extension>\n        <mime-type>audio/x-mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mp3</extension>\n        <mime-type>audio/x-mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mp4</extension>\n        <mime-type>video/mp4</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mpa</extension>\n        <mime-type>audio/x-mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mpe</extension>\n        <mime-type>video/mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mpeg</extension>\n        <mime-type>video/mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mpega</extension>\n        <mime-type>audio/x-mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mpg</extension>\n        <mime-type>video/mpeg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>mpv2</extension>\n        <mime-type>video/mpeg2</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ms</extension>\n        <mime-type>application/x-wais-source</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>nc</extension>\n        <mime-type>application/x-netcdf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>oda</extension>\n        <mime-type>application/oda</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Database -->\n        <extension>odb</extension>\n        <mime-type>application/vnd.oasis.opendocument.database</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Chart -->\n        <extension>odc</extension>\n        <mime-type>application/vnd.oasis.opendocument.chart</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Formula -->\n        <extension>odf</extension>\n        <mime-type>application/vnd.oasis.opendocument.formula</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Drawing -->\n        <extension>odg</extension>\n        <mime-type>application/vnd.oasis.opendocument.graphics</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Image -->\n        <extension>odi</extension>\n        <mime-type>application/vnd.oasis.opendocument.image</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Master Document -->\n        <extension>odm</extension>\n        <mime-type>application/vnd.oasis.opendocument.text-master</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Presentation -->\n        <extension>odp</extension>\n        <mime-type>application/vnd.oasis.opendocument.presentation</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Spreadsheet -->\n        <extension>ods</extension>\n        <mime-type>application/vnd.oasis.opendocument.spreadsheet</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Text -->\n        <extension>odt</extension>\n        <mime-type>application/vnd.oasis.opendocument.text</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ogg</extension>\n        <mime-type>application/ogg</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Drawing Template -->\n        <extension>otg </extension>\n        <mime-type>application/vnd.oasis.opendocument.graphics-template</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- HTML Document Template -->\n        <extension>oth</extension>\n        <mime-type>application/vnd.oasis.opendocument.text-web</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Presentation Template -->\n        <extension>otp</extension>\n        <mime-type>application/vnd.oasis.opendocument.presentation-template</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Spreadsheet Template -->\n        <extension>ots</extension>\n        <mime-type>application/vnd.oasis.opendocument.spreadsheet-template </mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- OpenDocument Text Template -->\n        <extension>ott</extension>\n        <mime-type>application/vnd.oasis.opendocument.text-template</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pbm</extension>\n        <mime-type>image/x-portable-bitmap</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pct</extension>\n        <mime-type>image/pict</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pdf</extension>\n        <mime-type>application/pdf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pgm</extension>\n        <mime-type>image/x-portable-graymap</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pic</extension>\n        <mime-type>image/pict</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pict</extension>\n        <mime-type>image/pict</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pls</extension>\n        <mime-type>audio/x-scpls</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>png</extension>\n        <mime-type>image/png</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pnm</extension>\n        <mime-type>image/x-portable-anymap</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pnt</extension>\n        <mime-type>image/x-macpaint</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ppm</extension>\n        <mime-type>image/x-portable-pixmap</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ppt</extension>\n        <mime-type>application/vnd.ms-powerpoint</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>pps</extension>\n        <mime-type>application/vnd.ms-powerpoint</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ps</extension>\n        <mime-type>application/postscript</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>psd</extension>\n        <mime-type>image/x-photoshop</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>qt</extension>\n        <mime-type>video/quicktime</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>qti</extension>\n        <mime-type>image/x-quicktime</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>qtif</extension>\n        <mime-type>image/x-quicktime</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ras</extension>\n        <mime-type>image/x-cmu-raster</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>rdf</extension>\n        <mime-type>application/rdf+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>rgb</extension>\n        <mime-type>image/x-rgb</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>rm</extension>\n        <mime-type>application/vnd.rn-realmedia</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>roff</extension>\n        <mime-type>application/x-troff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>rtf</extension>\n        <mime-type>application/rtf</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>rtx</extension>\n        <mime-type>text/richtext</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>sh</extension>\n        <mime-type>application/x-sh</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>shar</extension>\n        <mime-type>application/x-shar</mime-type>\n    </mime-mapping>\n<!--\n    <mime-mapping>\n        <extension>shtml</extension>\n        <mime-type>text/x-server-parsed-html</mime-type>\n    </mime-mapping>\n-->\n    <mime-mapping>\n        <extension>smf</extension>\n        <mime-type>audio/x-midi</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>sit</extension>\n        <mime-type>application/x-stuffit</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>snd</extension>\n        <mime-type>audio/basic</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>src</extension>\n        <mime-type>application/x-wais-source</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>sv4cpio</extension>\n        <mime-type>application/x-sv4cpio</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>sv4crc</extension>\n        <mime-type>application/x-sv4crc</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>svg</extension>\n        <mime-type>image/svg+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>svgz</extension>\n        <mime-type>image/svg+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>swf</extension>\n        <mime-type>application/x-shockwave-flash</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>t</extension>\n        <mime-type>application/x-troff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tar</extension>\n        <mime-type>application/x-tar</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tcl</extension>\n        <mime-type>application/x-tcl</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tex</extension>\n        <mime-type>application/x-tex</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>texi</extension>\n        <mime-type>application/x-texinfo</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>texinfo</extension>\n        <mime-type>application/x-texinfo</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tif</extension>\n        <mime-type>image/tiff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tiff</extension>\n        <mime-type>image/tiff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tr</extension>\n        <mime-type>application/x-troff</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>tsv</extension>\n        <mime-type>text/tab-separated-values</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>txt</extension>\n        <mime-type>text/plain</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ulw</extension>\n        <mime-type>audio/basic</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>ustar</extension>\n        <mime-type>application/x-ustar</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>vxml</extension>\n        <mime-type>application/voicexml+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xbm</extension>\n        <mime-type>image/x-xbitmap</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xht</extension>\n        <mime-type>application/xhtml+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xhtml</extension>\n        <mime-type>application/xhtml+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xls</extension>\n        <mime-type>application/vnd.ms-excel</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xml</extension>\n        <mime-type>application/xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xpm</extension>\n        <mime-type>image/x-xpixmap</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xsl</extension>\n        <mime-type>application/xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xslt</extension>\n        <mime-type>application/xslt+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xul</extension>\n        <mime-type>application/vnd.mozilla.xul+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>xwd</extension>\n        <mime-type>image/x-xwindowdump</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>vsd</extension>\n        <mime-type>application/x-visio</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>wav</extension>\n        <mime-type>audio/x-wav</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- Wireless Bitmap -->\n        <extension>wbmp</extension>\n        <mime-type>image/vnd.wap.wbmp</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- WML Source -->\n        <extension>wml</extension>\n        <mime-type>text/vnd.wap.wml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- Compiled WML -->\n        <extension>wmlc</extension>\n        <mime-type>application/vnd.wap.wmlc</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- WML Script Source -->\n        <extension>wmls</extension>\n        <mime-type>text/vnd.wap.wmlscript</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <!-- Compiled WML Script -->\n        <extension>wmlscriptc</extension>\n        <mime-type>application/vnd.wap.wmlscriptc</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>wmv</extension>\n        <mime-type>video/x-ms-wmv</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>wrl</extension>\n        <mime-type>x-world/x-vrml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>wspolicy</extension>\n        <mime-type>application/wspolicy+xml</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>Z</extension>\n        <mime-type>application/x-compress</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>z</extension>\n        <mime-type>application/x-compress</mime-type>\n    </mime-mapping>\n    <mime-mapping>\n        <extension>zip</extension>\n        <mime-type>application/zip</mime-type>\n    </mime-mapping>\n\n  <!-- ==================== Default Welcome File List ===================== -->\n  <!-- When a request URI refers to a directory, the default servlet looks  -->\n  <!-- for a "welcome file" within that directory and, if present,          -->\n  <!-- to the corresponding resource URI for display.  If no welcome file   -->\n  <!-- is present, the default servlet either serves a directory listing,   -->\n  <!-- or returns a 404 status, depending on how it is configured.          -->\n  <!--                                                                      -->\n  <!-- If you define welcome files in your own application\'s web.xml        -->\n  <!-- deployment descriptor, that list *replaces* the list configured      -->\n  <!-- here, so be sure that you include any of the default values that     -->\n  <!-- you wish to include.                                                 -->\n\n    <welcome-file-list>\n        <welcome-file>index.html</welcome-file>\n        <welcome-file>index.htm</welcome-file>\n        <welcome-file>index.jsp</welcome-file>\n    </welcome-file-list>\n\n</web-app>\n').strip()
web_xml_content_missing_timeout = '\n<?xml version="1.0" encoding="ISO-8859-1"?>\n<web-app xmlns="http://java.sun.com/xml/ns/javaee"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"\n    version="2.5">\n\n    <servlet>\n        <servlet-name>default</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n        <init-param>\n            <param-name>debug</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <init-param>\n            <param-name>listings</param-name>\n            <param-value>false</param-value>\n        </init-param>\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n</web-app>\n'

def test_get_tmo():
    result = TomcatWebXml(context_wrap(web_xml_content))
    assert result.get('session-timeout') == 30


def test_get_tmo_missing_timeout():
    result = TomcatWebXml(context_wrap(web_xml_content_missing_timeout))
    assert result.get('session-timeout') is None
    return


server_xml_content = '\n<?xml version=\'1.0\' encoding=\'utf-8\'?>\n<Server port="8005" shutdown="SHUTDOWN">\n\n  <Listener className="org.apache.catalina.core.AprLifecycleListener" SSLEngine="on" />\n  <Listener className="org.apache.catalina.core.JasperListener" />\n  <Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />\n  <Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />\n<Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" />\n  <GlobalNamingResources>\n    <Resource name="UserDatabase" auth="Container"\n              type="org.apache.catalina.UserDatabase"\n              description="User database that can be updated and saved"\n              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"\n              pathname="conf/tomcat-users.xml" />\n  </GlobalNamingResources>\n\n  <!-- A "Service" is a collection of one or more "Connectors" that share\n       a single "Container" Note:  A "Service" is not itself a "Container",\n       so you may not define subcomponents such as "Valves" at this level.\n       Documentation at /docs/config/service.html\n   -->\n  <Service name="Catalina">\n    <Connector port="8080" protocol="HTTP/1.1"\n               connectionTimeout="20000"\n               redirectPort="8443" />\n\n    <Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"\n               maxThreads="150" scheme="https" secure="true"\n               clientAuth="want"\n               sslProtocols="TLSv1.2,TLSv1.1,TLSv1"\n               keystoreFile="conf/keystore"\n               truststoreFile="conf/keystore"\n               keystorePass="oXQ8LfAGsf97KQxwwPta2X3vnUv7P5QM"\n               keystoreType="PKCS12"\n               ciphers="SSL_RSA_WITH_3DES_EDE_CBC_SHA,\n                    TLS_RSA_WITH_AES_256_CBC_SHA,\n                    TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,\n                    TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,\n                    TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA,\n                    TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,\n                    TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,\n                    TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA"\n               truststorePass="oXQ8LfAGsf97KQxwwPta2X3vnUv7P5QM" />\n\n    <!-- Define an AJP 1.3 Connector on port 8009 -->\n    <Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />\n\n\n    <Engine name="Catalina" defaultHost="localhost">\n\n      <Realm className="org.apache.catalina.realm.UserDatabaseRealm"\n             resourceName="UserDatabase"/>\n\n      <Host name="localhost"  appBase="webapps"\n            unpackWARs="true" autoDeploy="true"\n            xmlValidation="false" xmlNamespaceAware="false">\n\n      </Host>\n    </Engine>\n  </Service>\n</Server>\n'

def test_tomcat_server_xml():
    result = TomcatServerXml(context_wrap(server_xml_content))
    engines = result.get_elements('.//Service/Engine')
    assert len(engines) == 1
    assert engines[0].get('name') == 'Catalina'


def test_web_xml_doc_examples():
    env = {'TomcatWebXml': TomcatWebXml, 
       'web_xml': TomcatWebXml(context_wrap(web_xml_content, path='/usr/share/tomcat/web.xml')), 
       'TomcatServerXml': TomcatServerXml, 
       'server_xml': TomcatServerXml(context_wrap(server_xml_content, path='/usr/share/tomcat/server.xml'))}
    failed, total = doctest.testmod(tomcat_xml, globs=env)
    assert failed == 0