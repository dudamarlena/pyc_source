# uncompyle6 version 3.6.7
# Python bytecode 3.7 (3394)
# Decompiled from: Python 3.8.2 (tags/v3.8.2:7b3ab59, Feb 25 2020, 23:03:10) [MSC v.1916 64 bit (AMD64)]
# Embedded file name: build/bdist.linux-x86_64/egg/camsaxs/fit_sasmodel.py
# Compiled at: 2018-11-19 17:42:50
# Size of source mod 2**32: 1420 bytes
import numpy as np
from astropy.modeling import Fittable1DModel, fitting
from collections import OrderedDict

def fit_sasmodel(model, q, data, method='LevMarLSQFitter', **kwargs):
    """
    Fit an XicamSASModle using astropy.ftting routines.

    Parameters
    ----------
    model : XicamSASModel
        Model generated by the factroy method
    q     : np.ndarray
        q-range for the fitting
    data  : np.ndarray
        SAXS spectra over input q-range
    method: str
        one of [LinearLSQFitter, LevMarLSQFitter, SLSQPLSQFitter]
    kwargs: dict
        astropy fitting related key: arguments

    Returns
    -------
        Fitted parameters, values
    """
    fitters = OrderedDict({'LinearLSQFitter':fitting.LinearLSQFitter, 
     'LevMarLSQFitter':fitting.LevMarLSQFitter, 
     'SLSQPLSQFitter':fitting.SLSQPLSQFitter})
    if not isinstance(model, Fittable1DModel):
        raise TypeError('Input model must be astropy Fittable1DModel or subtype')
    if not np.shape(q) == np.shape(data):
        raise ValueError('q and I must be of same shape')
    if method not in fitters:
        raise ValueError('Unsupported fitting methods')
    fit_t = fitters[method]()
    g = fit_t(model, q, data, **kwargs)
    return (
     g.parameters, g(q))