# uncompyle6 version 3.7.4
# Python bytecode 2.7 (62211)
# Decompiled from: Python 3.6.9 (default, Apr 18 2020, 01:56:04) 
# [GCC 8.4.0]
# Embedded file name: /Users/peterhudec/workspace/foundation-sphinx-theme/foundation_sphinx_theme/__init__.py
# Compiled at: 2015-07-12 07:49:20
import os, re
from sphinx.util.compat import Directive
HTML_THEME_PATH = [
 os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))]
seo_descriptions = {}

class SeoDescription(Directive):
    """
    This directive merely saves it's contents to the seo_descriptions dict
    under the document name key.
    """
    has_content = True

    def run(self):
        seo_descriptions[self.state.document.settings.env.docname] = (' ').join(self.content)
        return []


def tt2nav(toctree, klass=None, appendix=None, divider=False):
    """
    Injects ``has-dropdown`` and ``dropdown`` classes to HTML
    generated by the :func:`toctree` function.
    
    :param str toctree:
        HTML generated by the :func:`toctree` function.
    """
    tt = toctree
    divider = '<li class="divider"></li>' if divider else ''
    if appendix:
        tt = re.sub('(</ul>$)', ('{}\\1').format(appendix), tt)
    tt = re.sub('<ul>', '<ul class="">', tt)
    if klass:
        tt = re.sub('(^<ul[\\s\\w-]+class=")', ('\\1{} ').format(klass), tt)
    pattern = '(<li[\\s\\w-]+class=")([^>]*>[^<]*<a[^>]*>[^<]*</a>[^<]*<ul[\\s\\w]+class=")'
    replace = ('{}\\1has-dropdown \\2dropdown ').format(divider)
    return re.sub(pattern, replace, tt)


def hpc(app, pagename, templatename, context, doctree):
    context['tt2nav'] = tt2nav
    context['seo_description'] = seo_descriptions.get(pagename, '')


def setup(app):
    app.add_directive('seo-description', SeoDescription)
    app.connect('html-page-context', hpc)