# uncompyle6 version 3.7.4
# Python bytecode 3.7 (3394)
# Decompiled from: Python 3.6.9 (default, Apr 18 2020, 01:56:04) 
# [GCC 8.4.0]
# Embedded file name: /Users/bogdankyryliuk/src/oss/incubator-superset/superset/examples/tabbed_dashboard.py
# Compiled at: 2020-01-16 19:49:16
# Size of source mod 2**32: 8228 bytes
"""Loads datasets, dashboards and slices in a new superset instance"""
import json, textwrap
from superset import db
from superset.models.dashboard import Dashboard
from superset.models.slice import Slice
from .helpers import update_slice_ids

def load_tabbed_dashboard(_=False):
    """Creating a tabbed dashboard"""
    print('Creating a dashboard with nested tabs')
    slug = 'tabbed_dash'
    dash = db.session.query(Dashboard).filter_by(slug=slug).first()
    if not dash:
        dash = Dashboard()
    tabbed_dash_slices = set()
    tabbed_dash_slices.add('Region Filter')
    tabbed_dash_slices.add('Growth Rate')
    tabbed_dash_slices.add('Treemap')
    tabbed_dash_slices.add('Box plot')
    js = textwrap.dedent('    {\n      "CHART-c0EjR-OZ0n": {\n        "children": [],\n        "id": "CHART-c0EjR-OZ0n",\n        "meta": {\n          "chartId": 870,\n          "height": 50,\n          "sliceName": "Box plot",\n          "width": 4\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "ROW-7G2o5uDvfo"\n        ],\n        "type": "CHART"\n      },\n      "CHART-dxV7Il74hH": {\n        "children": [],\n        "id": "CHART-dxV7Il74hH",\n        "meta": {\n          "chartId": 797,\n          "height": 50,\n          "sliceName": "Treemap",\n          "width": 4\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-gcQJxApOZS",\n          "TABS-afnrUvdxYF",\n          "TAB-jNNd4WWar1",\n          "ROW-7ygtDczaQ"\n        ],\n        "type": "CHART"\n      },\n      "CHART-jJ5Yj1Ptaz": {\n        "children": [],\n        "id": "CHART-jJ5Yj1Ptaz",\n        "meta": {\n          "chartId": 789,\n          "height": 50,\n          "sliceName": "World\'s Population",\n          "width": 4\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "TABS-CSjo6VfNrj",\n          "TAB-z81Q87PD7",\n          "ROW-G73z9PIHn"\n        ],\n        "type": "CHART"\n      },\n      "CHART-z4gmEuCqQ5": {\n        "children": [],\n        "id": "CHART-z4gmEuCqQ5",\n        "meta": {\n          "chartId": 788,\n          "height": 50,\n          "sliceName": "Region Filter",\n          "width": 4\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "TABS-CSjo6VfNrj",\n          "TAB-EcNm_wh922",\n          "ROW-LCjsdSetJ"\n        ],\n        "type": "CHART"\n      },\n      "DASHBOARD_VERSION_KEY": "v2",\n      "GRID_ID": {\n        "children": [],\n        "id": "GRID_ID",\n        "type": "GRID"\n      },\n      "HEADER_ID": {\n        "id": "HEADER_ID",\n        "meta": {\n          "text": "Tabbed Dashboard"\n        },\n        "type": "HEADER"\n      },\n      "ROOT_ID": {\n        "children": [\n          "TABS-lV0r00f4H1"\n        ],\n        "id": "ROOT_ID",\n        "type": "ROOT"\n      },\n      "ROW-7G2o5uDvfo": {\n        "children": [\n          "CHART-c0EjR-OZ0n"\n        ],\n        "id": "ROW-7G2o5uDvfo",\n        "meta": {\n          "background": "BACKGROUND_TRANSPARENT"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS"\n        ],\n        "type": "ROW"\n      },\n      "ROW-7ygtDczaQ": {\n        "children": [\n          "CHART-dxV7Il74hH"\n        ],\n        "id": "ROW-7ygtDczaQ",\n        "meta": {\n          "background": "BACKGROUND_TRANSPARENT"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-gcQJxApOZS",\n          "TABS-afnrUvdxYF",\n          "TAB-jNNd4WWar1"\n        ],\n        "type": "ROW"\n      },\n      "ROW-G73z9PIHn": {\n        "children": [\n          "CHART-jJ5Yj1Ptaz"\n        ],\n        "id": "ROW-G73z9PIHn",\n        "meta": {\n          "background": "BACKGROUND_TRANSPARENT"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "TABS-CSjo6VfNrj",\n          "TAB-z81Q87PD7"\n        ],\n        "type": "ROW"\n      },\n      "ROW-LCjsdSetJ": {\n        "children": [\n          "CHART-z4gmEuCqQ5"\n        ],\n        "id": "ROW-LCjsdSetJ",\n        "meta": {\n          "background": "BACKGROUND_TRANSPARENT"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "TABS-CSjo6VfNrj",\n          "TAB-EcNm_wh922"\n        ],\n        "type": "ROW"\n      },\n      "TAB-EcNm_wh922": {\n        "children": [\n          "ROW-LCjsdSetJ"\n        ],\n        "id": "TAB-EcNm_wh922",\n        "meta": {\n          "text": "row tab 1"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "TABS-CSjo6VfNrj"\n        ],\n        "type": "TAB"\n      },\n      "TAB-NF3dlrWGS": {\n        "children": [\n          "ROW-7G2o5uDvfo",\n          "TABS-CSjo6VfNrj"\n        ],\n        "id": "TAB-NF3dlrWGS",\n        "meta": {\n          "text": "Tab A"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1"\n        ],\n        "type": "TAB"\n      },\n      "TAB-gcQJxApOZS": {\n        "children": [\n          "TABS-afnrUvdxYF"\n        ],\n        "id": "TAB-gcQJxApOZS",\n        "meta": {\n          "text": "Tab B"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1"\n        ],\n        "type": "TAB"\n      },\n      "TAB-jNNd4WWar1": {\n        "children": [\n          "ROW-7ygtDczaQ"\n        ],\n        "id": "TAB-jNNd4WWar1",\n        "meta": {\n          "text": "New Tab"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-gcQJxApOZS",\n          "TABS-afnrUvdxYF"\n        ],\n        "type": "TAB"\n      },\n      "TAB-z81Q87PD7": {\n        "children": [\n          "ROW-G73z9PIHn"\n        ],\n        "id": "TAB-z81Q87PD7",\n        "meta": {\n          "text": "row tab 2"\n        },\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS",\n          "TABS-CSjo6VfNrj"\n        ],\n        "type": "TAB"\n      },\n      "TABS-CSjo6VfNrj": {\n        "children": [\n          "TAB-EcNm_wh922",\n          "TAB-z81Q87PD7"\n        ],\n        "id": "TABS-CSjo6VfNrj",\n        "meta": {},\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-NF3dlrWGS"\n        ],\n        "type": "TABS"\n      },\n      "TABS-afnrUvdxYF": {\n        "children": [\n          "TAB-jNNd4WWar1"\n        ],\n        "id": "TABS-afnrUvdxYF",\n        "meta": {},\n        "parents": [\n          "ROOT_ID",\n          "TABS-lV0r00f4H1",\n          "TAB-gcQJxApOZS"\n        ],\n        "type": "TABS"\n      },\n      "TABS-lV0r00f4H1": {\n        "children": [\n          "TAB-NF3dlrWGS",\n          "TAB-gcQJxApOZS"\n        ],\n        "id": "TABS-lV0r00f4H1",\n        "meta": {},\n        "parents": [\n          "ROOT_ID"\n        ],\n        "type": "TABS"\n      }\n    }\n        ')
    pos = json.loads(js)
    slices = [db.session.query(Slice).filter_by(slice_name=name).first() for name in tabbed_dash_slices]
    slices = sorted(slices, key=(lambda x: x.id))
    update_slice_ids(pos, slices)
    dash.position_json = json.dumps(pos, indent=4)
    dash.slices = slices
    dash.dashboard_title = 'Tabbed Dashboard'
    dash.slug = slug
    db.session.merge(dash)
    db.session.commit()