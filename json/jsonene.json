{"info": {"author": "Nikhil Rupanawar", "author_email": "conikhil@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# jsonene\nThis library is intended to provide APIs to define JSON schema, create instances from schema, serialize/de-serialize to/from json or dict to Objects. \n\n**Inspired by**\n\n[jsonschema](https://python-jsonschema.readthedocs.io/en/stable/)\n\n[json-schema](https://json-schema.org/draft-07/json-schema-validation.html)\n\nThe basic idea is to provide light weight class based schema defination and data classes\n\n**Installation**\n\npip install jsonene\n\n**Demos**:\n\n\n```python\nimport datetime\nimport json\nfrom jsonene.fields import (\n    Boolean,\n    List,\n    GenericList,\n    Null,\n    Const,\n    Enum,\n    Number,\n    Integer,\n    Schema,\n    GenericSchema,\n    String,\n    Format,\n)\nfrom jsonene.operators import AllOf, AnyOf, OneOf, Not\nfrom jsonene.constraints import RequiredDependency\nfrom jsonene.exceptions import ValidationError\n```\n\n**Define a Schema**\n```python\nclass Person(Schema):\n    name = String(min_len=3)\n    gender = Enum([\"MALE\", \"FEMALE\", \"OTHER\"])\n    emails = List(Format(Format.EMAIL), unique_items=True)\n    contact = String(required=False)\n    age = Integer(required=False)\n    date_of_birth = Format(Format.DATE, name=\"date-of-birth\")  # non python names\n\n    class Meta:\n        # Must provide contact if emails is provided\n        field_dependencies = [RequiredDependency(\"emails\", [\"contact\"])]\n\n\n# Schema Inheritance\nclass Owner(Person):\n    pass\n\n\nclass Broker(Person):\n    brokerage = Integer()  # additional properity\n    is_broker = Const(True)\n\n    class Meta(Person.Meta):\n        field_dependencies = [\n            RequiredDependency(\"emails\", [\"contact\"]),\n            RequiredDependency(\"contact\", [\"emails\"]),\n        ]\n\n\n# Nested schemas\nclass House(Schema):\n    seller = AnyOf(Owner, Broker)  # accepts any of owner or broken\n    address = List(Number, String, String)  # accept list in specific type order.\n    is_ready = Boolean()\n    area = Number()\n    country = Const(\"India\")\n    garden_area = Number(required=False, use_default=0)\n    sqtft_rate = Number(required=False, use_default=0)\n    secrete_key = Number(required=False, name=\"__secrete_key\")  # Private\n    possesion_date = Format(Format.DATE)\n    # Extend instance class and add properties\n    class Instance(Schema.Instance):\n        @property\n        def cost(self):\n            # Safety: fields with required=False should be checked before access.\n            # Optionaly you can provide default value.\n            return self.sqtft_rate * self.area\n\n    # Provide custom meta\n    class Meta:\n        # Must provide area and sqtft_rate if sqtft_rate provided\n        # OR v.v.\n        field_dependencies = [\n            RequiredDependency(\"area\", [\"sqtft_rate\"]),\n            RequiredDependency(\"sqtft_rate\", [\"area\"]),\n        ]\n```\n\n\n**Create and validate instances**\n\n```python\ngeneric = GenericSchema.instance(anything=\"you want\", almost_anything=[1, 2, \"3\"])\nassert len(generic.errors) == 0 # Generic schema never raises errors\nassert generic.anything == \"you want\"\nassert generic.almost_anything == [1, 2, \"3\"]\n\n\n# Create a instances of schema\nowner = Owner.instance(\n    name=\"Test owner\",\n    gender=\"MALE\",\n    emails=[\"test@test.com\"],\n    date_of_birth=\"1989-01-01\",\n)\n\nassert owner.errors == [\"'contact' is a dependency of 'emails'\"]\nassert owner[\"date-of-birth\"] == \"1989-01-01\"\n\ntest = Broker.instance(\n    name=\"Test\",\n    gender=\"MALE\",\n    emails=[\"testtest.com\", \"testtest.com\"], # invalid emails, duplicate emails\n    contact=\"123456\",\n    brokerage=12345,\n    is_broker=True,\n    date_of_birth=\"1989-01-01\",\n)\nassert test.errors == [\n    \"'testtest.com' is not a 'email'\",\n    \"'testtest.com' is not a 'email'\",\n    \"['testtest.com', 'testtest.com'] has non-unique elements\",\n]\n\n# Owner instance\nowner = Owner.instance(\n    name=\"Nikhil Rupanawar\",\n    gender=\"MALE\",\n    emails=[\"conikhil@gmail.com\"],\n    contact=\"4545454545\",\n    date_of_birth=\"1989-09-11\",\n)\n\n# House with owner\nhouse = House.instance()\nhouse.seller = owner\nhouse.address = [123, \"A building\", \"Singad road\"]\nhouse.is_ready = True\nhouse.country = \"India\"\nhouse.area = 7000\nhouse.possesion_date = datetime.datetime.now()\nassert house.cost == 0 # sqtft_rate is 0 as default\nassert len(house.errors) == 0\n\n# House with broker\nanother_house = House.instance(\n    seller=Broker.instance(\n        name=\"Test Rupanwar\",\n        gender=\"MALE\",\n        emails=[\"test@test.com\"],\n        contact=\"123456\",\n        brokerage=12345,\n        is_broker=True,\n        date_of_birth=\"2002-09-08\",\n    ),\n    address=[123, \"A building\", \"Baner road\"],\n    sqtft_rate=5000,\n    area=1100,\n    is_ready=True,\n    country=\"India\",\n    secrete_key=12345,\n    possesion_date=datetime.datetime.now()\n)\nanother_house.validate()\nassert another_house.cost == 5500000\n```\n\n**List basics**\n\n```python\n# Generic list\n>>> l = List.instance([1, 23, 56, \"anything\"])\n>>> l.append(\"wow\")\n>>> l[1:6]  # slice\n>>> l.append(23)\n>>> l.extend([45])\n>>> l[2] = 100\n>>> l.validate()  # No errors!\n```\n\n**List of types**\n```python\nl = List(String).instance([\"only\", \"strings\", \"are\", \"allowed\"])\nassert len(l.errors) == 0  # No errors!\n\nl = List(String).instance([\"only\", \"strings\", 60, 30])\nassert [e.message for e in l.exceptions] == [\n    \"60 is not of type 'string'\",\n    \"30 is not of type 'string'\",\n]\n\n# list of house\nhouses = List(House).instance([house, another_house])\nhouses.validate()\nhouses.to_json()\n```\n\n**Validate any document/dict against the schema**\n\n```python\nHouse().validate(\n    {\n        \"seller\": {\n            \"age\": 22,\n            \"emails\": [\"test@test.com\", \"test2@test.com\"],\n            \"name\": \"nikhil\",\n            \"gender\": \"MALE\",\n            \"contact\": \"1234567\",\n            \"date-of-birth\": \"1978-09-04\",\n        },\n        \"address\": [120, \"Flat A\", \"Sarang\"],\n        \"area\": 1234,\n        \"sqtft_rate\": 2000,\n        \"garden_area\": 123,\n        \"is_ready\": True,\n        \"country\": \"India\",\n        \"possesion_date\": str(datetime.datetime.now()),\n    }\n)\n\n```\n\n\n**Enums and Consts**\n\n```python\n\nConst(2).instance(2).validate()  # won't raise error\n\ntry:\n    Const(2).instance(3).validate()  # raises error\nexcept ValidationError:\n    assert True\n\nassert Enum([1, 2, 3]).instance(3).errors == []  # no error\n\n# Raises error\ntry:\n    Enum([1, 2, \"Three\"])(5).validate()\nexcept ValidationError:\n    assert True\n```\n\n**Construct instance from document/schema**\n```python\nHOUSE_DATA_VALID = json.dumps(\n    {\n        \"seller\": {\n            \"age\": 22,\n            \"emails\": [\"test@test.com\", \"test2@test.com\"],\n            \"name\": \"nikhil\",\n            \"gender\": \"MALE\",\n            \"contact\": \"1234567\",\n            \"date-of-birth\": \"1978-09-04\",\n        },\n        \"address\": [120, \"Flat A\", \"Sarang\"],\n        \"area\": 1234,\n        \"sqtft_rate\": 2000,\n        \"garden_area\": 123,\n        \"is_ready\": True,\n        \"country\": \"India\",\n        \"possesion_date\": \"2020-02-05\",  # str(datetime.datetime.now()),\n    }\n)\n\nh = House.from_json(HOUSE_DATA_VALID)\nh.validate(check_formats=True)\n```\n\n\n**Factory-boy integration**\n```python \nfrom demos import Person, Owner, House, Broker, Gender, List, Schema\nfrom jsonene.factories import SchemaFactory, ListSchemaFactory\nfrom factory import SubFactory, fuzzy, Sequence, Iterator, LazyAttribute\nimport string\nimport datetime\nimport pytz\n\nst_date = pytz.utc.localize(datetime.datetime.now())\nend_date = st_date + datetime.timedelta(days=7)\n\n\nclass EmailsFactory(ListSchemaFactory):\n    email = LazyAttribute(lambda o: f\"{o.factory_parent.name}@example.org\")\n\n    class Meta:\n        model = List\n\n\nclass PersonFactory(SchemaFactory):\n    name = fuzzy.FuzzyText()\n    gender = fuzzy.FuzzyChoice([e.value for e in Gender])\n    emails = SubFactory(EmailsFactory)\n    contact = fuzzy.FuzzyText(chars=[str(n) for n in range(10)])\n    age = fuzzy.FuzzyInteger(low=0, high=100)\n    date_of_birth = fuzzy.FuzzyDateTime(st_date, end_dt=end_date)\n\n    class Meta:\n        model = Person\n\n\nclass OwnerFactory(PersonFactory):\n    class Meta:\n        model = Owner\n\n\nclass AddressFactory(ListSchemaFactory):\n    house_no = fuzzy.FuzzyInteger(low=1, high=100)\n    street_address = fuzzy.FuzzyText(suffix=\" road\")\n    area = fuzzy.FuzzyText()\n\n    class Meta:\n        model = List\n\n\nclass HouseFactory(SchemaFactory):\n    seller = SubFactory(OwnerFactory)\n    address = SubFactory(AddressFactory)\n    is_ready = fuzzy.FuzzyChoice([True, False])\n    area = fuzzy.FuzzyFloat(low=400, high=3000, precision=2)\n    country = \"India\"\n    garden_area = fuzzy.FuzzyFloat(low=400, high=3000, precision=2)\n    sqtft_rate = fuzzy.FuzzyFloat(low=0, high=50000, precision=2)\n    possesion_date = fuzzy.FuzzyDateTime(st_date, end_dt=end_date)\n\n    class Meta:\n        model = House\n\n\nhouse = HouseFactory.create()\nhouse.validate(check_formats=True)\nassert isinstance(house.seller, Schema.Instance)\n\nhouse2 = HouseFactory.create()\ndel house2.seller\nassert house2.errors == [\"'seller' is a required property\"]\n```", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/nikhil-rupanawar/jsonene", "keywords": "json,validation,schema", "license": "MIT", "maintainer": "", "maintainer_email": "", "name": "jsonene", "package_url": "https://pypi.org/project/jsonene/", "platform": "", "project_url": "https://pypi.org/project/jsonene/", "project_urls": {"Homepage": "https://github.com/nikhil-rupanawar/jsonene"}, "release_url": "https://pypi.org/project/jsonene/0.0.13/", "requires_dist": null, "requires_python": ">=3.6", "summary": "Type declaration and validation library for JSON", "version": "0.0.13"}, "last_serial": 6584384, "releases": {"0.0.10": [{"comment_text": "", "digests": {"md5": "74a92950e01675abf7a0c83ed811d549", "sha256": "1f070eef0108cb969286a8d40f9a257cdcb9877dc685413074c5c9191d9f4e49"}, "downloads": -1, "filename": "jsonene-0.0.10.tar.gz", "has_sig": false, "md5_digest": "74a92950e01675abf7a0c83ed811d549", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 10830, "upload_time": "2020-02-05T15:42:00", "upload_time_iso_8601": "2020-02-05T15:42:00.069234Z", "url": "https://files.pythonhosted.org/packages/2f/14/f5cb30d7e04b1357bd965b1bc6493e0ce8a6084f95b1c011dbe06e4cf4ae/jsonene-0.0.10.tar.gz"}], "0.0.11": [{"comment_text": "", "digests": {"md5": "348d71495e7349fa377d43a20a063413", "sha256": "c3f851ecce17c97b3840c1ae9b77b37e6283370b40242630db11f5036f745180"}, "downloads": -1, "filename": "jsonene-0.0.11.tar.gz", "has_sig": false, "md5_digest": "348d71495e7349fa377d43a20a063413", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 11725, "upload_time": "2020-02-06T17:22:49", "upload_time_iso_8601": "2020-02-06T17:22:49.621848Z", "url": "https://files.pythonhosted.org/packages/10/8a/682f98e072352341c6b20b8cc771a65f8cbb977f7cccbf80d89016ba41aa/jsonene-0.0.11.tar.gz"}], "0.0.12": [{"comment_text": "", "digests": {"md5": "50c3f8d38a43eedf57223c343c7c3d04", "sha256": "c47ceec4ea98df0e29c0b354f114f8f8097f9cd067165236e7bd0fdf930fb530"}, "downloads": -1, "filename": "jsonene-0.0.12.tar.gz", "has_sig": false, "md5_digest": "50c3f8d38a43eedf57223c343c7c3d04", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 12932, "upload_time": "2020-02-06T17:29:01", "upload_time_iso_8601": "2020-02-06T17:29:01.475614Z", "url": "https://files.pythonhosted.org/packages/d7/f6/3061071f908e803b2a4e68627b01ddf1c9c21749d1455c704d448f1be9e1/jsonene-0.0.12.tar.gz"}], "0.0.13": [{"comment_text": "", "digests": {"md5": "a77137e07e9225d01df77d6b9e23f86e", "sha256": "14ae4dcdad56839c1c2280b092b893054ee7ac3df40beb60816ed4531824966d"}, "downloads": -1, "filename": "jsonene-0.0.13.tar.gz", "has_sig": false, "md5_digest": "a77137e07e9225d01df77d6b9e23f86e", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 12953, "upload_time": "2020-02-06T21:12:56", "upload_time_iso_8601": "2020-02-06T21:12:56.567103Z", "url": "https://files.pythonhosted.org/packages/78/3a/6ce4c040a0e3209b43ba9ab76173ee2044ea696b4ba205e2276be82e2537/jsonene-0.0.13.tar.gz"}]}, "urls": [{"comment_text": "", "digests": {"md5": "a77137e07e9225d01df77d6b9e23f86e", "sha256": "14ae4dcdad56839c1c2280b092b893054ee7ac3df40beb60816ed4531824966d"}, "downloads": -1, "filename": "jsonene-0.0.13.tar.gz", "has_sig": false, "md5_digest": "a77137e07e9225d01df77d6b9e23f86e", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 12953, "upload_time": "2020-02-06T21:12:56", "upload_time_iso_8601": "2020-02-06T21:12:56.567103Z", "url": "https://files.pythonhosted.org/packages/78/3a/6ce4c040a0e3209b43ba9ab76173ee2044ea696b4ba205e2276be82e2537/jsonene-0.0.13.tar.gz"}]}