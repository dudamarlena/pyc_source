{"info": {"author": "Kevin Arvai <karvai@genedx.com>, Kyle Retterer <retterer@genedx.com>, Carlos Borroto <cborroto@genedx.com>, Vlad Gainullin <vgainullin@genedx.com>, Vincent Ustach <vustach@genedx.com>", "author_email": "<datascience@genedx.com>", "bugtrack_url": null, "classifiers": [], "description": "[![python-version](https://img.shields.io/badge/python-3.6+-blue.svg)](https://www.python.org/downloads/release/python-360/)\n[![github-actions](https://github.com/GeneDx/phenopy/workflows/Python%20package/badge.svg)](https://github.com/GeneDx/phenopy/actions)\n[![codecov](https://codecov.io/gh/GeneDx/phenopy/branch/develop/graph/badge.svg)](https://codecov.io/gh/GeneDx/phenopy)\n[![DOI](https://zenodo.org/badge/207335538.svg)](https://zenodo.org/badge/latestdoi/207335538)\n\n# phenopy\n`phenopy` is a Python package to perform phenotype similarity scoring by semantic similarity. `phenopy` is a\nlightweight but highly optimized command line tool and library to efficiently perform semantic similarity scoring on\ngeneric entities with phenotype annotations from the [Human Phenotype Ontology (HPO)](https://hpo.jax.org/app/).\n\n![Phenotype Similarity Clustering](https://raw.githubusercontent.com/GeneDx/phenopy/develop/notebooks/output/cluster_three_diseases.png)\n\n## Installation\nInstall using pip:\n```bash\npip install phenopy\n```\n\nInstall from GitHub:\n```bash\ngit clone https://github.com/GeneDx/phenopy.git\ncd phenopy\npython setup.py install\n```\n\n## Command Line Usage\n### Initial setup\nphenopy is designed to run with minimal setup from the user, to run phenopy with default parameters (recommended), skip ahead\nto the [Commands overview](#Commands-overview).  \n\nThis section provides details about where phenopy stores data resources and config files. The following occurs when\nyou run phenopy for the first time.\n 1. phenopy creates a `.phenopy/` directory in your home folder and downloads external resources from HPO into the\n  `$HOME/.phenopy/data/` directory.\n 2. phenopy creates a `$HOME/.phenopy/phenopy.ini` config file where users can set variables for phenopy to use\n at runtime.\n\n### Commands overview\n`phenopy` is primarily used as a command line tool. An entity, as described here, is presented as a sample, gene, or\ndisease, but could be any concept that warrants annotation of phenotype terms. \n\nUse `phenopy score` to perform semantic similarity scoring in various formats. Write the results of any command to file \nusing `--output-file=/path/to/output_file.txt`\n\n1. Score similarity of entities defined by the HPO terms from an input file against all the OMIM diseases in\n    `.phenopy/data/phenotype.hpoa`. We provide a test input file in the repo. The default summarization method is to\n     use `--summarization-method=BMWA` which weighs each diseases' phenotypes by the frequency of a phenotype seen in \n     each particular disease.\n    ```bash\n    phenopy score tests/data/test.score.txt  \n    ```\n    Output:\n    ```\n    #query\tentity_id\tscore\n    118200  210100  0.0\n    118200  615779  0.0\n    118200  613266  0.0052\n    ...\n    ```\n\n2. Score similarity of entities defined by the HPO terms from an input file against all the OMIM diseases in\n    `.phenopy/data/phenotype.hpoa`, to use the non-weighted summarization method use `--summarization-method=BMA` which\n    uses a traditional *best-match average* summarization of semantic similarity scores when comparing terms from record *a* \n    with terms from record *b*.\n    ```bash\n    phenopy score tests/data/test.score.txt --summarization-method=BMWA\n    ```\n    Output:\n    ```\n    #query\tentity_id\tscore\n    118200  210100  0.0\n    118200  615779  0.0\n    118200  613266  0.0052\n    ...\n    ```\n\n3. Score similarity of an entities defined by the HPO terms from an input file against a custom list of entities with HPO annotations, referred to as the `--records-file`. Both files are in the same format.\n    ```bash\n    phenopy score tests/data/test.score-short.txt --records-file tests/data/test.score-long.txt\n    ```\n    Output:\n    ```\n    #query  entity_id       score\n    118200  118200  0.0169\n    118200  300905  0.0156\n    118200  601098  0.0171\n    ...\n    ```\n\n4. Score pairwise similarity of entities defined by the HPO terms from an input file using `--self`.\n\n    ```bash\n    phenopy score tests/data/test.score-long.txt --threads 4 --self\n    ```\n    Output:\n    ```\n    #query  entity_id       score\n    118200  118200  0.2284\n    118200  118210  0.1302\n    118200  118211  0.1302\n    118210  118210  0.2048\n    118210  118211  0.2048\n    118211  118211  0.2048\n    ```\n5. Score age-adjusted pairwise similarity of entities defined in the input file, \n    using phenotype mean age and standard deviation defined in the `--ages_distribution_file`,\n    select best-match weighted average as the scoring summarization method `--summarization-method BMWA`.\n\n    ```bash\n    phenopy score tests/data/test.score-short.txt --ages_distribution_file tests/data/phenotype_age.tsv --summarization-method BMWA --threads 4 --self\n    ```\n    Output:\n    ```\n    #query  entity_id       score\n    118200  210100  0.0\n    118200  177650  0.0127\n    118200  241520  0.0\n    ...\n    ```\n\n    The phenotype age file contains hpo-id, mean, sd as tab separated text as follows\n\n    |  |  | |\n    |------------|------|-----|\n    | HP:0001251 | 6.0  | 3.0 |\n    | HP:0001263 | 1.0  | 1.0 |\n    | HP:0001290 | 1.0  | 1.0 |\n    | HP:0004322 | 10.0 | 3.0 |\n    | HP:0001249 | 6.0  | 3.0 |\n\n  If no phenotype ages file is provided `--summarization-method=BMWA` can be selected to use default, open access literature-derived phenotype ages (~ 1,400 age weighted phenotypes).  \n   ```bash\n    phenopy score tests/data/test.score-short.txt  --summarization-method BMWA --threads 4\n   ```\n\n\n## Parameters\nFor a full list of command arguments use `phenopy [subcommand] --help`:\n```bash\nphenopy score --help\n```\nOutput:\n```\n    --output_file=OUTPUT_FILE\n        File path where to store the results. [default: - (stdout)]\n    --records_file=RECORDS_FILE\n        An entity-to-phenotype annotation file in the same format as \"input_file\". This file, if provided, is used to score entries in the \"input_file\" against entries here. [default: None]\n    --annotations_file=ANNOTATIONS_FILE\n        An entity-to-phenotype annotation file in the same format as \"input_file\". This file, if provided, is used to add information content to the network. [default: None]\n    --ages_distribution_file=AGES_DISTRIBUTION_FILE\n        Phenotypes age summary stats file containing phenotype HPO id, mean_age, and std. [default: None]\n    --self=SELF\n        Score entries in the \"input_file\" against itself.\n    --summarization_method=SUMMARIZATION_METHOD\n        The method used to summarize the HRSS matrix. Supported Values are best match average (BMA), best match weighted average (BMWA), and maximum (maximum). [default: BMWA]\n    --threads=THREADS\n        Number of parallel processes to use. [default: 1]\n```\n## Library Usage\nThe `phenopy` library can be used as a `Python` module, allowing more control for advanced users.   \n\n```python\nimport os\nfrom phenopy import generate_annotated_hpo_network\nfrom phenopy.score import Scorer\n\n# data directory\nphenopy_data_directory = os.path.join(os.getenv('HOME'), '.phenopy/data')\n\n# files used in building the annotated HPO network\nobo_file = os.path.join(phenopy_data_directory, 'hp.obo')\ndisease_to_phenotype_file = os.path.join(phenopy_data_directory, 'phenotype.hpoa')\n\n# if you have a custom ages_distribution_file, you can set it here.\nages_distribution_file = os.path.join(phenopy_data_directory, 'xa_age_stats_oct052019.tsv')\n\nhpo_network, alt2prim, disease_records = \\\n    generate_annotated_hpo_network(obo_file,\n                                   disease_to_phenotype_file,\n                                   ages_distribution_file=ages_distribution_file\n                                   )\n\nscorer = Scorer(hpo_network)\n\nterms_a = ['HP:0001882', 'HP:0011839']\nterms_b = ['HP:0001263', 'HP:0000252']\n\nprint(scorer.score(terms_a, terms_b))\n```\nOutput:\n```\n0.0005\n```\n\nThe library can be used to prune parent phenotypes from the `phenotype.hpoa` and store pruned annotations as a file.\n```python\nfrom phenopy.util import export_phenotype_hpoa_with_no_parents\n# saves a new file of phenotype disease annotations with parent HPO terms removed from phenotype lists.\ndisease_to_phenotype_no_parents_file = os.path.join(phenopy_data_directory, 'phenotype.noparents.hpoa') \nexport_phenotype_hpoa_with_no_parents(disease_to_phenotype_file, disease_to_phenotype_no_parents_file, hpo_network)\n```\n\n### Config\nWhile we recommend using the default settings for most users, the config file *can be* modified: `$HOME/.phenopy/phenopy.ini`.\n\nTo run phenopy with a different version of `hp.obo`, set the path of `obo_file` in `$HOME/.phenopy/phenopy.ini`.\n\n## Contributing\nWe welcome contributions from the community. Please follow these steps to setup a local development environment.  \n```bash\npipenv install --dev\n```\n\nTo run tests locally:\n```bash\npipenv shell\ncoverage run --source=. -m unittest discover --start-directory tests/\ncoverage report -m\n```  \n\n## References\nThe underlying algorithm which determines the semantic similarity for any two HPO terms is based on an implementation of HRSS, [published here](https://www.ncbi.nlm.nih.gov/pubmed/23741529).\n\n\n## Citing Phenopy\nPlease use the following Bibtex to cite this software.\n```\n@software{arvai_phenopy_2019,\n    title = {Phenopy},\n    rights = {Attribution-NonCommercial-ShareAlike 4.0 International},\n    url = {https://github.com/GeneDx/phenopy},\n    abstract = {Phenopy is a Python package to perform phenotype similarity scoring by semantic similarity. \n        Phenopy is a lightweight but highly optimized command line tool and library to efficiently perform semantic \n        similarity scoring on generic entities with phenotype annotations from the Human Phenotype Ontology (HPO).},\n    version = {0.3.0},\n    author = {Arvai, Kevin and Borroto, Carlos and Gainullin, Vladimir and Retterer, Kyle},\n    date = {2019-11-05},\n    year = {2019},\n    doi = {10.5281/zenodo.3529569}\n}\n```\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "phenopy", "package_url": "https://pypi.org/project/phenopy/", "platform": "", "project_url": "https://pypi.org/project/phenopy/", "project_urls": null, "release_url": "https://pypi.org/project/phenopy/0.4.0/", "requires_dist": ["fire", "networkx", "numpy", "obonet", "pandas", "scipy"], "requires_python": "", "summary": "Phenotype comparison scoring by semantic similarity.", "version": "0.4.0"}, "last_serial": 6748952, "releases": {"0.2.1": [{"comment_text": "", "digests": {"md5": "8a88c89070b7d95affa2849dcd4aca5c", "sha256": "20940378938674bfff6b7015151052d02ac3affdf86032f64e0a0ea6e5698e7a"}, "downloads": -1, "filename": "phenopy-0.2.1-py3-none-any.whl", "has_sig": false, "md5_digest": "8a88c89070b7d95affa2849dcd4aca5c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 25726, "upload_time": "2019-09-10T15:56:01", "upload_time_iso_8601": "2019-09-10T15:56:01.515794Z", "url": "https://files.pythonhosted.org/packages/63/5f/cb0157235f05c82d63e540ef5f08e2ab868d29c6b1d8f837e2dc141c6fe0/phenopy-0.2.1-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "aa1769320134c7bfa191af8816905e47", "sha256": "6c0b9044a1190b8ad6abbe0eec2fde36c3343303130347f40642348bc1d9f039"}, "downloads": -1, "filename": "phenopy-0.2.1.tar.gz", "has_sig": false, "md5_digest": "aa1769320134c7bfa191af8816905e47", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 16451, "upload_time": "2019-09-10T15:56:04", "upload_time_iso_8601": "2019-09-10T15:56:04.602800Z", "url": "https://files.pythonhosted.org/packages/bb/af/95861bcf98efee21649e8bd7c4e284672d26cbd2823e48a0785989a6f8a1/phenopy-0.2.1.tar.gz"}], "0.3.0": [{"comment_text": "", "digests": {"md5": "8b29bfcac9aa1d00ff3eef30c3fed64f", "sha256": "e52cd9049aea297f1e8776b7b3f34a7f4c1cf432ef888bec03c04415dbd6d9d1"}, "downloads": -1, "filename": "phenopy-0.3.0-py3-none-any.whl", "has_sig": false, "md5_digest": "8b29bfcac9aa1d00ff3eef30c3fed64f", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31909, "upload_time": "2019-11-05T15:09:50", "upload_time_iso_8601": "2019-11-05T15:09:50.490125Z", "url": "https://files.pythonhosted.org/packages/72/c7/5c8a180693e5b75cb4b2bcf6c80af22cac0718c6e54785c0c8fe71f00a34/phenopy-0.3.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "a7615e3934fd9ae4e8fa3f05d6757ef6", "sha256": "560f23b55b8fd7ae09e22d46e590f991d116cdb81fa46d8e8a45e824a7ddbbef"}, "downloads": -1, "filename": "phenopy-0.3.0.tar.gz", "has_sig": false, "md5_digest": "a7615e3934fd9ae4e8fa3f05d6757ef6", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 22587, "upload_time": "2019-11-05T15:09:52", "upload_time_iso_8601": "2019-11-05T15:09:52.281133Z", "url": "https://files.pythonhosted.org/packages/6b/0e/5b1ac809fc3c0f87ebe7913b226f53403bfd8265ffa45b3ae0133fa112dd/phenopy-0.3.0.tar.gz"}], "0.3.2": [{"comment_text": "", "digests": {"md5": "6dc8795cd3c0875cb3bfcb343d03a8c7", "sha256": "35184598a68d73f25d27e7ce10c45e1f4750ec7f80aa7719abc2993ffd3e0270"}, "downloads": -1, "filename": "phenopy-0.3.2-py3-none-any.whl", "has_sig": false, "md5_digest": "6dc8795cd3c0875cb3bfcb343d03a8c7", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 32233, "upload_time": "2019-12-09T14:58:10", "upload_time_iso_8601": "2019-12-09T14:58:10.861480Z", "url": "https://files.pythonhosted.org/packages/3b/0d/9da737ccee30b1db45c276470b4f9c1eb974e6db8937a00eda6f7bc429e8/phenopy-0.3.2-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "57243105d3ceb2173431b764a61ef6ca", "sha256": "b97d4c27f25bea73b3012bedbdd283d459c55b5f70cd566902f9ff913a5bac2e"}, "downloads": -1, "filename": "phenopy-0.3.2.tar.gz", "has_sig": false, "md5_digest": "57243105d3ceb2173431b764a61ef6ca", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 23331, "upload_time": "2019-12-09T14:58:12", "upload_time_iso_8601": "2019-12-09T14:58:12.478654Z", "url": "https://files.pythonhosted.org/packages/2a/58/479dce8e83501ad65c70c1ffa9fdcc77f98baea497f50995d2590722f0e6/phenopy-0.3.2.tar.gz"}], "0.4.0": [{"comment_text": "", "digests": {"md5": "5effcf6c861f1c4c0d513a31e851af10", "sha256": "410e2fbcf987f07e67afed356ea93d8c285279b7a627e374710e840e2a6c5de1"}, "downloads": -1, "filename": "phenopy-0.4.0-py3-none-any.whl", "has_sig": false, "md5_digest": "5effcf6c861f1c4c0d513a31e851af10", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 33177, "upload_time": "2020-03-04T16:32:11", "upload_time_iso_8601": "2020-03-04T16:32:11.678933Z", "url": "https://files.pythonhosted.org/packages/34/3f/4d05be6e2f76972bddf1c7e81e23c3873945d328325f6483eebb1bd671d6/phenopy-0.4.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "20db97d110fbfef29fe2b613a17faa8e", "sha256": "9442ed95751320af602137e10ea4faeee174c869d4a06c144e3c516763f6af8f"}, "downloads": -1, "filename": "phenopy-0.4.0.tar.gz", "has_sig": false, "md5_digest": "20db97d110fbfef29fe2b613a17faa8e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 23983, "upload_time": "2020-03-04T16:32:13", "upload_time_iso_8601": "2020-03-04T16:32:13.107702Z", "url": "https://files.pythonhosted.org/packages/8f/18/6241f2cdcf2fdecd67e64d17e29a902844f9bd9c31ff93cbbfe38355fbe6/phenopy-0.4.0.tar.gz"}]}, "urls": [{"comment_text": "", "digests": {"md5": "5effcf6c861f1c4c0d513a31e851af10", "sha256": "410e2fbcf987f07e67afed356ea93d8c285279b7a627e374710e840e2a6c5de1"}, "downloads": -1, "filename": "phenopy-0.4.0-py3-none-any.whl", "has_sig": false, "md5_digest": "5effcf6c861f1c4c0d513a31e851af10", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 33177, "upload_time": "2020-03-04T16:32:11", "upload_time_iso_8601": "2020-03-04T16:32:11.678933Z", "url": "https://files.pythonhosted.org/packages/34/3f/4d05be6e2f76972bddf1c7e81e23c3873945d328325f6483eebb1bd671d6/phenopy-0.4.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "20db97d110fbfef29fe2b613a17faa8e", "sha256": "9442ed95751320af602137e10ea4faeee174c869d4a06c144e3c516763f6af8f"}, "downloads": -1, "filename": "phenopy-0.4.0.tar.gz", "has_sig": false, "md5_digest": "20db97d110fbfef29fe2b613a17faa8e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 23983, "upload_time": "2020-03-04T16:32:13", "upload_time_iso_8601": "2020-03-04T16:32:13.107702Z", "url": "https://files.pythonhosted.org/packages/8f/18/6241f2cdcf2fdecd67e64d17e29a902844f9bd9c31ff93cbbfe38355fbe6/phenopy-0.4.0.tar.gz"}]}