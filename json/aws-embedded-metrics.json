{"info": {"author": "Amazon Web Services", "author_email": "jarnance@amazon.com", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: Developers", "License :: OSI Approved :: Apache Software License", "Natural Language :: English", "Operating System :: OS Independent", "Programming Language :: Python :: 3"], "description": "# aws-embedded-metrics\n\n![](https://codebuild.us-west-2.amazonaws.com/badges?uuid=eyJlbmNyeXB0ZWREYXRhIjoidjNkYXpXTzMxdUY2dEdab2RaZTgvTXhUSGh2bjNmUlhmUEorejM0UytyOWNqeFptcUpBT2wzNkJ1MkExQXI3UFdNaGQzNlVmSzBPWkRhdmhkb2lqL05NPSIsIml2UGFyYW1ldGVyU3BlYyI6IkhKZS9rd2UwYzVud1VucVgiLCJtYXRlcmlhbFNldFNlcmlhbCI6MX0%3D&branch=master)\n[![](https://img.shields.io/pypi/v/aws-embedded-metrics)](https://pypi.org/project/aws-embedded-metrics/)\n\nGenerate CloudWatch Metrics embedded within structured log events. The embedded metrics will be extracted so you can visualize and alarm on them for real-time incident detection. This allows you to monitor aggregated values while preserving the detailed event context that generated them.\n\n- [Use Cases](#use-cases)\n- [Installation](#installation)\n- [Usage](#usage)\n- [API](#api)\n- [Examples](#examples)\n- [Development](#development)\n\n## Use Cases\n\n- **Generate custom metrics across compute environments**\n\n  - Easily generate custom metrics from Lambda functions without requiring custom batching code, making blocking network requests or relying on 3rd party software.\n  - Other compute environments (EC2, On-prem, ECS, EKS, and other container environments) are supported by installing the [CloudWatch Agent](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Embedded_Metric_Format_Generation_CloudWatch_Agent.html).\n\n- **Linking metrics to high cardinality context**\n\n  Using the Embedded Metric Format, you will be able to visualize and alarm on custom metrics, but also retain the original, detailed and high-cardinality context which is queryable using [CloudWatch Logs Insights](https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/AnalyzingLogData.html). For example, the library automatically injects environment metadata such as Lambda Function version, EC2 instance and image ids into the structured log event data.\n\n## Installation\n\n```\npip3 install aws-embedded-metrics\n```\n\n## Usage\n\nTo get a metric logger, you can decorate your function with a `metric_scope`:\n\n```py\nfrom aws_embedded_metrics import metric_scope\n\n@metric_scope\ndef my_handler(metrics):\n    metrics.put_dimensions({\"Foo\": \"Bar\"})\n    metrics.put_metric(\"ProcessingLatency\", 100, \"Milliseconds\")\n    metrics.set_property(\"AccountId\", \"123456789012\")\n    metrics.set_property(\"RequestId\", \"422b1569-16f6-4a03\")\n    metrics.set_property(\"DeviceId\", \"61270781-c6ac-46f1\")\n\n    return {\"message\": \"Hello!\"}\n```\n\n## API\n\n### MetricsLogger\n\nThe `MetricsLogger` is the interface you will use to publish embedded metrics.\n\n- **put_metric**(key: str, value: float, unit: str = \"None\") -> MetricsLogger\n\nAdds a new metric to the current logger context. Multiple metrics using the same key will be appended to an array of values. The Embedded Metric Format supports a maximum of 100 values per key. If more metric values are added than are supported by the format, the logger will be flushed to allow for new metric values to be captured.\n\nRequirements:\n\n- Name Length 1-255 characters\n- Name must be ASCII characters only\n- Values must be in the range of 8.515920e-109 to 1.174271e+108. In addition, special values (for example, NaN, +Infinity, -Infinity) are not supported.\n- Units must meet CW Metrics unit requirements, if not it will default to None. See [MetricDatum](https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_MetricDatum.html) for valid values.\n\nExamples:\n\n```py\nput_metric(\"Latency\", 200, \"Milliseconds\")\n```\n\n- **set_property**(key: str, value: Any) -> MetricsLogger\n\nAdds or updates the value for a given property on this context. This value is not submitted to CloudWatch Metrics but is searchable by CloudWatch Logs Insights. This is useful for contextual and potentially high-cardinality data that is not appropriate for CloudWatch Metrics dimensions.\n\nRequirements:\n\n- Length 1-255 characters\n\nExamples:\n\n```py\nset_property(\"RequestId\", \"422b1569-16f6-4a03-b8f0-fe3fd9b100f8\")\nset_property(\"InstanceId\", \"i-1234567890\")\nset_property(\"Device\", {\n  \"Id\": \"61270781-c6ac-46f1-baf7-22c808af8162\",\n  \"Name\": \"Transducer\",\n  \"Model\": \"PT-1234\"\n})\n```\n\n- **put_dimensions**(dimensions: Dict[str, str]) -> MetricsLogger\n\nAdds a new set of dimensions that will be associated to all metric values.\n\n**WARNING**: Every distinct value will result in a new CloudWatch Metric.\nIf the cardinality of a particular value is expected to be high, you should consider\nusing `setProperty` instead.\n\nRequirements:\n\n- Length 1-255 characters\n- ASCII characters only\n\nExamples:\n\n```py\nput_dimensions({ \"Operation\": \"Aggregator\" })\nput_dimensions({ \"Operation\": \"Aggregator\", \"DeviceType\": \"Actuator\" })\n```\n\n- **set_dimensions**(\\*dimensions: Dict[str, str]) -> MetricsLogger\n\nExplicitly override all dimensions. This will remove the default dimensions.\n\n**WARNING**: Every distinct value will result in a new CloudWatch Metric.\nIf the cardinality of a particular value is expected to be high, you should consider\nusing `setProperty` instead.\n\nRequirements:\n\n- Length 1-255 characters\n- ASCII characters only\n\nExamples:\n\n```py\nset_dimensions(\n  { \"Operation\": \"Aggregator\" },\n  { \"Operation\": \"Aggregator\", \"DeviceType\": \"Actuator\" }\n)\n```\n\n- **set_namespace**(value: str) -> MetricsLogger\n\nSets the CloudWatch [namespace](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/cloudwatch_concepts.html#Namespace) that extracted metrics should be published to. If not set, a default value of aws-embedded-metrics will be used.\n\nRequirements:\n\n- Name Length 1-255 characters\n- Name must be ASCII characters only\n\nExamples:\n\n```py\nset_namespace(\"MyApplication\")\n```\n\n- **flush**()\n\nFlushes the current MetricsContext to the configured sink and resets all properties, dimensions and metric values. The namespace and default dimensions will be preserved across flushes.\n\n### Configuration\n\nAll configuration values can be set using environment variables with the prefix (`AWS_EMF_`). Configuration should be performed as close to application start up as possible.\n\n**ServiceName**: Overrides the name of the service. For services where the name cannot be inferred (e.g. Java process running on EC2), a default value of Unknown will be used if not explicitly set.\n\nRequirements:\n\n- Name Length 1-255 characters\n- Name must be ASCII characters only\n\nExample:\n\n```py\n# in process\nfrom aws_embedded_metrics.config import get_config\nConfig = get_config()\nConfig.service_name = \"MyApp\"\n\n# environment\nAWS_EMF_SERVICE_NAME = MyApp\n```\n\n**ServiceType**: Overrides the type of the service. For services where the type cannot be inferred (e.g. Java process running on EC2), a default value of Unknown will be used if not explicitly set.\n\nRequirements:\n\n- Name Length 1-255 characters\n- Name must be ASCII characters only\n\nExample:\n\n```py\n# in process\nfrom aws_embedded_metrics.config import get_config\nConfig = get_config()\nConfig.service_type = \"NodeJSWebApp\"\n\n# environment\nAWS_EMF_SERVICE_TYPE = NodeJSWebApp\n```\n\n**LogGroupName**: For agent-based platforms, you may optionally configure the destination log group that metrics should be delivered to. This value will be passed from the library to the agent in the Embedded Metric payload. If a LogGroup is not provided, the default value will be derived from the service name: <service-name>-metrics\n\nRequirements:\n\n- Name Length 1-512 characters\n- Log group names consist of the following characters: a-z, A-Z, 0-9, '\\_' (underscore), '-' (hyphen), '/' (forward slash), and '.' (period). Pattern: [\\.\\-_/#A-Za-z0-9]+\n\nExample:\n\n```py\n# in process\nfrom aws_embedded_metrics.config import get_config\nConfig = get_config()\nConfig.log_group_name = \"LogGroupName\"\n\n# environment\nAWS_EMF_LOG_GROUP_NAME = LogGroupName\n```\n\n**LogStreamName**: For agent-based platforms, you may optionally configure the destination log stream that metrics should be delivered to. This value will be passed from the library to the agent in the Embedded Metric payload. If a LogGroup is not provided, the default value will be derived by the agent (this will likely be the hostname).\n\nRequirements:\n\n- Name Length 1-512 characters\n- The ':' (colon) and '\\*' (asterisk) characters are not allowed. Pattern: [^:]\\*\n\nExample:\n\n```py\n# in process\nfrom aws_embedded_metrics.config import get_config\nConfig = get_config()\nConfig.log_stream_name = \"LogStreamName\"\n\n# environment\nAWS_EMF_LOG_STREAM_NAME = LogStreamName\n```\n\n**NameSpace**: Overrides the CloudWatch [namespace](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/cloudwatch_concepts.html#Namespace). If not set, a default value of aws-embedded-metrics will be used.\n\nRequirements:\n\n- Name Length 1-512 characters\n- Name must be ASCII characters only\n\nExample:\n\n```py\n# in process\nfrom aws_embedded_metrics.config import get_config\nConfig = get_config()\nConfig.namespace = \"MyApplication\"\n\n# environment\nAWS_EMF_NAMESPACE = MyApplication\n```\n\n## Examples\n\nCheck out the [examples](https://github.com/awslabs/aws-embedded-metrics-python/tree/master/examples) directory to get started.\n\n## Development\n\n1. Install Test Dependencies\n\n```\npip install tox\n```\n\n2. Run tests\n\n```\ntox\n```\n\n3. Integration tests. These tests require Docker to run the CloudWatch Agent and valid AWS credentials. Tests can be run by:\n\n```sh\nexport AWS_ACCESS_KEY_ID=\nexport AWS_SECRET_ACCESS_KEY=\nexport AWS_REGION=us-west-2\n./bin/run-integ-tests.sh\n```\n\n## License\n\nThis project is licensed under the Apache-2.0 License.\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/awslabs/aws-embedded-metrics-python", "keywords": "aws logs metrics emf", "license": "", "maintainer": "", "maintainer_email": "", "name": "aws-embedded-metrics", "package_url": "https://pypi.org/project/aws-embedded-metrics/", "platform": "", "project_url": "https://pypi.org/project/aws-embedded-metrics/", "project_urls": {"Homepage": "https://github.com/awslabs/aws-embedded-metrics-python"}, "release_url": "https://pypi.org/project/aws-embedded-metrics/1.0.2/", "requires_dist": ["aiohttp"], "requires_python": "", "summary": "AWS Embedded Metrics Package", "version": "1.0.2"}, "last_serial": 7060460, "releases": {"0.1.0b1573849895867": [{"comment_text": "", "digests": {"md5": "a28c68ba5ac05f2acaa4cccdba1cca51", "sha256": "505513cdafb4b914a68430c2967c7e9b4e5a1ffce0c8ddd416a9a30f757548ad"}, "downloads": -1, "filename": "aws_embedded_metrics-0.1.0b1573849895867-py3-none-any.whl", "has_sig": false, "md5_digest": "a28c68ba5ac05f2acaa4cccdba1cca51", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 32014, "upload_time": "2019-11-15T21:01:51", "upload_time_iso_8601": "2019-11-15T21:01:51.087843Z", "url": "https://files.pythonhosted.org/packages/1c/3e/2d3e9b147b00bba7fd1639b43c5bd9486b6bc465d838c76049b1fef24e63/aws_embedded_metrics-0.1.0b1573849895867-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "7f77858a72ede6b7a3a8f72b46a9043b", "sha256": "c45b19e19c0d1cbf8f6d326afc34bc6533ec800d908cf945c10241dfbb1d869b"}, "downloads": -1, "filename": "aws-embedded-metrics-0.1.0b1573849895867.tar.gz", "has_sig": false, "md5_digest": "7f77858a72ede6b7a3a8f72b46a9043b", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15449, "upload_time": "2019-11-15T21:01:53", "upload_time_iso_8601": "2019-11-15T21:01:53.371815Z", "url": "https://files.pythonhosted.org/packages/86/57/f3d6e23c53ae0c0f157b91b078e8085bb82ef659769b6ac86ef1eaa75ee7/aws-embedded-metrics-0.1.0b1573849895867.tar.gz"}], "1.0.0": [{"comment_text": "", "digests": {"md5": "73936be32353d92acd232043f4ff384b", "sha256": "7285bd47e4665b2424953a28720cf1aa0e1ae1a454cb9b2c4d9d3cb9a66e977e"}, "downloads": -1, "filename": "aws_embedded_metrics-1.0.0-py3-none-any.whl", "has_sig": false, "md5_digest": "73936be32353d92acd232043f4ff384b", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31925, "upload_time": "2019-11-18T15:15:22", "upload_time_iso_8601": "2019-11-18T15:15:22.365696Z", "url": "https://files.pythonhosted.org/packages/4e/71/9d3be3bbbcbb5eb544016337f5adba7d9445bfa39b5c6596ba03191944c6/aws_embedded_metrics-1.0.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "1b37e946c5d8bef87aaa2c5da3a26023", "sha256": "054cf8600f0c57cd3c98444c04a2f5188afbe9e50a736b50a7ecff463b624c87"}, "downloads": -1, "filename": "aws-embedded-metrics-1.0.0.tar.gz", "has_sig": false, "md5_digest": "1b37e946c5d8bef87aaa2c5da3a26023", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15545, "upload_time": "2019-11-18T15:15:24", "upload_time_iso_8601": "2019-11-18T15:15:24.024883Z", "url": "https://files.pythonhosted.org/packages/df/ad/7b32eda4db50f6c7c77c24c5700224a0be90e8dc2a9163ce316016475534/aws-embedded-metrics-1.0.0.tar.gz"}], "1.0.1": [{"comment_text": "", "digests": {"md5": "be646e336cb2c9fd9f4775bcb7d02099", "sha256": "8723de69135d50476e0e044d8531628fb7bdd5344388f999aaf533185f962e26"}, "downloads": -1, "filename": "aws_embedded_metrics-1.0.1-py3-none-any.whl", "has_sig": false, "md5_digest": "be646e336cb2c9fd9f4775bcb7d02099", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31280, "upload_time": "2020-04-08T14:06:51", "upload_time_iso_8601": "2020-04-08T14:06:51.226108Z", "url": "https://files.pythonhosted.org/packages/27/8f/cf82f2cfde7a62d39f214e7c574f118864d2afed8cea2c60580edb733807/aws_embedded_metrics-1.0.1-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "ef211982a00268a7655fde1cde15a4b2", "sha256": "ee001fc0b5112beb86646c51c139332bde754d1cc239663a3cc3b879d2764387"}, "downloads": -1, "filename": "aws-embedded-metrics-1.0.1.tar.gz", "has_sig": false, "md5_digest": "ef211982a00268a7655fde1cde15a4b2", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15746, "upload_time": "2020-04-08T14:06:52", "upload_time_iso_8601": "2020-04-08T14:06:52.748045Z", "url": "https://files.pythonhosted.org/packages/b0/57/b8e392cfd034a28616f5995f69beda0f13fb1903c06b96f0fd8fae63966f/aws-embedded-metrics-1.0.1.tar.gz"}], "1.0.1b2": [{"comment_text": "", "digests": {"md5": "14863dd5faf2d3e0adf51d54e971025e", "sha256": "fefc3fc2df52f5e0aad325e56e0b133c1b550069737bde570d1807013959fc08"}, "downloads": -1, "filename": "aws_embedded_metrics-1.0.1b2-py3-none-any.whl", "has_sig": false, "md5_digest": "14863dd5faf2d3e0adf51d54e971025e", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31224, "upload_time": "2020-03-28T23:48:02", "upload_time_iso_8601": "2020-03-28T23:48:02.922417Z", "url": "https://files.pythonhosted.org/packages/da/91/7c1cb4a26f76b1eb69b69bda94cade6fae8bd7bcd7ea792e5cab4d863e3f/aws_embedded_metrics-1.0.1b2-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "78636ed0935d1926a4aed69ae2b1784e", "sha256": "c1216c74a90d9b0346428882de855b8b826e151847e6df25d2f1a44a0c512771"}, "downloads": -1, "filename": "aws-embedded-metrics-1.0.1b2.tar.gz", "has_sig": false, "md5_digest": "78636ed0935d1926a4aed69ae2b1784e", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15624, "upload_time": "2020-03-28T23:48:04", "upload_time_iso_8601": "2020-03-28T23:48:04.519724Z", "url": "https://files.pythonhosted.org/packages/32/a9/38e5162aa20b981ec9dc17665fc137c64a33c8efcc5a9a6f0decbac20202/aws-embedded-metrics-1.0.1b2.tar.gz"}], "1.0.1b4": [{"comment_text": "", "digests": {"md5": "85698b2c9fc34ed5e90179e3ecd375d3", "sha256": "615ba0dcca9c487ed63eb053b5ae011184efde2635ac508d9bec41d95081c475"}, "downloads": -1, "filename": "aws_embedded_metrics-1.0.1b4-py3-none-any.whl", "has_sig": false, "md5_digest": "85698b2c9fc34ed5e90179e3ecd375d3", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31313, "upload_time": "2020-04-08T13:59:45", "upload_time_iso_8601": "2020-04-08T13:59:45.103565Z", "url": "https://files.pythonhosted.org/packages/90/50/17e4b941d0b4c7455c571fce414b4ba5f8091a1f811b628db2f08a5ae8dc/aws_embedded_metrics-1.0.1b4-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "412a16b98caccf12774cad53296ee6c7", "sha256": "9f6ffc7a6059ed559945c088f1e12676378fef86b09dcd6b50ec8e730ec71ccb"}, "downloads": -1, "filename": "aws-embedded-metrics-1.0.1b4.tar.gz", "has_sig": false, "md5_digest": "412a16b98caccf12774cad53296ee6c7", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15753, "upload_time": "2020-04-08T13:59:46", "upload_time_iso_8601": "2020-04-08T13:59:46.586764Z", "url": "https://files.pythonhosted.org/packages/ce/30/976c5bab852327723c52222a2ecc485c5bbe6f6996a9a39f03c89d9e28ee/aws-embedded-metrics-1.0.1b4.tar.gz"}], "1.0.2": [{"comment_text": "", "digests": {"md5": "2192c776683efec9442e7034cdd7e9c2", "sha256": "239bec814eed3d271dbe26d0c31d48be4c9c90032c9775da91433f9b0d2789e4"}, "downloads": -1, "filename": "aws_embedded_metrics-1.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "2192c776683efec9442e7034cdd7e9c2", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31467, "upload_time": "2020-04-20T14:24:44", "upload_time_iso_8601": "2020-04-20T14:24:44.512547Z", "url": "https://files.pythonhosted.org/packages/ad/fc/439108facc91e56456b84e0f26804df21d5eec328fbfd875b6f456a107eb/aws_embedded_metrics-1.0.2-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "c5e83228cd3d25acf21d004f0f4bc078", "sha256": "7d5a4c7ca2239e737711f4b0cdba1e40adc354a3d6894e00267b93975c8f7c20"}, "downloads": -1, "filename": "aws-embedded-metrics-1.0.2.tar.gz", "has_sig": false, "md5_digest": "c5e83228cd3d25acf21d004f0f4bc078", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15898, "upload_time": "2020-04-20T14:24:45", "upload_time_iso_8601": "2020-04-20T14:24:45.756759Z", "url": "https://files.pythonhosted.org/packages/05/ed/d3f01d015fd7e7f9d2ca3775e4c42b013ea06cd28684f1a95ab82284997d/aws-embedded-metrics-1.0.2.tar.gz"}]}, "urls": [{"comment_text": "", "digests": {"md5": "2192c776683efec9442e7034cdd7e9c2", "sha256": "239bec814eed3d271dbe26d0c31d48be4c9c90032c9775da91433f9b0d2789e4"}, "downloads": -1, "filename": "aws_embedded_metrics-1.0.2-py3-none-any.whl", "has_sig": false, "md5_digest": "2192c776683efec9442e7034cdd7e9c2", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": null, "size": 31467, "upload_time": "2020-04-20T14:24:44", "upload_time_iso_8601": "2020-04-20T14:24:44.512547Z", "url": "https://files.pythonhosted.org/packages/ad/fc/439108facc91e56456b84e0f26804df21d5eec328fbfd875b6f456a107eb/aws_embedded_metrics-1.0.2-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "c5e83228cd3d25acf21d004f0f4bc078", "sha256": "7d5a4c7ca2239e737711f4b0cdba1e40adc354a3d6894e00267b93975c8f7c20"}, "downloads": -1, "filename": "aws-embedded-metrics-1.0.2.tar.gz", "has_sig": false, "md5_digest": "c5e83228cd3d25acf21d004f0f4bc078", "packagetype": "sdist", "python_version": "source", "requires_python": null, "size": 15898, "upload_time": "2020-04-20T14:24:45", "upload_time_iso_8601": "2020-04-20T14:24:45.756759Z", "url": "https://files.pythonhosted.org/packages/05/ed/d3f01d015fd7e7f9d2ca3775e4c42b013ea06cd28684f1a95ab82284997d/aws-embedded-metrics-1.0.2.tar.gz"}]}