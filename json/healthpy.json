{"info": {"author": "Colin Bounouar", "author_email": "colin.bounouar.dev@gmail.com", "bugtrack_url": null, "classifiers": ["Development Status :: 5 - Production/Stable", "Intended Audience :: Developers", "License :: OSI Approved :: MIT License", "Natural Language :: English", "Programming Language :: Python", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.6", "Programming Language :: Python :: 3.7", "Programming Language :: Python :: 3.8", "Topic :: Software Development :: Build Tools"], "description": "<h2 align=\"center\">Health Check for HTTP APIs</h2>\n\n<p align=\"center\">\n<a href=\"https://pypi.org/project/healthpy/\"><img alt=\"pypi version\" src=\"https://img.shields.io/pypi/v/healthpy\"></a>\n<a href=\"https://travis-ci.com/Colin-b/healthpy\"><img alt=\"Build status\" src=\"https://api.travis-ci.com/Colin-b/healthpy.svg?branch=develop\"></a>\n<a href=\"https://travis-ci.com/Colin-b/healthpy\"><img alt=\"Coverage\" src=\"https://img.shields.io/badge/coverage-100%25-brightgreen\"></a>\n<a href=\"https://github.com/psf/black\"><img alt=\"Code style: black\" src=\"https://img.shields.io/badge/code%20style-black-000000.svg\"></a>\n<a href=\"https://travis-ci.com/Colin-b/healthpy\"><img alt=\"Number of tests\" src=\"https://img.shields.io/badge/tests-128 passed-blue\"></a>\n<a href=\"https://pypi.org/project/healthpy/\"><img alt=\"Number of downloads\" src=\"https://img.shields.io/pypi/dm/healthpy\"></a>\n</p>\n\nCreate an health check endpoint on your REST API following [Health Check RFC](https://inadarei.github.io/rfc-healthcheck/) draft version 4.\n\n- [Perform checks](#perform-checks)\n  - [Of an external HTTP resource](#http)\n  - [Of a redis server](#redis)\n- [Return health check result](#return-result)\n  - [Aggregate multiple statuses](#compute-status-from-multiple-statuses)\n  - [Use a custom status](#using-custom-status)\n  - [HTTP response body](#http-response-body)\n  - [HTTP response status code](#http-response-status-code)\n- [Endpoint](#endpoint)\n  - [Starlette](#starlette)\n\n## Perform checks\n\nIn case you have external dependencies, you should check the health of those dependencies.\n\n### HTTP\n\nIf you have an external HTTP resource, you can check its health, as in the following sample:\n\n```python\nimport healthpy.httpx\n\nstatus, checks = healthpy.httpx.check(\"petstore\", \"https://petstore3.swagger.io/api/v3/openapi.json\")\n```\n\nNote: [httpx](https://pypi.python.org/pypi/httpx) module must be installed to perform HTTP health checks.\n\nAlternatively, you can use [requests](https://pypi.python.org/pypi/requests) to perform the exact same check:\n\n```python\nimport healthpy.requests\n\nstatus, checks = healthpy.requests.check(\"petstore\", \"https://petstore3.swagger.io/api/v3/openapi.json\")\n```\n\n### Redis\n\nIf you rely on redis, you should check its health.\n\n[redis](https://pypi.python.org/pypi/redis) module must be installed to perform Redis health checks.\n\n```python\nimport healthpy.redis\n\nstatus, checks = healthpy.redis.check(\"redis://redis_url\", \"redis_key\")\n```\n\n## Return result\n\nOnce all checks have been performed you should return the result to your client.\n\n### Compute status from multiple statuses\n\nIf you performed more than one check, you have to compute an aggregated status from all the checks.\n\n```python\nimport healthpy\n\nstatus1 = healthpy.pass_status \nstatus2 = healthpy.warn_status\nstatusN = healthpy.fail_status\n\nstatus = healthpy.status(status1, status2, statusN)\n```\n\n### Using custom status\n\nBy default pass status is \"pass\", warn status is \"warn\" and fail status is \"fail\".\n\nIt can be tweaked by setting the value of healthpy.*_status as in the following sample:\n\n```python\nimport healthpy\n\nhealthpy.pass_status = \"ok\"\nhealthpy.warn_status = \"custom\"\nhealthpy.fail_status = \"error\"\n```\n\n### HTTP response body\n\nHTTP response body can be retrieved as a dictionary to be returned as JSON.\n\n```python\nimport healthpy\n\nstatus = healthpy.pass_status  # replace with the aggregated status\nchecks = {}  # replace with the computed checks\n\nbody = healthpy.response_body(status, checks=checks)\n```\n\nChecks results are not mandatory in the response.\n\n```python\nimport healthpy\n\nstatus = healthpy.pass_status  # replace with the aggregated status\n\nbody = healthpy.response_body(status)\n```\n\n### HTTP response status code\n\nHTTP response status code can be retrieved as an integer.\n\n```python\nimport healthpy\n\nstatus = healthpy.pass_status  # replace with the aggregated status\n\nstatus_code = healthpy.response_status_code(status)\n```\n\n#### Consul\n\nHTTP response status code should be a bit different for [Consul](https://www.consul.io/docs/agent/checks.html) health checks.\n\n```python\nimport healthpy\n\nstatus = healthpy.pass_status  # replace with the aggregated status\n\nstatus_code = healthpy.consul_response_status_code(status)\n```\n\n## Endpoint\n\n### Starlette\n\nAn helper function is available to create a [starlette](https://www.starlette.io) endpoint for [Consul](https://www.consul.io/docs/agent/checks.html) health check.\n\n```python\nfrom starlette.applications import Starlette\nimport healthpy\nimport healthpy.http\nimport healthpy.redis\nfrom healthpy.starlette import add_consul_health_endpoint\n\n\napp = Starlette()\n\n\nasync def health_check():\n    # TODO Replace by your own checks.\n    status_1, checks_1 = healthpy.http.check(\"my external dependency\", \"http://url_to_check\")\n    status_2, checks_2 = healthpy.redis.check(\"redis://redis_url\", \"key_to_check\")\n    return healthpy.status(status_1, status_2), {**checks_1, **checks_2}\n\n# /health endpoint will call the health_check coroutine.\nadd_consul_health_endpoint(app, health_check)\n```\n\nNote: [starlette](https://pypi.python.org/pypi/starlette) module must be installed.\n\n## Testing\n\nA `pytest` fixture can be used to mock the datetime returned in http health check.\n\n```python\nfrom healthpy.testing import mock_http_health_datetime\n\ndef test_http(mock_http_health_datetime):\n    # Time will be returned as \"2018-10-11T15:05:05.663979\"\n    pass  # Add your test calling healthpy.http.check\n```\n\n## How to install\n1. [python 3.6+](https://www.python.org/downloads/) must be installed\n2. Use pip to install module:\n```sh\npython -m pip install healthpy\n```\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "https://pypi.org/project/healthpy/", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://colin-b.github.io/healthpy/", "keywords": "health,api,http,redis", "license": "MIT", "maintainer": "Colin Bounouar", "maintainer_email": "colin.bounouar.dev@gmail.com", "name": "healthpy", "package_url": "https://pypi.org/project/healthpy/", "platform": "Windows", "project_url": "https://pypi.org/project/healthpy/", "project_urls": {"Changelog": "https://github.com/Colin-b/healthpy/blob/master/CHANGELOG.md", "Download": "https://pypi.org/project/healthpy/", "GitHub": "https://github.com/Colin-b/healthpy", "Homepage": "https://colin-b.github.io/healthpy/", "Issues": "https://github.com/Colin-b/healthpy/issues"}, "release_url": "https://pypi.org/project/healthpy/1.11.0/", "requires_dist": ["pytest-responses (==0.4.*) ; extra == 'testing'", "pytest-httpx (==0.2.*) ; extra == 'testing'", "redis (==3.*) ; extra == 'testing'", "starlette (==0.13.*) ; extra == 'testing'", "pytest-cov (==2.*) ; extra == 'testing'"], "requires_python": ">=3.6", "summary": "Health Check for HTTP APIs", "version": "1.11.0"}, "last_serial": 6885632, "releases": {"1.10.0": [{"comment_text": "", "digests": {"md5": "b2e9cfa061590a1316c22951dfd9c194", "sha256": "d0d5eb08c0dad4ff5d7fd46dac2c48b1f6c0f7f18e6cb2de2006eafb5d42549f"}, "downloads": -1, "filename": "healthpy-1.10.0-py3-none-any.whl", "has_sig": false, "md5_digest": "b2e9cfa061590a1316c22951dfd9c194", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 13181, "upload_time": "2020-03-25T16:09:25", "upload_time_iso_8601": "2020-03-25T16:09:25.700707Z", "url": "https://files.pythonhosted.org/packages/60/92/079293a3e85708aa18c3b48352d4ca4d194592239a03ea96115be8cba05c/healthpy-1.10.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "40dcd59262a5d81a69a8a495a05d3c02", "sha256": "2c2a66fad3f89020c908618914e2c5a3f6dba66c2fbea1273202788b2f90f2fb"}, "downloads": -1, "filename": "healthpy-1.10.0.tar.gz", "has_sig": false, "md5_digest": "40dcd59262a5d81a69a8a495a05d3c02", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 8548, "upload_time": "2020-03-25T16:09:27", "upload_time_iso_8601": "2020-03-25T16:09:27.099565Z", "url": "https://files.pythonhosted.org/packages/b9/50/59adc775d3a02f22c4f3026871509d6d842a66c509b180fc29c730ffc3b2/healthpy-1.10.0.tar.gz"}], "1.11.0": [{"comment_text": "", "digests": {"md5": "42e1add02a57377ad1519e7e843a1f4f", "sha256": "2d2548ab67e7badd93ed578e900d622f37f41acecaee744640e7636db420161a"}, "downloads": -1, "filename": "healthpy-1.11.0-py3-none-any.whl", "has_sig": false, "md5_digest": "42e1add02a57377ad1519e7e843a1f4f", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 13272, "upload_time": "2020-03-25T23:05:47", "upload_time_iso_8601": "2020-03-25T23:05:47.042795Z", "url": "https://files.pythonhosted.org/packages/a4/5d/24584a6e876def3bf4004bbb80b033953da7064ad1b191b00f375a79ba13/healthpy-1.11.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "c8cf0c353c416894a8a425d5426f00e9", "sha256": "8d2ac0dfa16b9e79e7c5e49a27f0c9f256f502991c513f5113f654b09991277d"}, "downloads": -1, "filename": "healthpy-1.11.0.tar.gz", "has_sig": false, "md5_digest": "c8cf0c353c416894a8a425d5426f00e9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 10372, "upload_time": "2020-03-25T23:05:48", "upload_time_iso_8601": "2020-03-25T23:05:48.302679Z", "url": "https://files.pythonhosted.org/packages/9a/cc/3b9f6234b7244574a7306c2e5a18a20c6ce31dc75581e02fe6a89c530661/healthpy-1.11.0.tar.gz"}], "1.7.0": [{"comment_text": "", "digests": {"md5": "037bce6051b544492a7313bcfb01bfa1", "sha256": "47493245b3986e79cd5e4f5ff5c4e9df6e6a04fb6d3bee410ae84107929521e9"}, "downloads": -1, "filename": "healthpy-1.7.0-py3-none-any.whl", "has_sig": false, "md5_digest": "037bce6051b544492a7313bcfb01bfa1", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 6228, "upload_time": "2019-11-28T23:14:10", "upload_time_iso_8601": "2019-11-28T23:14:10.548426Z", "url": "https://files.pythonhosted.org/packages/2f/aa/139adba8b0207533b9a58f11446a2517894469e56b1e4ac3383a08d2efd6/healthpy-1.7.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "56e508001eeeec80c5b821347c9575ca", "sha256": "110360dc4dac1711b3d024ce280024fc631c8e087ca1a7f115e96ae9ce3db494"}, "downloads": -1, "filename": "healthpy-1.7.0.tar.gz", "has_sig": false, "md5_digest": "56e508001eeeec80c5b821347c9575ca", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 4317, "upload_time": "2019-11-28T23:14:12", "upload_time_iso_8601": "2019-11-28T23:14:12.737080Z", "url": "https://files.pythonhosted.org/packages/2c/d9/a65def9985cf1bdc128bb6980ad7b98fe17df4cfe3bc47bc459fd72a82a4/healthpy-1.7.0.tar.gz"}], "1.8.0": [{"comment_text": "", "digests": {"md5": "7883fac78ce33dd04c1de27fc03de9b4", "sha256": "91c8768a7e65f3054f8be51bf78659768ec5edd79c6ddec7e76679a49e2107b1"}, "downloads": -1, "filename": "healthpy-1.8.0-py3-none-any.whl", "has_sig": false, "md5_digest": "7883fac78ce33dd04c1de27fc03de9b4", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 8936, "upload_time": "2020-02-16T18:07:21", "upload_time_iso_8601": "2020-02-16T18:07:21.666301Z", "url": "https://files.pythonhosted.org/packages/14/a0/41a09b2a19a567de57f9e9fdccbcc953c00f9f51243d91d5feb490a14de5/healthpy-1.8.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "7badae8e84e59976727ea9380ac8a7d3", "sha256": "f8e2a18362f4671a339ef976135e4c200e10c8b2cab901e6aaff3300f24ee912"}, "downloads": -1, "filename": "healthpy-1.8.0.tar.gz", "has_sig": false, "md5_digest": "7badae8e84e59976727ea9380ac8a7d3", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 6770, "upload_time": "2020-02-16T18:07:22", "upload_time_iso_8601": "2020-02-16T18:07:22.797448Z", "url": "https://files.pythonhosted.org/packages/4b/d5/7ebec03f7d2552772c7a32893002659bce08dfabc63ef24cf6c4f3250e4f/healthpy-1.8.0.tar.gz"}], "1.9.0": [{"comment_text": "", "digests": {"md5": "c8b9de8d3638486e760fa263419652e3", "sha256": "59753ca1e25485879cb58949b6bb2dee6f1ee83e780d8395f442fc500fb55813"}, "downloads": -1, "filename": "healthpy-1.9.0-py3-none-any.whl", "has_sig": false, "md5_digest": "c8b9de8d3638486e760fa263419652e3", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 10982, "upload_time": "2020-02-17T13:54:49", "upload_time_iso_8601": "2020-02-17T13:54:49.567116Z", "url": "https://files.pythonhosted.org/packages/37/aa/bd945cb44506214e340acd9f950c6380934032772adfe9a686c38a242956/healthpy-1.9.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "123345c60ec6d0de4975de5557918419", "sha256": "fd2b19606f56c2b2653f94091731273387a05cb08a886045f696d191fc72f0b1"}, "downloads": -1, "filename": "healthpy-1.9.0.tar.gz", "has_sig": false, "md5_digest": "123345c60ec6d0de4975de5557918419", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 9195, "upload_time": "2020-02-17T13:54:50", "upload_time_iso_8601": "2020-02-17T13:54:50.444244Z", "url": "https://files.pythonhosted.org/packages/b1/54/7b46ee6e7960034708c06b7684b8f326c4dc4b9f9c12e37aab20e192a450/healthpy-1.9.0.tar.gz"}]}, "urls": [{"comment_text": "", "digests": {"md5": "42e1add02a57377ad1519e7e843a1f4f", "sha256": "2d2548ab67e7badd93ed578e900d622f37f41acecaee744640e7636db420161a"}, "downloads": -1, "filename": "healthpy-1.11.0-py3-none-any.whl", "has_sig": false, "md5_digest": "42e1add02a57377ad1519e7e843a1f4f", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.6", "size": 13272, "upload_time": "2020-03-25T23:05:47", "upload_time_iso_8601": "2020-03-25T23:05:47.042795Z", "url": "https://files.pythonhosted.org/packages/a4/5d/24584a6e876def3bf4004bbb80b033953da7064ad1b191b00f375a79ba13/healthpy-1.11.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "c8cf0c353c416894a8a425d5426f00e9", "sha256": "8d2ac0dfa16b9e79e7c5e49a27f0c9f256f502991c513f5113f654b09991277d"}, "downloads": -1, "filename": "healthpy-1.11.0.tar.gz", "has_sig": false, "md5_digest": "c8cf0c353c416894a8a425d5426f00e9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 10372, "upload_time": "2020-03-25T23:05:48", "upload_time_iso_8601": "2020-03-25T23:05:48.302679Z", "url": "https://files.pythonhosted.org/packages/9a/cc/3b9f6234b7244574a7306c2e5a18a20c6ce31dc75581e02fe6a89c530661/healthpy-1.11.0.tar.gz"}]}