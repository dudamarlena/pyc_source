{"info": {"author": "Mike Phillipson", "author_email": "MICHAEL_PHILLIPSON1@homedepot.com", "bugtrack_url": null, "classifiers": [], "description": "# metREx\n\nSQL query and monitoring system metrics exporter for [Prometheus](https://prometheus.io/). A product of **Reliability Engineering** at [The Home Depot](https://www.homedepot.com/).\n\nSupported database engines include:\n- [DB2](https://www.ibm.com/products/db2-database) / [Informix](https://www.ibm.com/products/informix)\n- [Microsoft SQL Server](https://www.microsoft.com/en-us/sql-server/default.aspx)\n- [MySQL](https://www.mysql.com/)\n- [Oracle](https://www.oracle.com/database)\n- [PostgreSQL](https://www.postgresql.org/)\n\nPrometheus metrics can be generated from the following monitoring systems:\n- [AppDynamics](https://www.appdynamics.com/)\n- [ExtraHop](https://www.extrahop.com/)\n\n## Table of Contents\n\n* [Installation](#installation)\n  * [Database Engines](#database-engines)\n* [Local Environment Setup](#local-environment-setup)\n  * [ENV Variables](#env-variables)\n* [Configuration: Services](#configuration-services)\n  * [Database Connection Parameters](#database-connection-parameters)\n  * [API Connection Parameters](#api-connection-parameters)\n  * [Encrypting Credentials](#encrypting-credentials)\n* [Configuration: Jobs](#configuration-jobs)\n  * [Defining Jobs as PCF Services](#defining-jobs-as-pcf-services)\n  * [Defining Jobs in a GitHub Repository](#defining-jobs-in-a-github-repository)\n  * [Job Parameters](#job-parameters)\n  * [About Aggregation](#about-aggregation)\n* [Exposing Metrics to a Pushgateway](#exposing-metrics-to-a-pushgateway)\n* [Running the Application](#running-the-application)\n* [Swagger](#swagger)\n* [Testing](#testing)\n* [License](#license)\n\n## Installation\n\n```shell\n$ pip install metREx\n```\n\n### Database Engines\n\nThe [SQLAlchemy](https://www.sqlalchemy.org/) package used by this application enables connectivity to a variety of database engines. However, additional packages may need to be installed, depending on which engines are used.\n\nA variation on the above `pip install` command can be used to include specific SQLAlchemy driver packages as needed.*\n\nIn the following example, the dialect identifiers `mysql` and `postgres`, supplied in brackets, will install the `pymysql` and `pg8000` driver packages for MySQL and PostgreSQL database connectivity, respectively:\n\n```shell\n$ pip install metREx[mysql,postgresql]\n```\n\nFor convenience, a selection of predefined dialects are available for commonly used SQLAlchemy driver packages:*\n\n| Dialect      | Driver      |\n| :---         | :---        |\n| `db2`        | `ibm_db2`   |\n| `mssql`      | `pymssql`   |\n| `mysql`      | `pymysql`   |\n| `oracle`     | `cx_oracle` |\n| `postgresql` | `pg8000`    |\n\nTo install any combination of these SQLAlchemy drivers, substitute their dialect identifiers, delimited by commas, within the brackets shown in the previous example *(see [Supported Drivers](http://docs.sqlalchemy.org/en/latest/core/engines.html#supported-databases) for details about other SQLAlchemy drivers not mapped to the predefined dialects above)*.\n\n*NOTE: Additional client software may also be required for certain database engines. Installation steps will vary depending on the host operating system.\n\n## Local Environment Setup\n\nCreate a new `.env` file in the package root, or rename one of the included `.env.example-*` files to `.env`:\n\n```shell\n$ cp .env.example-macos-oracle .env\n```\n\n### ENV Variables\n\nThe following ENV variables can be used to configure various application behaviors:\n- **BOILERPLATE_ENV**: (Default: `dev`) The configuration profile applied to running app instances. Possible values: `dev`, `test`, or `prod`.\n- **DEBUG**: (Default: `true` if **BOILERPLATE_ENV** is `dev`, or false otherwise) Whether debug mode is enabled.\n- **CF_INSTANCE_INTERNAL_IP**: (Default: `127.0.0.1`) The internal IP address of the running app instance. \n- **PORT**: (Default: `5000`) The port on which the application listens for requests.\n- **LD_LIBRARY_PATH**: (Linux) A colon-separated list of the directories containing required database client libraries. Required for some SQLAlchemy drivers.\n- **DYLD_LIBRARY_PATH**: (macOS) A colon-separated list of the directories containing required database client libraries. Required for some SQLAlchemy drivers.\n- **SECRET_KEY**: The secret used to unlock encrypted credentials. May optionally be substituted with the path to a secret key file *(see **SECRET_PATH** below)*.\n- **SECRET_PATH**: (Default: `secrets.yml`) The location of the secret key file used to unlock encrypted service credentials. Can be used when the secret is not explicitly defined via an environment variable *(see **SECRET_KEY** above)*.\n- **VCAP_APPLICATION**: (Non-PCF environments) A JSON-formatted, non-breaking string containing the application name that appears in the Swagger UI. May optionally be substituted with the path to a JSON file *(see **VCAP_APPLICATION_PATH** below)*.\n- **VCAP_APPLICATION_PATH**: (Non-PCF environments; default: `env/vcap_application.json`) The location of a file containing the application name that appears in the Swagger UI. Used as an alternative to collapsing the JSON string into an environment variable value *(see **VCAP_APPLICATION** above)*.\n- **VCAP_SERVICES**: (Non-PCF environments) A JSON-formatted, non-breaking string containing the list of user-provided services available to the application at runtime. May optionally be substituted with the path to a JSON file *(see **VCAP_SERVICES_PATH** below)*.\n- **VCAP_SERVICES_PATH**: (Non-PCF environments; default: `env/vcap_services.json`) The location of a file containing the list of user-provided services available to the application at runtime. Used as an alternative to collapsing the JSON string into an environment variable value *(see **VCAP_SERVICES** above)*.\n- **API_PREFIX**: (Default: `METREX_API_`) The prefix required for all user-provided services containing API connection credentials.\n- **DB_PREFIX**: (Default: `METREX_DB_`) The prefix required for all user-provided services containing database connection credentials.\n- **JOB_PREFIX**: (Default: `METREX_JOB_`) The prefix required for all user-provided services containing metric exporter job parameters.\n- **ERROR_INCLUDE_MESSAGE**: (Default: `true`) Whether to include detailed error messages in API responses. A generic \"Internal Server Error\" message will be returned on failure when `false`.\n- **SUSPEND_JOB_ON_FAILURE**: (Default: `false`) Whether to suspend metric exporter jobs immediately on failure. Suspended jobs may be resumed manually via the Scheduler API or by restarting the application.\n- **APIALCHEMY_APPD_SSL_VERIFY**: (Default: `true`) Whether to perform certificate verification for AppDynamics API connections.\n- **APIALCHEMY_EXTRAHOP_SSL_VERIFY**: (Default: `true`) Whether to perform certificate verification for ExtraHop API connections.\n- **APIALCHEMY_GITHUB_SSL_VERIFY**: (Default: `true`) Whether to perform certificate verification for GitHub API connections.\n- **APIALCHEMY_PUSHGATEWAY_SSL_VERIFY**: (Default: `true`) Whether to perform certificate verification for Pushgateway API connections.\n- **DB_DEFAULT_TIMEZONE**: (Default: `US/Eastern`) The default timezone applied to `timestamp_column` values defined in database-sourced metric exporter jobs.\n- **JOBS_SOURCE_SERVICE**: The name of the user-provided service containing GitHub API connection credentials.\n- **JOBS_SOURCE_ORG**: The name of the GitHub org in which job definitions are hosted.\n- **JOBS_SOURCE_REPO**: The name of the GitHub repository in which job definitions are hosted.\n- **JOBS_SOURCE_BRANCH**: (Default: `master`) The branch name of the GitHub-hosted job definitions.\n- **JOBS_SOURCE_PATH**: The relative file path to GitHub-hosted job definitions.\n- **JOBS_SOURCE_REFRESH_INTERVAL**: (Default: `60`) An integer value representing the polling interval, expressed in minutes, for checking a GitHub-hosted job repository for changes to job definitions.\n- **PUSHGATEWAY_SERVICE**: The name of the user-provided service containing Pushgateway API connection credentials.\n- **MISFIRE_GRACE_TIME**: (Default: `5`) The seconds after the designated runtime that a metric exporter job is still allowed to be run.\n- **THREADPOOL_MAX_WORKERS**: (Default: `20`) The maximum number of spawned threads for the default metric exporter job executor.\n- **PROCESSPOOL_MAX_WORKERS**: (Default: `10`) The maximum number of spawned processes for the default metric exporter job executor.\n\n## Configuration: Services\n\nThis application was designed to run on Pivotal Cloud Foundry (PCF). However, it can also be configured for non-PCF environments.\n\nWhen running in PCF, the connection parameters used by metric exporter \"jobs\" are defined via [user-provided service instances](https://docs.cloudfoundry.org/devguide/services/user-provided.html).\n\nIn non-PCF environments, services can be defined via a JSON configuration file (default: `env/vcap_services.json`), which mimics the structure of PCF user-provided services, as shown in the following example:\n\n```json\n{\n  \"user-provided\": [\n    {\n      \"name\": \"METREX_DB_EXAMPLE\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"name\": \"database_name\",\n        \"hostname\": \"mysql.mydomain.com\",\n        \"port\": \"3306\",\n        \"encrypted\": \"false\",\n        \"username\": \"user\",\n        \"password\": \"password\",\n        \"dialect\": \"mysql\",\n        \"driver\": \"pymysql\"\n      }\n    },\n    {\n      \"name\": \"METREX_API_APPD\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"hostname\": \"appdynamics.mydomain.com\",\n        \"encrypted\": \"false\",\n        \"username\": \"user\",\n        \"password\": \"password\",\n        \"vendor\": \"appdynamics\"\n      }\n    },\n    {\n      \"name\": \"METREX_API_EXTRAHOP\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"hostname\": \"extrahop.mydomain.com\",\n        \"encrypted\": \"false\",\n        \"apikey\": \"extrahop_apikey\",\n        \"vendor\": \"extrahop\"\n      }\n    },\n    {\n      \"name\": \"METREX_API_GITHUB\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"hostname\": \"github.com\",\n        \"encrypted\": \"false\",\n        \"apikey\": \"github_apikey\",\n        \"vendor\": \"github\"\n      }\n    }\n  ]\n}\n```\n\n### Database Connection Parameters\n\nThe names assigned to services containing database connection details must begin with the prefix `METREX_DB_` (or the value of the **DB_PREFIX** environment variable). The text that appears after this prefix will be prepended to the names of all Prometheus metrics generated from this service.\n\nFor database connections, the following parameters must be included in the `credentials` block:\n- `name`: Database or service name\n- `hostname`: Server name or IP address\n- `port`: Port number\n- `encrypted`: \"true\" (recommended) if `password` value is encrypted or \"false\" if it is not.\n- `username`: User name\n- `password`: Password\n- `dialect`: Dialect identifier *(refer to table of Dialect/Driver mappings in [Database Engines](#database-engines) section above)*\n- `driver`: SQLAlchemy driver *(refer to table of Dialect/Driver mappings in [Database Engines](#database-engines) section above)*\n- `timezone`: Database timezone (defaults to value of **DB_DEFAULT_TIMEZONE** env variable)\n\n### API Connection Parameters\n\nThe names assigned to services containing API connection details must begin with the prefix `METREX_API_` (or the value of the **API_PREFIX** environment variable). Presently, connectivity to the following APIs is supported:\n- [AppDynamics](https://docs.appdynamics.com/display/PRO43/Metric+and+Snapshot+API)\n- [ExtraHop](https://docs.extrahop.com/7.9/rest-extract-metrics)\n- [GitHub](https://developer.github.com/v3/)*\n- [Prometheus Pushgateway](https://github.com/prometheus/pushgateway)**\n\n*GitHub connectivity is provided only as a means to access metric exporter job definitions in a source repository *(see [Defining Jobs in a GitHub Repository](#defining-jobs-in-a-github-repository) section below)*. It cannot be used as a `service` parameter in individual exporter job definitions.\n\n**Pushgateway connectivity is provided to allow exporter job metrics to be forwarded to a Prometheus Pushgateway server *(see [Exposing Metrics to a Pushgateway](#exposing-metrics-to-a-pushgateway) section below)*. It cannot be used as a `service` parameter in individual exporter job definitions.\n\nThe parameters to be included in the `credentials` block for each API connection type are shown below.\n\nAppDynamics API connections:\n- `hostname`: AppD controller server name or IP address\n- `port`: Port number (optional)\n- `encrypted`: \"true\" (recommended) if `password` value is encrypted or \"false\" if it is not\n- `username`: User name\n- `password`: Password\n- `vendor`: \"appdynamics\"\n\nExtraHop API connections:\n- `hostname`: ExtraHop server name or IP address\n- `port`: Port number (optional)\n- `encrypted`: \"true\" (recommended) if `apikey` value is encrypted or \"false\" if it is not\n- `apikey`: ExtraHop API key\n- `vendor`: \"extrahop\"\n\nGitHub API connections:\n- `hostname`: GitHub server name or IP address\n- `port`: Port number (optional)\n- `encrypted`: \"true\" (recommended) if `apikey` value is encrypted or \"false\" if it is not\n- `apikey`: GitHub API key\n- `vendor`: \"github\"\n\nPushgateway API connections:\n- `hostname`: Pushgateway server name or IP address (include \"https://\" for secure server connections)\n- `port`: Port number (optional)\n- `encrypted`: \"true\" (recommended) if `password` value is encrypted or \"false\" if it is not (optional, for connections requiring Basic auth)\n- `username`: User name (optional, for connections requiring Basic auth)\n- `password`: Password (optional, for connections requiring Basic auth)\n- `vendor`: \"pushgateway\"\n\n### Encrypting Credentials\n\nFor security purposes, it is recommended that database passwords and API keys be encrypted, especially when stored in PCF. This application supports the decryption of credentials encrypted via the [cryptofy](https://github.com/homedepot/cryptofy) package.\n\nTo configure the application to decrypt a password or API key for a given connection at runtime, set the `encrypted` property to \"true\" in the `credentials` block, as shown in the following example:\n\n```json\n{\n  \"user-provided\": [\n    {\n      \"name\": \"METREX_DB_EXAMPLE\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"name\": \"database_name\",\n        \"hostname\": \"mysql.mydomain.com\",\n        \"port\": \"3306\",\n        \"encrypted\": \"true\",\n        \"username\": \"user\",\n        \"password\": \"Zq4B/mjYV9a4sVBzWiCxz5+tjcXHK2yc4UDVhWJLP2g=\",\n        \"dialect\": \"mysql\",\n        \"driver\": \"pymysql\"\n      }\n    },\n    {\n      \"name\": \"METREX_API_EXTRAHOP\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"hostname\": \"extrahop.mydomain.com\",\n        \"encrypted\": \"true\",\n        \"apikey\": \"V37REDWZithWkr9Qu2d/p6uurhpj6kShcYjX0Y6yBWI=\",\n        \"vendor\": \"extrahop\"\n      }\n    }\n  ]\n}\n```\n\nA \"secret\" must be supplied to the application in order to unlock encrypted credentials at runtime. This secret must be the same one that was used to encrypt each of the passwords/API keys *(refer to the cryptofy documentation for instructions on generating secrets and encrypting credentials)*.\n\nSecrets may be supplied either by means of the **SECRET_KEY** environment variable or via a YAML-formatted file, the location of which is referenced in the ENV variable **SECRET_PATH**.*\n\n**Method 1**: Environment variable\n\n```dotenv\nSECRET_KEY=my_secret\n```\n\n**Method 2**: Secrets file (with file path environment variable)\n\nENV variable:\n\n```dotenv\nSECRET_PATH=secrets.yml\n```\n\nContents of `secrets.yml`:\n\n```yaml\nsecret-key: my_secret\n```\n\n*WARNING: Due to their sensitive nature, care should be taken to protect secret keys from being exposed. If defined via an ENV variable, make sure it is not visible to others; else if it is supplied as a secrets file, do NOT store the file in source code!\n\n## Configuration: Jobs\n\nMetric exporter jobs can be defined in either:\n- User-provided service instances in PCF, or\n- A GitHub repository\n\n### Defining Jobs as Services\n\nIf running in PCF, metric exporter jobs can be defined as user-provided services.* All user-provided services containing exporter job definitions must begin with the prefix `METREX_JOB_` (or the value of the **JOB_PREFIX** environment variable).\n\nIn non-PCF environments, jobs can be added to the same JSON-formatted configuration file containing the connection services, as shown below:\n\n```json\n{\n  \"user-provided\": [\n    {\n      \"name\": \"METREX_JOB_QUERY_EXAMPLE\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"service\": \"METREX_DB_EXAMPLE\",\n        \"interval_minutes\": \"5\",\n        \"statement\": \"SELECT col1, col2, col3 FROM my_table\",\n        \"value_columns\": \"col1, col2\",\n        \"static_labels\": \"name:value\"\n      }\n    },\n    {\n      \"name\": \"METREX_JOB_APPD_EXAMPLE\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"service\": \"METREX_API_APPD\",\n        \"interval_minutes\": \"15\",\n        \"application\": \"Application_Name\",\n        \"metric_path\": \"Business Transaction Performance|Business Transactions|*|*|*\"\n      }\n    },\n    {\n      \"name\": \"METREX_JOB_EXTRAHOP_EXAMPLE\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"service\": \"METREX_API_EXTRAHOP\",\n        \"interval_minutes\": \"60\",\n        \"metric_params\": {\n          \"cycle\": \"auto\",\n          \"object_type\": \"device\",\n          \"object_ids\": [\n            9363\n          ],\n          \"metric_category\": \"http_client\",\n          \"metric_specs\": [\n            {\n              \"name\": \"req\"\n            }\n          ]\n        },\n        \"aggregation\": {\n          \"funcs\": [\n            \"count\",\n            \"sum\",\n            \"95\"\n          ],\n          \"threshold\": {\n            \"operator\":  \">\",\n            \"value\": \"10\"\n          }\n        },\n        \"static_labels\": \"name:value\"\n      }\n    }\n  ]\n}\n```\n\n*NOTE: Metric exporter jobs defined as user-defined services in PCF may be subject to limitations on size and the total number which may be binded to a single application. For this reason, it may be preferable to define jobs in a source repository instead.\n\n### Defining Jobs in a GitHub Repository\n\nMetric exporter jobs can also be defined via a JSON-formatted config file hosted in GitHub like the one shown below:\n\n```json\n{\n  \"QUERY_EXAMPLE\": {\n    \"service\": \"METREX_DB_EXAMPLE\",\n    \"interval_minutes\": \"5\",\n    \"statement\": \"SELECT col1, col2, col3 FROM my_table\",\n    \"value_columns\": \"col1, col2\",\n    \"static_labels\": \"name:value\"\n  },\n  \"APPD_EXAMPLE\": {\n    \"service\": \"METREX_API_APPD\",\n    \"interval_minutes\": \"15\",\n    \"application\": \"Application_Name\",\n    \"metric_path\": \"Business Transaction Performance|Business Transactions|*|*|*\"\n  },\n  \"EXTRAHOP_EXAMPLE\": {\n    \"service\": \"METREX_API_EXTRAHOP\",\n    \"interval_minutes\": \"60\",\n    \"metric_params\": {\n      \"cycle\": \"auto\",\n      \"object_type\": \"device\",\n      \"object_ids\": [\n        9363\n      ],\n      \"metric_category\": \"http_client\",\n      \"metric_specs\": [\n        {\n          \"name\": \"req\"\n        }\n      ]\n    },\n    \"aggregation\": {\n      \"funcs\": [\n        \"count\",\n        \"sum\",\n        \"95\"\n      ],\n      \"threshold\": {\n        \"operator\":  \">\",\n        \"value\": \"10\"\n      }\n    },\n    \"static_labels\": \"name:value\"\n  }\n}\n```\n\nThere is no prefix requirement for GitHub-hosted job names. However, the name referenced in the job's `service` parameter must match the full service name (prefix included) defined in PCF.\n\nIn order for jobs defined in a GitHub repository to be consumed, the following environment variables must be provided:\n\n```dotenv\nJOBS_SOURCE_SERVICE=METREX_API_GITHUB\nJOBS_SOURCE_ORG=org_name\nJOBS_SOURCE_REPO=repo_name\nJOBS_SOURCE_PATH=path/to/jobs.json\nJOBS_SOURCE_REFRESH_INTERVAL=30\n```\n\nChanges to the jobs config file referenced by these env variables will be picked up every *x* minutes, per the value assigned to **JOBS_SOURCE_REFRESH_INTERVAL**, and incorporated into the job scheduler. Unlike changes to user-defined services in PCF, no restart of the application is required for GitHub-hosted job file changes to take effect.\n\n### Job Parameters\n\nThe parameters to be included for each metric exporter job type are shown below.\n\nDatabase queries:\n- `service`: The name of the service containing the database connection details\n- `interval_minutes`: The interval (in minutes) to wait between each execution of the job\n- `statement`: SELECT query\n- `value_columns`: A comma-delimited list of one or more column names representing numeric metric values (any columns returned via the query which do not match the names in this list will be used as metric \"labels\")\n- `static_labels`: (optional) A comma-delimited list of `label:value` pairs to apply as static labels for all metrics\n- `timestamp_column`: (optional) The name of column containing metric timestamp (ignored when metrics are exposed via Pushgateway)\n\nAppDynamics metrics:\n- `service`: The name of the service containing the API connection details\n- `interval_minutes`: The interval (in minutes) to wait between each execution of the job\n- `application`: The Application name as it appears in AppD (for Database metrics, value is always \"Database Monitoring\")\n- `metric_path`: The AppD metrics path. May include wildcards (`*`).\n- `static_labels`: (optional) A comma-delimited list of `label:value` pairs to apply as static labels for all metrics\n\nExtraHop metrics:\n- `service`: The name of the service containing the API connection details\n- `interval_minutes`: The interval (in minutes) to wait between each execution of the job\n- `metric_params`: The list of parameters passed to the ExtraHop `/metrics` API endpoint\n- `metric_name`: The identifier to be used in the Prometheus metric collector name.\n- `aggregation`: The list of parameters used to aggregate the values returned from the ExtraHop API *(see [About Aggregation](#about-aggregation) below)*\n- `static_labels`: (optional) A comma-delimited list of `label:value` pairs to apply as static labels for all metrics\n\n### About Aggregation\n\nCertain job types *(see \"ExtraHop metrics\" above)* provide the ability to define aggregation functions to produce metrics from the result data returned by the service.\n\nThe `aggregation` parameter group consists of two subgroups: `funcs` and `threshold` *(see example in [Defining Jobs as PCF Services](#defining-jobs-as-pcf-services) above)*\n\nThe `funcs` subgroup accepts any combination of the following aggregation functions:\n- `avg`\n- `count` (default)\n- `min`\n- `max`\n- `sum`\n\nIt can also take integer values between 0 and 100, representing the nth percentile.\n\nThe optional `threshold` subgroup works much in the same way as a `HAVING` clause in a SQL `GROUP BY`: it filters by values matching defined criteria.*  Here, the criteria are expressed via the `operator` and `value` params.\n\nSupported `operator` values are:\n- `>`\n- `<`\n- `>=`\n- `<=`\n- `=`\n- `<>`\n- `!=`\n\nThe `value` param must be an integer.\n\nExample: Match all values greater than 10\n\n```json\n{\n  \"JOB_EXAMPLE\": {\n    \"aggregation\": {\n      \"threshold\": {\n        \"operator\":  \">\",\n        \"value\": \"10\"\n      }\n    }\n  }\n}\n```\n\n*NOTE: If no `threshold` is specified, the aggregation function will include all returned values.\n\n## Exposing Metrics to a Pushgateway\n\nEach metric exporter job exposes its own registry endpoint by default at `/metrics/<job_id>`, which can be scraped by a Prometheus process.\n\nExporter job metrics can optionally be exposed to a [Prometheus Pushgateway](https://github.com/prometheus/pushgateway) service, which may simplify the process of managing jobs in Prometheus. If a Pushgateway service is defined, all new exporter jobs will automatically be exposed to it, and the metrics will in turn be available in Prometheus by means of scraping the Pushgateway.\n\nIn order to activate this feature, a Pushgateway service must be registered *(see example below)* and referenced by the **PUSHGATEWAY_SERVICE** env variable.\n\nPushgateway service definition:\n\n```json\n{\n  \"user-provided\": [\n    {\n      \"name\": \"METREX_API_PUSHGATEWAY\",\n      \"label\": \"user-provided\",\n      \"credentials\": {\n        \"hostname\": \"https://pushgateway.mydomain.com\",\n        \"vendor\": \"pushgateway\"\n      }\n    }\n  ]\n}\n```\n\nENV variable:\n\n```dotenv\nPUSHGATEWAY_SERVICE=METREX_API_PUSHGATEWAY\n```\n\n## Running the Application\n\nWith the virtual environment activated as shown above, execute the following command:\n\n```shell\n$ metrex\n```\n\n## Swagger\n\nOpen the URL shown in the resulting output from the above command (default: http://127.0.0.1:5000) to access the Swagger UI.\n\n## Testing\n\nExecute the following command from the top-level directory of the cloned repository:\n\n```shell\n$ python setup.py test\n```\n\n## License\n\nDistributed under the [Apache, version 2.0 license](https://opensource.org/licenses/Apache-2.0).", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/homedepot/metREx", "keywords": "prometheus exporter prometheus-exporter metrics metrics-exporter query-exporter sql sql-exporter appd appd-exporter appdynamics appdynamics-exporter extrahop extrahop-exporter", "license": "Apache 2.0", "maintainer": "", "maintainer_email": "", "name": "metREx", "package_url": "https://pypi.org/project/metREx/", "platform": "", "project_url": "https://pypi.org/project/metREx/", "project_urls": {"Homepage": "https://github.com/homedepot/metREx"}, "release_url": "https://pypi.org/project/metREx/0.1.0/", "requires_dist": null, "requires_python": ">=3.6", "summary": "SQL query and monitoring system metrics exporter for Prometheus", "version": "0.1.0"}, "last_serial": 6803200, "releases": {"0.1.0": [{"comment_text": "", "digests": {"md5": "b1fbebcca2ec23f4820a427d396f855f", "sha256": "3645149f3b3ba601a29f7b4cb30fbc35177207579f118a8ee32f9d4677516c8d"}, "downloads": -1, "filename": "metREx-0.1.0.tar.gz", "has_sig": false, "md5_digest": "b1fbebcca2ec23f4820a427d396f855f", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 31960, "upload_time": "2020-03-13T02:43:54", "upload_time_iso_8601": "2020-03-13T02:43:54.508061Z", "url": "https://files.pythonhosted.org/packages/dc/8e/4e41f75fc4c7fb32de92980fc14d2371128c30e8dce3f30fbb56c04968c3/metREx-0.1.0.tar.gz"}]}, "urls": [{"comment_text": "", "digests": {"md5": "b1fbebcca2ec23f4820a427d396f855f", "sha256": "3645149f3b3ba601a29f7b4cb30fbc35177207579f118a8ee32f9d4677516c8d"}, "downloads": -1, "filename": "metREx-0.1.0.tar.gz", "has_sig": false, "md5_digest": "b1fbebcca2ec23f4820a427d396f855f", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.6", "size": 31960, "upload_time": "2020-03-13T02:43:54", "upload_time_iso_8601": "2020-03-13T02:43:54.508061Z", "url": "https://files.pythonhosted.org/packages/dc/8e/4e41f75fc4c7fb32de92980fc14d2371128c30e8dce3f30fbb56c04968c3/metREx-0.1.0.tar.gz"}]}