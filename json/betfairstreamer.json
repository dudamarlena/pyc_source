{"info": {"author": "Jonatan Almen", "author_email": "almen.jonatan@gmail.com", "bugtrack_url": null, "classifiers": ["License :: OSI Approved :: MIT License", "Programming Language :: Python :: 3"], "description": "# Betfairstreamer\n\nWhat this library provides\n\n* Run single or multiple streams simultaneously (single threaded)\n* Market cache and order cache, these provide abstractions over the betfairstream\n* Using numpy arrays to slicing markets selections.\n* Async streaming (Optional)\n* Parse historical data (Example below)\n\n## Installation\n\n```\npip install betfairstreamer\n```\n## Demo\n![](stream.gif)\n\n## Tutorial\n#### Credentials\nCreate a credential file credentials.env\nwith following content.\n```\nUSERNAME=BETFAIR_USERNAME\nPASSWORD=BETFAIR_PASSWORD\nAPP_KEY=BETFAIR_APP_KEY\nLOCALE=IFANY\nCERT_PATH=PATH_TO_BETFAIR_CERTIFICATES\n```\n#### Virtual environment\nCreate a virtual environment, needs python >= 3.8.0\n```shell script\npython3.8 -m venv venv\nsource venv/bin/activate\npip install betfairstreamer==.5.3\n```\n\n#### Create Application\nmain.py\n```python\nimport logging\nimport time\n\nimport numpy as np\nimport orjson\n\nfrom betfairstreamer.betfair_api import (\n    BetfairMarketFilter,\n    BetfairMarketDataFilter,\n)\nfrom betfairstreamer.cache import MarketCache, OrderCache\nfrom betfairstreamer.stream import create_connection_pool\nfrom betfairstreamer.utils import create_market_subscription, create_order_subscription\n\nnp.set_printoptions(precision=3)\n\nlogging.basicConfig(level=logging.INFO)\n\nhorses_subscription_message = create_market_subscription(\n    # Asian Handicap is not yet supported if using EX_ALL_OFFER.\n    market_filter=BetfairMarketFilter(eventTypeIds=[\"7\"], marketTypes=[\"WIN\"]),\n    market_data_filter=BetfairMarketDataFilter(\n        ladderLevels=3,  # Ladder levels are fixed to 3 at the moment.\n        fields=[\n            \"EX_MARKET_DEF\",\n            \"EX_BEST_OFFERS\",\n            \"EX_LTP\",\n            \"EX_BEST_OFFERS_DISP\",\n            \"EX_ALL_OFFERS\",\n        ],\n    ),\n    conflate_ms=1000 # Remove this if you want full speed ...\n)\n\norder_subscription_message = create_order_subscription()\n\nmarket_cache = MarketCache()\norder_cache = OrderCache()\n\nconnection_pool = create_connection_pool([horses_subscription_message, order_subscription_message])\n\nfor update in connection_pool.read():\n    update = orjson.loads(update)\n\n    market_updates = market_cache(update)\n    order_updates = order_cache(update)\n\n    for market_book in market_updates:\n        # From full price ladder take sortPriority one and two and\n        # only ladder levels having a size greater or equal to 2.0.\n        maskB = market_book.full_price_ladder[0, 0, :, 1] >= 2.0\n        maskL = market_book.full_price_ladder[0, 1, :, 1] >= 2.0\n        # Marketbook price size index: [SortPriority, LAY/BACK, LadderLevel, Price/Size]\n        print()\n        print(f\"market ID: {market_book.market_id}\\n\"\n              f\"virtualized:\\n\"\n              f\"  BACK: {str(market_book.best_display[0, 0, :, 0])}\\n\"\n              f\"  LAY:  {str(market_book.best_display[0, 1, :, 0])}\\n\"\n              f\"best offer:\\n\"\n              f\"  BACK: {str(market_book.best_offers[0, 0, :, 0])}\\n\"\n              f\"  LAY:  {str(market_book.best_offers[0, 1, :, 0])}\\n\"\n              f\"full (capped at 8):\\n\"\n              f\"  BACK: {str(market_book.full_price_ladder[0, 0, maskB, 0][-8:])}\\n\"\n              f\"  LAY:  {str(market_book.full_price_ladder[0, 1, maskL, 0][:8])}\\n\"\n              )\n\n    for order in order_updates:\n        print(order)\n\n\n\n```\n\n#### Run\n\n```\nenv $(cat credentials.env) python main.py\n```\n\n\n## Read historical data\n```python\nimport bz2 # If you download data from betfair\n\nmarket_cache = MarketCache()\n\n# market_updates = open(\"market_file\", \"r\").readlines() # If files are not compressed\n# market_updates = bz2.open(\"market_file.bz2\", \"r\").readlines()  # If files are compressed\n\nfor market_update in market_updates:\n    market_books = market_cache(orjson.loads(market_update))    \n\n    for market_book in market_books: \n        # Do something with market_book...\n\n```\n\n## Benchmark\n```Benchmark\nSetup: Two processes, one sending betfair stream messages , one receiving.\n\nHardware: I7 8550U, 16GB ram\n\nResults: \n * Using a market cache it can read around 25k messages/second\n * Without market cache >> 100 Mb/s\n\n```\n\n\n\n\n", "description_content_type": "text/markdown", "docs_url": null, "download_url": "", "downloads": {"last_day": -1, "last_month": -1, "last_week": -1}, "home_page": "https://github.com/almenjonatan/betfairstreamer.git", "keywords": "", "license": "", "maintainer": "", "maintainer_email": "", "name": "betfairstreamer", "package_url": "https://pypi.org/project/betfairstreamer/", "platform": "", "project_url": "https://pypi.org/project/betfairstreamer/", "project_urls": {"Homepage": "https://github.com/almenjonatan/betfairstreamer.git"}, "release_url": "https://pypi.org/project/betfairstreamer/0.5.3/", "requires_dist": ["betfairlightweight", "orjson", "numpy", "ciso8601", "attrs", "pytz"], "requires_python": ">=3.8.0", "summary": "Betfair Exchange Stream API wrapper", "version": "0.5.3"}, "last_serial": 7019066, "releases": {"0.3.0": [{"comment_text": "", "digests": {"md5": "37c5351e5a4e78e42cfc8bb85c7f04b8", "sha256": "75615ff5616e8091e771d68244c64140b6649f3ccdb98eed37c5192b1f7959f4"}, "downloads": -1, "filename": "betfairstreamer-0.3.0-py3-none-any.whl", "has_sig": false, "md5_digest": "37c5351e5a4e78e42cfc8bb85c7f04b8", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 14415, "upload_time": "2020-03-15T23:03:51", "upload_time_iso_8601": "2020-03-15T23:03:51.203096Z", "url": "https://files.pythonhosted.org/packages/2a/ff/815c85de23feac69b074ccf369ea9bc95629bb7a767876ae8fed6417b093/betfairstreamer-0.3.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "646770489b930c0235cdc186e62e1598", "sha256": "c60d9dce8b719c62a45a1e9e399157856ae0947e8036acef4d580be05b3ca203"}, "downloads": -1, "filename": "betfairstreamer-0.3.0.tar.gz", "has_sig": false, "md5_digest": "646770489b930c0235cdc186e62e1598", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 15156, "upload_time": "2020-03-15T23:03:53", "upload_time_iso_8601": "2020-03-15T23:03:53.969923Z", "url": "https://files.pythonhosted.org/packages/01/a2/eeab4d3981c554b145322c15ad49c5695daab305e1f09f719c2a98005deb/betfairstreamer-0.3.0.tar.gz"}], "0.3.1": [{"comment_text": "", "digests": {"md5": "b8db0d87312b47779879fb796d3475c1", "sha256": "d809adac3d32fcb02672bf7e098466e487f4c060e341089b5741702206a7a901"}, "downloads": -1, "filename": "betfairstreamer-0.3.1-py3-none-any.whl", "has_sig": false, "md5_digest": "b8db0d87312b47779879fb796d3475c1", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 14792, "upload_time": "2020-03-17T20:21:17", "upload_time_iso_8601": "2020-03-17T20:21:17.504382Z", "url": "https://files.pythonhosted.org/packages/69/75/6d864e96fee3b67008baae55dcab3788e7515732fc79c8190f64fdfe54dd/betfairstreamer-0.3.1-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "5ccab00e8849c37d6b1c6483b3b9f48d", "sha256": "f808049641a55e5cec9169563d6362f1b3acbb3e718d6fce17d53aa504950a54"}, "downloads": -1, "filename": "betfairstreamer-0.3.1.tar.gz", "has_sig": false, "md5_digest": "5ccab00e8849c37d6b1c6483b3b9f48d", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 15715, "upload_time": "2020-03-17T20:21:19", "upload_time_iso_8601": "2020-03-17T20:21:19.119043Z", "url": "https://files.pythonhosted.org/packages/88/6a/9c2c6cf1798db3e651711f323a4aefa24c371e2b3ab077e779ec590b0c0e/betfairstreamer-0.3.1.tar.gz"}], "0.4.0": [{"comment_text": "", "digests": {"md5": "59af3ce1f5791a5afed63ea5dae93122", "sha256": "e7f70a3843af2d49b290a0b5a91dd165130eae9232c3ed02cdfa91a0594216d6"}, "downloads": -1, "filename": "betfairstreamer-0.4.0-py3-none-any.whl", "has_sig": false, "md5_digest": "59af3ce1f5791a5afed63ea5dae93122", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 15594, "upload_time": "2020-03-23T14:33:18", "upload_time_iso_8601": "2020-03-23T14:33:18.173650Z", "url": "https://files.pythonhosted.org/packages/c4/ed/9de7dd1482a60d34be0bd651213cdd98b906538e5db52d1eb5ebbcc8618f/betfairstreamer-0.4.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "125530b929b4c04cb187be42a0c1f83f", "sha256": "4fb0619cc590b1767172deaeccf7f49873122e6133f6db5a87818cfa117665eb"}, "downloads": -1, "filename": "betfairstreamer-0.4.0.tar.gz", "has_sig": false, "md5_digest": "125530b929b4c04cb187be42a0c1f83f", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 16436, "upload_time": "2020-03-23T14:33:19", "upload_time_iso_8601": "2020-03-23T14:33:19.849515Z", "url": "https://files.pythonhosted.org/packages/4c/8a/8ad0b30ee71f61a75959c14ee2f6a3095c2927834c4b834addf8b0ee8f8b/betfairstreamer-0.4.0.tar.gz"}], "0.4.1": [{"comment_text": "", "digests": {"md5": "ebf89e66f4e7d75e156294c1b6610c56", "sha256": "70e5fc7fafb8c4f4907520032780ccce2ed49bb351bb0e84428e5c428741a80e"}, "downloads": -1, "filename": "betfairstreamer-0.4.1-py3-none-any.whl", "has_sig": false, "md5_digest": "ebf89e66f4e7d75e156294c1b6610c56", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 15782, "upload_time": "2020-03-25T11:23:18", "upload_time_iso_8601": "2020-03-25T11:23:18.494267Z", "url": "https://files.pythonhosted.org/packages/8e/fc/a3b69fc014e3471c6f0e05afc6097a0be163bea3ad8983545f9f2495f02f/betfairstreamer-0.4.1-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "76f75c85b5c3eee944ddea6760c75ef1", "sha256": "3f9ba290ece1c5ceadc7933b2f97406e2da95f0d044eac3b1260b6eb33c20fff"}, "downloads": -1, "filename": "betfairstreamer-0.4.1.tar.gz", "has_sig": false, "md5_digest": "76f75c85b5c3eee944ddea6760c75ef1", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 16538, "upload_time": "2020-03-25T11:23:20", "upload_time_iso_8601": "2020-03-25T11:23:20.632169Z", "url": "https://files.pythonhosted.org/packages/65/7b/28902f8a141bc5d222d23243bae0e6259c78b27be8752890fe3e7d7ea2a2/betfairstreamer-0.4.1.tar.gz"}], "0.5.0": [{"comment_text": "", "digests": {"md5": "0d8c16795e1a0641c40565d811f8c386", "sha256": "88cc4dcf9443d1f11cc295bf78666ffa8b4fa75b7f16e595adabe0893b7bb88b"}, "downloads": -1, "filename": "betfairstreamer-0.5.0-py3-none-any.whl", "has_sig": false, "md5_digest": "0d8c16795e1a0641c40565d811f8c386", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 14683, "upload_time": "2020-04-08T11:55:48", "upload_time_iso_8601": "2020-04-08T11:55:48.355791Z", "url": "https://files.pythonhosted.org/packages/99/8e/e9183eda30976f85595c54364e04cac84a56d6b90853438db52ccd93e51a/betfairstreamer-0.5.0-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "ad86408a6cc08f3c041c11c713882f72", "sha256": "48d36cf5a3062b70600a750b5a6e75ea05a79efea68678f3a3579499ec215d2b"}, "downloads": -1, "filename": "betfairstreamer-0.5.0.tar.gz", "has_sig": false, "md5_digest": "ad86408a6cc08f3c041c11c713882f72", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 14764, "upload_time": "2020-04-08T11:55:49", "upload_time_iso_8601": "2020-04-08T11:55:49.601005Z", "url": "https://files.pythonhosted.org/packages/85/71/ae029b876f20dc30117b9fbe59e54b76821d1c7c835ffbb7b2a380c6ebaa/betfairstreamer-0.5.0.tar.gz"}], "0.5.1": [{"comment_text": "", "digests": {"md5": "0f80e79a44b1906f906daad09d5be77c", "sha256": "071d7ebbb2b6605a84b20aa3b11e77401bda07adf287f4a2cb796e87ae09474a"}, "downloads": -1, "filename": "betfairstreamer-0.5.1-py3-none-any.whl", "has_sig": false, "md5_digest": "0f80e79a44b1906f906daad09d5be77c", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 12542, "upload_time": "2020-04-09T21:52:43", "upload_time_iso_8601": "2020-04-09T21:52:43.995070Z", "url": "https://files.pythonhosted.org/packages/07/ca/18c7d202d6a23f84cb947c1247f0edc56cee780af2f1b0c548bb9d411807/betfairstreamer-0.5.1-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "4c68cd84c3be927501314d6ba6fd91e9", "sha256": "f0f338c7dee0a6334965fbee273ce14e1698945dfe19b4ebf619e3b708a14111"}, "downloads": -1, "filename": "betfairstreamer-0.5.1.tar.gz", "has_sig": false, "md5_digest": "4c68cd84c3be927501314d6ba6fd91e9", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 14938, "upload_time": "2020-04-09T21:52:45", "upload_time_iso_8601": "2020-04-09T21:52:45.521162Z", "url": "https://files.pythonhosted.org/packages/91/e9/96111a8e6087cdf7d8ff7478aa700d89385efb4bf5606b8ec132bd38e953/betfairstreamer-0.5.1.tar.gz"}], "0.5.2": [{"comment_text": "", "digests": {"md5": "0acd0e1b4cf8e57c142b941a1a14e8c4", "sha256": "194deb27e1e7dda76c9177f4fca70c02f5f944c6fa00e354f52f9d6fe0efa08e"}, "downloads": -1, "filename": "betfairstreamer-0.5.2-py3-none-any.whl", "has_sig": false, "md5_digest": "0acd0e1b4cf8e57c142b941a1a14e8c4", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 12527, "upload_time": "2020-04-10T12:39:35", "upload_time_iso_8601": "2020-04-10T12:39:35.836491Z", "url": "https://files.pythonhosted.org/packages/ee/17/25603937c71744af0fd8cb3aab8846c6e9b7421511156b86bc66e0ffe19a/betfairstreamer-0.5.2-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "15468b4b06313630b67e0146210f51fb", "sha256": "100ca24d2cf3664417f1a9c780f93d0e9f2dc62e75d6048410e960c37e5a0728"}, "downloads": -1, "filename": "betfairstreamer-0.5.2.tar.gz", "has_sig": false, "md5_digest": "15468b4b06313630b67e0146210f51fb", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 14933, "upload_time": "2020-04-10T12:39:37", "upload_time_iso_8601": "2020-04-10T12:39:37.994193Z", "url": "https://files.pythonhosted.org/packages/39/65/2c44ed0a257bb3fd4e28788350072cf675629e0daca7f5b6280be46a3650/betfairstreamer-0.5.2.tar.gz"}], "0.5.3": [{"comment_text": "", "digests": {"md5": "8adba17b6ec29d32b9b621c002aa6a12", "sha256": "6cd53ca9a002c50c909dd1b85d68726cc3dd021929f1c0cb41438246f996df62"}, "downloads": -1, "filename": "betfairstreamer-0.5.3-py3-none-any.whl", "has_sig": false, "md5_digest": "8adba17b6ec29d32b9b621c002aa6a12", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 13444, "upload_time": "2020-04-14T18:08:43", "upload_time_iso_8601": "2020-04-14T18:08:43.051624Z", "url": "https://files.pythonhosted.org/packages/ec/7f/8218f4acd454164ad6a77c8ff4cf0b07fb38e3593cf4727a9387c9e04b3e/betfairstreamer-0.5.3-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "ef36534871488e312ba5cac01c6bf4a6", "sha256": "54b5151718f63e588d43ef8a0aa9d5f49bdd0037a511bd7628bc6fb90155716b"}, "downloads": -1, "filename": "betfairstreamer-0.5.3.tar.gz", "has_sig": false, "md5_digest": "ef36534871488e312ba5cac01c6bf4a6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 16280, "upload_time": "2020-04-14T18:08:44", "upload_time_iso_8601": "2020-04-14T18:08:44.837702Z", "url": "https://files.pythonhosted.org/packages/3d/05/284594a25839085dd48257fcc61ef7b3542d66416ccb0786a2382933d051/betfairstreamer-0.5.3.tar.gz"}]}, "urls": [{"comment_text": "", "digests": {"md5": "8adba17b6ec29d32b9b621c002aa6a12", "sha256": "6cd53ca9a002c50c909dd1b85d68726cc3dd021929f1c0cb41438246f996df62"}, "downloads": -1, "filename": "betfairstreamer-0.5.3-py3-none-any.whl", "has_sig": false, "md5_digest": "8adba17b6ec29d32b9b621c002aa6a12", "packagetype": "bdist_wheel", "python_version": "py3", "requires_python": ">=3.8.0", "size": 13444, "upload_time": "2020-04-14T18:08:43", "upload_time_iso_8601": "2020-04-14T18:08:43.051624Z", "url": "https://files.pythonhosted.org/packages/ec/7f/8218f4acd454164ad6a77c8ff4cf0b07fb38e3593cf4727a9387c9e04b3e/betfairstreamer-0.5.3-py3-none-any.whl"}, {"comment_text": "", "digests": {"md5": "ef36534871488e312ba5cac01c6bf4a6", "sha256": "54b5151718f63e588d43ef8a0aa9d5f49bdd0037a511bd7628bc6fb90155716b"}, "downloads": -1, "filename": "betfairstreamer-0.5.3.tar.gz", "has_sig": false, "md5_digest": "ef36534871488e312ba5cac01c6bf4a6", "packagetype": "sdist", "python_version": "source", "requires_python": ">=3.8.0", "size": 16280, "upload_time": "2020-04-14T18:08:44", "upload_time_iso_8601": "2020-04-14T18:08:44.837702Z", "url": "https://files.pythonhosted.org/packages/3d/05/284594a25839085dd48257fcc61ef7b3542d66416ccb0786a2382933d051/betfairstreamer-0.5.3.tar.gz"}]}